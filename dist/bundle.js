!function(e){var t={};function s(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=t,s.d=function(e,t,o){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(o,r,function(t){return e[t]}.bind(null,r));return o},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){"use strict";s.r(t),s.d(t,"MyElement",(function(){return Ce}));
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const o="undefined"!=typeof window&&null!=window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,r=(e,t,s=null)=>{for(;t!==s;){const s=t.nextSibling;e.removeChild(t),t=s}},i=`{{lit-${String(Math.random()).slice(2)}}}`,n=`\x3c!--${i}--\x3e`,a=new RegExp(`${i}|${n}`);class c{constructor(e,t){this.parts=[],this.element=t;const s=[],o=[],r=document.createTreeWalker(t.content,133,null,!1);let n=0,c=-1,h=0;const{strings:d,values:{length:f}}=e;for(;h<f;){const e=r.nextNode();if(null!==e){if(c++,1===e.nodeType){if(e.hasAttributes()){const t=e.attributes,{length:s}=t;let o=0;for(let e=0;e<s;e++)l(t[e].name,"$lit$")&&o++;for(;o-- >0;){const t=d[h],s=u.exec(t)[2],o=s.toLowerCase()+"$lit$",r=e.getAttribute(o);e.removeAttribute(o);const i=r.split(a);this.parts.push({type:"attribute",index:c,name:s,strings:i}),h+=i.length-1}}"TEMPLATE"===e.tagName&&(o.push(e),r.currentNode=e.content)}else if(3===e.nodeType){const t=e.data;if(t.indexOf(i)>=0){const o=e.parentNode,r=t.split(a),i=r.length-1;for(let t=0;t<i;t++){let s,i=r[t];if(""===i)s=p();else{const e=u.exec(i);null!==e&&l(e[2],"$lit$")&&(i=i.slice(0,e.index)+e[1]+e[2].slice(0,-"$lit$".length)+e[3]),s=document.createTextNode(i)}o.insertBefore(s,e),this.parts.push({type:"node",index:++c})}""===r[i]?(o.insertBefore(p(),e),s.push(e)):e.data=r[i],h+=i}}else if(8===e.nodeType)if(e.data===i){const t=e.parentNode;null!==e.previousSibling&&c!==n||(c++,t.insertBefore(p(),e)),n=c,this.parts.push({type:"node",index:c}),null===e.nextSibling?e.data="":(s.push(e),c--),h++}else{let t=-1;for(;-1!==(t=e.data.indexOf(i,t+1));)this.parts.push({type:"node",index:-1}),h++}}else r.currentNode=o.pop()}for(const e of s)e.parentNode.removeChild(e)}}const l=(e,t)=>{const s=e.length-t.length;return s>=0&&e.slice(s)===t},h=e=>-1!==e.index,p=()=>document.createComment(""),u=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;function d(e,t){const{element:{content:s},parts:o}=e,r=document.createTreeWalker(s,133,null,!1);let i=m(o),n=o[i],a=-1,c=0;const l=[];let h=null;for(;r.nextNode();){a++;const e=r.currentNode;for(e.previousSibling===h&&(h=null),t.has(e)&&(l.push(e),null===h&&(h=e)),null!==h&&c++;void 0!==n&&n.index===a;)n.index=null!==h?-1:n.index-c,i=m(o,i),n=o[i]}l.forEach(e=>e.parentNode.removeChild(e))}const f=e=>{let t=11===e.nodeType?0:1;const s=document.createTreeWalker(e,133,null,!1);for(;s.nextNode();)t++;return t},m=(e,t=-1)=>{for(let s=t+1;s<e.length;s++){const t=e[s];if(h(t))return s}return-1};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const g=new WeakMap,y=e=>"function"==typeof e&&g.has(e),w={},v={};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
class _{constructor(e,t,s){this.__parts=[],this.template=e,this.processor=t,this.options=s}update(e){let t=0;for(const s of this.__parts)void 0!==s&&s.setValue(e[t]),t++;for(const e of this.__parts)void 0!==e&&e.commit()}_clone(){const e=o?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),t=[],s=this.template.parts,r=document.createTreeWalker(e,133,null,!1);let i,n=0,a=0,c=r.nextNode();for(;n<s.length;)if(i=s[n],h(i)){for(;a<i.index;)a++,"TEMPLATE"===c.nodeName&&(t.push(c),r.currentNode=c.content),null===(c=r.nextNode())&&(r.currentNode=t.pop(),c=r.nextNode());if("node"===i.type){const e=this.processor.handleTextExpression(this.options);e.insertAfterNode(c.previousSibling),this.__parts.push(e)}else this.__parts.push(...this.processor.handleAttributeExpressions(c,i.name,i.strings,this.options));n++}else this.__parts.push(void 0),n++;return o&&(document.adoptNode(e),customElements.upgrade(e)),e}}
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const S=` ${i} `;class b{constructor(e,t,s,o){this.strings=e,this.values=t,this.type=s,this.processor=o}getHTML(){const e=this.strings.length-1;let t="",s=!1;for(let o=0;o<e;o++){const e=this.strings[o],r=e.lastIndexOf("\x3c!--");s=(r>-1||s)&&-1===e.indexOf("--\x3e",r+1);const a=u.exec(e);t+=null===a?e+(s?S:n):e.substr(0,a.index)+a[1]+a[2]+"$lit$"+a[3]+i}return t+=this.strings[e],t}getTemplateElement(){const e=document.createElement("template");return e.innerHTML=this.getHTML(),e}}
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const P=e=>null===e||!("object"==typeof e||"function"==typeof e),x=e=>Array.isArray(e)||!(!e||!e[Symbol.iterator]);class C{constructor(e,t,s){this.dirty=!0,this.element=e,this.name=t,this.strings=s,this.parts=[];for(let e=0;e<s.length-1;e++)this.parts[e]=this._createPart()}_createPart(){return new E(this)}_getValue(){const e=this.strings,t=e.length-1;let s="";for(let o=0;o<t;o++){s+=e[o];const t=this.parts[o];if(void 0!==t){const e=t.value;if(P(e)||!x(e))s+="string"==typeof e?e:String(e);else for(const t of e)s+="string"==typeof t?t:String(t)}}return s+=e[t],s}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class E{constructor(e){this.value=void 0,this.committer=e}setValue(e){e===w||P(e)&&e===this.value||(this.value=e,y(e)||(this.committer.dirty=!0))}commit(){for(;y(this.value);){const e=this.value;this.value=w,e(this)}this.value!==w&&this.committer.commit()}}class A{constructor(e){this.value=void 0,this.__pendingValue=void 0,this.options=e}appendInto(e){this.startNode=e.appendChild(p()),this.endNode=e.appendChild(p())}insertAfterNode(e){this.startNode=e,this.endNode=e.nextSibling}appendIntoPart(e){e.__insert(this.startNode=p()),e.__insert(this.endNode=p())}insertAfterPart(e){e.__insert(this.startNode=p()),this.endNode=e.endNode,e.endNode=this.startNode}setValue(e){this.__pendingValue=e}commit(){if(null===this.startNode.parentNode)return;for(;y(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=w,e(this)}const e=this.__pendingValue;e!==w&&(P(e)?e!==this.value&&this.__commitText(e):e instanceof b?this.__commitTemplateResult(e):e instanceof Node?this.__commitNode(e):x(e)?this.__commitIterable(e):e===v?(this.value=v,this.clear()):this.__commitText(e))}__insert(e){this.endNode.parentNode.insertBefore(e,this.endNode)}__commitNode(e){this.value!==e&&(this.clear(),this.__insert(e),this.value=e)}__commitText(e){const t=this.startNode.nextSibling,s="string"==typeof(e=null==e?"":e)?e:String(e);t===this.endNode.previousSibling&&3===t.nodeType?t.data=s:this.__commitNode(document.createTextNode(s)),this.value=e}__commitTemplateResult(e){const t=this.options.templateFactory(e);if(this.value instanceof _&&this.value.template===t)this.value.update(e.values);else{const s=new _(t,e.processor,this.options),o=s._clone();s.update(e.values),this.__commitNode(o),this.value=s}}__commitIterable(e){Array.isArray(this.value)||(this.value=[],this.clear());const t=this.value;let s,o=0;for(const r of e)s=t[o],void 0===s&&(s=new A(this.options),t.push(s),0===o?s.appendIntoPart(this):s.insertAfterPart(t[o-1])),s.setValue(r),s.commit(),o++;o<t.length&&(t.length=o,this.clear(s&&s.endNode))}clear(e=this.startNode){r(this.startNode.parentNode,e.nextSibling,this.endNode)}}class k{constructor(e,t,s){if(this.value=void 0,this.__pendingValue=void 0,2!==s.length||""!==s[0]||""!==s[1])throw new Error("Boolean attributes can only contain a single expression");this.element=e,this.name=t,this.strings=s}setValue(e){this.__pendingValue=e}commit(){for(;y(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=w,e(this)}if(this.__pendingValue===w)return;const e=!!this.__pendingValue;this.value!==e&&(e?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=e),this.__pendingValue=w}}class N extends C{constructor(e,t,s){super(e,t,s),this.single=2===s.length&&""===s[0]&&""===s[1]}_createPart(){return new T(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class T extends E{}let q=!1;(()=>{try{const e={get capture(){return q=!0,!1}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(e){}})();class M{constructor(e,t,s){this.value=void 0,this.__pendingValue=void 0,this.element=e,this.eventName=t,this.eventContext=s,this.__boundHandleEvent=e=>this.handleEvent(e)}setValue(e){this.__pendingValue=e}commit(){for(;y(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=w,e(this)}if(this.__pendingValue===w)return;const e=this.__pendingValue,t=this.value,s=null==e||null!=t&&(e.capture!==t.capture||e.once!==t.once||e.passive!==t.passive),o=null!=e&&(null==t||s);s&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),o&&(this.__options=O(e),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=e,this.__pendingValue=w}handleEvent(e){"function"==typeof this.value?this.value.call(this.eventContext||this.element,e):this.value.handleEvent(e)}}const O=e=>e&&(q?{capture:e.capture,passive:e.passive,once:e.once}:e.capture)
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */;function V(e){let t=H.get(e.type);void 0===t&&(t={stringsArray:new WeakMap,keyString:new Map},H.set(e.type,t));let s=t.stringsArray.get(e.strings);if(void 0!==s)return s;const o=e.strings.join(i);return s=t.keyString.get(o),void 0===s&&(s=new c(e,e.getTemplateElement()),t.keyString.set(o,s)),t.stringsArray.set(e.strings,s),s}const H=new Map,j=new WeakMap;
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const L=new
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
class{handleAttributeExpressions(e,t,s,o){const r=t[0];if("."===r){return new N(e,t.slice(1),s).parts}return"@"===r?[new M(e,t.slice(1),o.eventContext)]:"?"===r?[new k(e,t.slice(1),s)]:new C(e,t,s).parts}handleTextExpression(e){return new A(e)}};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */"undefined"!=typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.2.1");const $=(e,...t)=>new b(e,t,"html",L),I=(e,t)=>`${e}--${t}`;let B=!0;void 0===window.ShadyCSS?B=!1:void 0===window.ShadyCSS.prepareTemplateDom&&(console.warn("Incompatible ShadyCSS version detected. Please update to at least @webcomponents/webcomponentsjs@2.0.2 and @webcomponents/shadycss@1.3.1."),B=!1);const R=e=>t=>{const s=I(t.type,e);let o=H.get(s);void 0===o&&(o={stringsArray:new WeakMap,keyString:new Map},H.set(s,o));let r=o.stringsArray.get(t.strings);if(void 0!==r)return r;const n=t.strings.join(i);if(r=o.keyString.get(n),void 0===r){const s=t.getTemplateElement();B&&window.ShadyCSS.prepareTemplateDom(s,e),r=new c(t,s),o.keyString.set(n,r)}return o.stringsArray.set(t.strings,r),r},U=["html","svg"],W=new Set,K=(e,t,s)=>{W.add(e);const o=s?s.element:document.createElement("template"),r=t.querySelectorAll("style"),{length:i}=r;if(0===i)return void window.ShadyCSS.prepareTemplateStyles(o,e);const n=document.createElement("style");for(let e=0;e<i;e++){const t=r[e];t.parentNode.removeChild(t),n.textContent+=t.textContent}(e=>{U.forEach(t=>{const s=H.get(I(t,e));void 0!==s&&s.keyString.forEach(e=>{const{element:{content:t}}=e,s=new Set;Array.from(t.querySelectorAll("style")).forEach(e=>{s.add(e)}),d(e,s)})})})(e);const a=o.content;s?function(e,t,s=null){const{element:{content:o},parts:r}=e;if(null==s)return void o.appendChild(t);const i=document.createTreeWalker(o,133,null,!1);let n=m(r),a=0,c=-1;for(;i.nextNode();){for(c++,i.currentNode===s&&(a=f(t),s.parentNode.insertBefore(t,s));-1!==n&&r[n].index===c;){if(a>0){for(;-1!==n;)r[n].index+=a,n=m(r,n);return}n=m(r,n)}}}(s,n,a.firstChild):a.insertBefore(n,a.firstChild),window.ShadyCSS.prepareTemplateStyles(o,e);const c=a.querySelector("style");if(window.ShadyCSS.nativeShadow&&null!==c)t.insertBefore(c.cloneNode(!0),t.firstChild);else if(s){a.insertBefore(n,a.firstChild);const e=new Set;e.add(n),d(s,e)}};window.JSCompiler_renameProperty=(e,t)=>e;const z={toAttribute(e,t){switch(t){case Boolean:return e?"":null;case Object:case Array:return null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){switch(t){case Boolean:return null!==e;case Number:return null===e?null:Number(e);case Object:case Array:return JSON.parse(e)}return e}},F=(e,t)=>t!==e&&(t==t||e==e),D={attribute:!0,type:String,converter:z,reflect:!1,hasChanged:F};class J extends HTMLElement{constructor(){super(),this._updateState=0,this._instanceProperties=void 0,this._updatePromise=new Promise(e=>this._enableUpdatingResolver=e),this._changedProperties=new Map,this._reflectingProperties=void 0,this.initialize()}static get observedAttributes(){this.finalize();const e=[];return this._classProperties.forEach((t,s)=>{const o=this._attributeNameForProperty(s,t);void 0!==o&&(this._attributeToPropertyMap.set(o,s),e.push(o))}),e}static _ensureClassProperties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;const e=Object.getPrototypeOf(this)._classProperties;void 0!==e&&e.forEach((e,t)=>this._classProperties.set(t,e))}}static createProperty(e,t=D){if(this._ensureClassProperties(),this._classProperties.set(e,t),t.noAccessor||this.prototype.hasOwnProperty(e))return;const s="symbol"==typeof e?Symbol():`__${e}`,o=this.getPropertyDescriptor(e,s,t);void 0!==o&&Object.defineProperty(this.prototype,e,o)}static getPropertyDescriptor(e,t,s){return{get(){return this[t]},set(s){const o=this[e];this[t]=s,this._requestUpdate(e,o)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this._classProperties&&this._classProperties.get(e)||D}static finalize(){const e=Object.getPrototypeOf(this);if(e.hasOwnProperty("finalized")||e.finalize(),this.finalized=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){const e=this.properties,t=[...Object.getOwnPropertyNames(e),..."function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e):[]];for(const s of t)this.createProperty(s,e[s])}}static _attributeNameForProperty(e,t){const s=t.attribute;return!1===s?void 0:"string"==typeof s?s:"string"==typeof e?e.toLowerCase():void 0}static _valueHasChanged(e,t,s=F){return s(e,t)}static _propertyValueFromAttribute(e,t){const s=t.type,o=t.converter||z,r="function"==typeof o?o:o.fromAttribute;return r?r(e,s):e}static _propertyValueToAttribute(e,t){if(void 0===t.reflect)return;const s=t.type,o=t.converter;return(o&&o.toAttribute||z.toAttribute)(e,s)}initialize(){this._saveInstanceProperties(),this._requestUpdate()}_saveInstanceProperties(){this.constructor._classProperties.forEach((e,t)=>{if(this.hasOwnProperty(t)){const e=this[t];delete this[t],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(t,e)}})}_applyInstanceProperties(){this._instanceProperties.forEach((e,t)=>this[t]=e),this._instanceProperties=void 0}connectedCallback(){this.enableUpdating()}enableUpdating(){void 0!==this._enableUpdatingResolver&&(this._enableUpdatingResolver(),this._enableUpdatingResolver=void 0)}disconnectedCallback(){}attributeChangedCallback(e,t,s){t!==s&&this._attributeToProperty(e,s)}_propertyToAttribute(e,t,s=D){const o=this.constructor,r=o._attributeNameForProperty(e,s);if(void 0!==r){const e=o._propertyValueToAttribute(t,s);if(void 0===e)return;this._updateState=8|this._updateState,null==e?this.removeAttribute(r):this.setAttribute(r,e),this._updateState=-9&this._updateState}}_attributeToProperty(e,t){if(8&this._updateState)return;const s=this.constructor,o=s._attributeToPropertyMap.get(e);if(void 0!==o){const e=s.getPropertyOptions(o);this._updateState=16|this._updateState,this[o]=s._propertyValueFromAttribute(t,e),this._updateState=-17&this._updateState}}_requestUpdate(e,t){let s=!0;if(void 0!==e){const o=this.constructor,r=o.getPropertyOptions(e);o._valueHasChanged(this[e],t,r.hasChanged)?(this._changedProperties.has(e)||this._changedProperties.set(e,t),!0!==r.reflect||16&this._updateState||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(e,r))):s=!1}!this._hasRequestedUpdate&&s&&(this._updatePromise=this._enqueueUpdate())}requestUpdate(e,t){return this._requestUpdate(e,t),this.updateComplete}async _enqueueUpdate(){this._updateState=4|this._updateState;try{await this._updatePromise}catch(e){}const e=this.performUpdate();return null!=e&&await e,!this._hasRequestedUpdate}get _hasRequestedUpdate(){return 4&this._updateState}get hasUpdated(){return 1&this._updateState}performUpdate(){this._instanceProperties&&this._applyInstanceProperties();let e=!1;const t=this._changedProperties;try{e=this.shouldUpdate(t),e?this.update(t):this._markUpdated()}catch(t){throw e=!1,this._markUpdated(),t}e&&(1&this._updateState||(this._updateState=1|this._updateState,this.firstUpdated(t)),this.updated(t))}_markUpdated(){this._changedProperties=new Map,this._updateState=-5&this._updateState}get updateComplete(){return this._getUpdateComplete()}_getUpdateComplete(){return this._updatePromise}shouldUpdate(e){return!0}update(e){void 0!==this._reflectingProperties&&this._reflectingProperties.size>0&&(this._reflectingProperties.forEach((e,t)=>this._propertyToAttribute(t,this[t],e)),this._reflectingProperties=void 0),this._markUpdated()}updated(e){}firstUpdated(e){}}J.finalized=!0;
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const Q=e=>t=>"function"==typeof t?((e,t)=>(window.customElements.define(e,t),t))(e,t):((e,t)=>{const{kind:s,elements:o}=t;return{kind:s,elements:o,finisher(t){window.customElements.define(e,t)}}})(e,t),G=(e,t)=>"method"===t.kind&&t.descriptor&&!("value"in t.descriptor)?Object.assign(Object.assign({},t),{finisher(s){s.createProperty(t.key,e)}}):{kind:"field",key:Symbol(),placement:"own",descriptor:{},initializer(){"function"==typeof t.initializer&&(this[t.key]=t.initializer.call(this))},finisher(s){s.createProperty(t.key,e)}};function X(e){return(t,s)=>void 0!==s?((e,t,s)=>{t.constructor.createProperty(s,e)})(e,t,s):G(e,t)}
/**
@license
Copyright (c) 2019 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
const Y="adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Z=Symbol();class ee{constructor(e,t){if(t!==Z)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e}get styleSheet(){return void 0===this._styleSheet&&(Y?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}const te=(e,...t)=>{const s=t.reduce((t,s,o)=>t+(e=>{if(e instanceof ee)return e.cssText;if("number"==typeof e)return e;throw new Error(`Value passed to 'css' function must be a 'css' function result: ${e}. Use 'unsafeCSS' to pass non-literal values, but\n            take care to ensure page security.`)})(s)+e[o+1],e[0]);return new ee(s,Z)};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
(window.litElementVersions||(window.litElementVersions=[])).push("2.3.1");const se={};class oe extends J{static getStyles(){return this.styles}static _getUniqueStyles(){if(this.hasOwnProperty(JSCompiler_renameProperty("_styles",this)))return;const e=this.getStyles();if(void 0===e)this._styles=[];else if(Array.isArray(e)){const t=(e,s)=>e.reduceRight((e,s)=>Array.isArray(s)?t(s,e):(e.add(s),e),s),s=t(e,new Set),o=[];s.forEach(e=>o.unshift(e)),this._styles=o}else this._styles=[e]}initialize(){super.initialize(),this.constructor._getUniqueStyles(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}createRenderRoot(){return this.attachShadow({mode:"open"})}adoptStyles(){const e=this.constructor._styles;0!==e.length&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow?Y?this.renderRoot.adoptedStyleSheets=e.map(e=>e.styleSheet):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(e.map(e=>e.cssText),this.localName))}connectedCallback(){super.connectedCallback(),this.hasUpdated&&void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this)}update(e){const t=this.render();super.update(e),t!==se&&this.constructor.render(t,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach(e=>{const t=document.createElement("style");t.textContent=e.cssText,this.renderRoot.appendChild(t)}))}render(){return se}}oe.finalized=!0,oe.render=(e,t,s)=>{if(!s||"object"!=typeof s||!s.scopeName)throw new Error("The `scopeName` option is required.");const o=s.scopeName,i=j.has(t),n=B&&11===t.nodeType&&!!t.host,a=n&&!W.has(o),c=a?document.createDocumentFragment():t;if(((e,t,s)=>{let o=j.get(t);void 0===o&&(r(t,t.firstChild),j.set(t,o=new A(Object.assign({templateFactory:V},s))),o.appendInto(t)),o.setValue(e),o.commit()})(e,c,Object.assign({templateFactory:R(o)},s)),a){const e=j.get(c);j.delete(c);const s=e.value instanceof _?e.value.template:void 0;K(o,c,s),r(t,t.firstChild),t.appendChild(c),j.set(t,e)}!i&&n&&window.ShadyCSS.styleElement(t.host)};function re(e){const t={};for(const s of e)t[s.row+","+s.col]=!0;return Object.keys(t).map(e=>({row:parseInt(e.split(",")[0]),col:parseInt(e.split(",")[1])}))}const ie=Error("not implemented");var ne,ae;!function(e){e.WHITE="white",e.BLACK="black"}(ne||(ne={})),function(e){e.MOVE="move",e.CASTLE="castle",e.ENPASSANT="enpassant"}(ae||(ae={}));
/**
 * @license
 * Copyright (c) 2019 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
var ce=function(e,t,s,o){var r,i=arguments.length,n=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(n=(i<3?r(n):i>3?r(t,s,n):r(t,s))||n);return i>3&&n&&Object.defineProperty(t,s,n),n};let le=class extends oe{render(){return $`
      <div
        class="piece"
        style="background-image:url(/dist/img/${this.piece.img})"
      ></div>
    `}};le.styles=te`
    .piece {
      height: 100%;
      width: 100%;
      display: inline-block;
      background-image: url('/dist/img/_dt.png');
      background-size: cover;
    }
  `,ce([X({type:Object})],le.prototype,"piece",void 0),le=ce([Q("my-piece")],le);var he=function(e,t,s,o){var r,i=arguments.length,n=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(n=(i<3?r(n):i>3?r(t,s,n):r(t,s))||n);return i>3&&n&&Object.defineProperty(t,s,n),n};let pe=class extends oe{constructor(){super(...arguments),this.selected=!1,this.possible=!1}render(){return $`
      <div
        class="square"
        @click=${this._onClick}
        style="
        height:100%;width:100%;background-color:${this.selected?"rgba(0, 0, 255, 0.3)":this.possible?"rgba(0, 255, 0, 0.3)":""};transform:${this.color===ne.BLACK?"rotate(180deg)":""};
      "
      >
        ${this.piece&&$`<my-piece .piece=${this.piece}></my-piece>`}
      </div>
    `}_onClick(){this.dispatchEvent(new CustomEvent("square-clicked",{bubbles:!0,composed:!0,detail:this.square}))}};pe.styles=te`
    :host {
      height: ${50}px;
      width: ${50}px;
      display: inline-block;
    }

    .square {
      height: '100%';
      width: '100%';
      display: 'inline-block';
    }
  `,he([X({type:Object})],pe.prototype,"square",void 0),he([X({type:Object})],pe.prototype,"piece",void 0),he([X({type:String})],pe.prototype,"color",void 0),he([X({type:Boolean})],pe.prototype,"selected",void 0),he([X({type:Boolean})],pe.prototype,"possible",void 0),pe=he([Q("my-square")],pe);class ue{constructor(e,t){this.row=e,this.col=t}get occupant(){return this.piece}toString(){return this.occupant?`[${this.occupant.toString()}]`:"[ ]"}render(){const e=document.createElement("div");return e.setAttribute("class","square"),this.occupant&&e.appendChild(this.occupant.render()),e.onclick=t=>{e.dispatchEvent(new CustomEvent("square-clicked",{detail:this}))},e}empty(){this.piece=void 0}place(e){this.piece=e}}class de{constructor(e){this.ranks=8,this.files=8,this.ranks=e.length,this.files=e[0].length;const t=[];for(const s of e){const e=[];for(const t of s){const s=new ue(t.row,t.col);e.push(s),t.occupant&&s.place(t.occupant)}t.push(e)}this.squares=t}place(e,t,s){const o=this.getSquare(t,s);if(!o)throw new Error("square out of bounds"+t+","+s);return o.place(e),this}empty(e,t){const s=this.getSquare(e,t);if(!s)throw new Error("square out of bounds"+e+","+t);return s.empty(),this}getSquare(e,t){var s;return null===(s=this.squares[e])||void 0===s?void 0:s[t]}toString(){let e="";for(const t of this.squares){for(const s of t)e+=s.toString();e+="<br>"}return e}}class fe{constructor(e){this.color=e}legalMoves(e,t,s,o){return[]}toString(){return this.name}get img(){return this.color===ne.WHITE?"_lt.png":"_dt.png"}render(){const e=document.createElement("div");return e.setAttribute("class","piece"),e.style.backgroundImage=`url(/dist/img/${this.img})`,e}}class me extends fe{legalMoves(e,t,s){var o;let r=this.moves.flatMap(e=>[-1,1].map(t=>e.row*t).flatMap(t=>[-1,1].flatMap(s=>[{row:t,col:e.col*s},{row:e.col*s,col:t}]))).map(s=>({row:e+s.row,col:t+s.col}));r=r.filter(e=>!(e.row<0||e.col<0||e.row>=s.ranks||e.col>=s.files)),r=r.filter(e=>{var t;const o=null===(t=s.getSquare(e.row,e.col))||void 0===t?void 0:t.occupant;return!o||o.color!==this.color});const i=[];for(const n of re(r)){const r=null===(o=s.getSquare(n.row,n.col))||void 0===o?void 0:o.occupant,a=r&&r.color!==this.color;i.push({before:s,after:new de(s.squares).place(this,n.row,n.col).empty(e,t),piece:this,start:{row:e,col:t},end:n,isCapture:a,captured:r?[r]:[],color:this.color,type:ae.MOVE})}return i}}class ge extends fe{legalMoves(e,t,s){return re(this.moves.flatMap(e=>[-1,1].map(t=>e.row*t).flatMap(t=>[-1,1].flatMap(s=>[{row:t,col:e.col*s},{row:e.col*s,col:t}])))).flatMap(o=>this.ride(e,t,o.row,o.col,s))}ride(e,t,s,o,r){const i=[];let n=r.getSquare(e+s,t+o);for(;n;){if(!n.occupant||n.occupant.color!==this.color){const s=n.occupant&&n.occupant.color!==this.color;i.push({before:r,after:new de(r.squares).place(this,n.row,n.col).empty(e,t),piece:this,start:{row:e,col:t},end:n,isCapture:s,captured:s?[n.occupant]:[],color:this.color,type:ae.MOVE})}if(n.occupant)break;n=r.getSquare(n.row+s,n.col+o)}return i}}class ye extends ge{constructor(){super(...arguments),this.name="B",this.moves=[{row:1,col:1}]}get img(){if(this.color===ne.BLACK)return"bdt.png";if(this.color===ne.WHITE)return"blt.png";throw new Error("no image for color: "+this.color+"for piece "+this.name)}}class we extends ge{constructor(){super(...arguments),this.name="R",this.moves=[{row:1,col:0}]}get img(){if(this.color===ne.BLACK)return"rdt45.png";if(this.color===ne.WHITE)return"rlt45.png";throw new Error("no image for color: "+this.color+"for piece "+this.name)}}class ve extends me{constructor(){super(...arguments),this.name="N",this.moves=[{row:1,col:2}]}get img(){if(this.color===ne.BLACK)return"ndt26.png";if(this.color===ne.WHITE)return"nlt.png";throw new Error("no image for color: "+this.color+"for piece "+this.name)}}class _e extends ge{constructor(){super(...arguments),this.name="Q",this.moves=[{row:1,col:1},{row:1,col:0}]}get img(){if(this.color===ne.BLACK)return"qdt45.png";if(this.color===ne.WHITE)return"qlt45.png";throw new Error("no image for color: "+this.color+"for piece "+this.name)}}class Se extends me{constructor(){super(...arguments),this.name="K",this.moves=[{row:1,col:1},{row:1,col:0}],this.isRoyal=!0}get img(){if(this.color===ne.BLACK)return"kdt45.png";if(this.color===ne.WHITE)return"klt.png";throw new Error("no image for color: "+this.color+"for piece "+this.name)}}class be extends fe{constructor(){super(...arguments),this.name="P"}legalMoves(e,t,s,o){const r=this.color===ne.WHITE?-1:1;let i=[{row:e+r,col:t}];(1===e&&this.color===ne.BLACK||e===s.ranks-1-1&&this.color===ne.WHITE)&&i.push({row:e+2*r,col:t}),i=i.filter(e=>!s.getSquare(e.row,e.col).occupant);let n=[{row:e+r,col:t-1},{row:e+r,col:t+1}];n=n.filter(e=>{var t;const o=null===(t=s.getSquare(e.row,e.col))||void 0===t?void 0:t.occupant;return o&&o.color!==this.color});const a=[];for(const o of i)a.push({before:s,after:new de(s.squares).place(this,o.row,o.col).empty(e,t),piece:this,start:{row:e,col:t},end:o,isCapture:!1,captured:[],color:this.color,type:ae.MOVE});for(const o of n)a.push({before:s,after:new de(s.squares).place(this,o.row,o.col).empty(e,t),piece:this,start:{row:e,col:t},end:o,isCapture:!0,captured:[s.getSquare(o.row,o.col).occupant],color:this.color,type:ae.MOVE});const c=this.enPassant(e,t,s,o);return c&&a.push(c),a}enPassant(e,t,s,o){const r=this.color===ne.WHITE?-1:1;if(o.length){const i=o[o.length-1];if(i.piece instanceof be&&i.piece.color!==this.color&&1===Math.abs(i.end.col-t)&&2===Math.abs(i.end.row-i.start.row)&&i.end.row===e){const o=s,n={row:e,col:t},a={row:e+r,col:i.end.col},c=!0,l=c?[i.piece]:[],h=this.color,p=ae.ENPASSANT;return{before:o,after:new de(s.squares).place(this,a.row,a.col).empty(e,t).empty(i.end.row,i.end.col),piece:this,start:n,end:a,isCapture:c,captured:l,color:h,type:p}}}}promote(){}get img(){if(this.color===ne.BLACK)return"pdt45.png";if(this.color===ne.WHITE)return"plt45.png";throw new Error("no image for color: "+this.color+"for piece "+this.name)}}class Pe{constructor(e){this.state=null!=e?e:function(){var e;const t={0:{0:new we(ne.BLACK),1:new ve(ne.BLACK),2:new ye(ne.BLACK),3:new _e(ne.BLACK),4:new Se(ne.BLACK),5:new ye(ne.BLACK),6:new ve(ne.BLACK),7:new we(ne.BLACK)},1:{},6:{},7:{0:new we(ne.WHITE),1:new ve(ne.WHITE),2:new ye(ne.WHITE),3:new _e(ne.WHITE),4:new Se(ne.WHITE),5:new ye(ne.WHITE),6:new ve(ne.WHITE),7:new we(ne.WHITE)}};for(let e=0;e<8;e++)t[1][e]=new be(ne.BLACK),t[6][e]=new be(ne.WHITE);const s=[];for(let o=0;o<8;o++){const r=[];for(let s=0;s<8;s++){const i=new ue(o,s);r.push(i),(null===(e=t[o])||void 0===e?void 0:e[s])&&i.place(t[o][s])}s.push(r)}return new de(s)}(),this.moveHistory=[],this.stateHistory=[]}get rules(){throw ie}place(e,t,s){this.state.place(e,t,s)}winCondition(e,t){throw ie}move(){}attemptMove(e,t,s,o){if(e instanceof Se&&t===o.row&&2===Math.abs(s-o.col))return void this.castle(e.color,t,s,o.col-s>0);const r=e.legalMoves(t,s,this.state,this.moveHistory).filter(e=>this.isMoveLegal(e)),i=r.find(e=>{return t=e.end,s=o,t.row===s.row&&t.col===s.col;var t,s});if(!i)return console.log("invalid move",e.name,o),void console.log("legal moves are",r);i.isCapture&&this.captureEffects(),this.moveHistory.push(i),this.stateHistory.push(i.after),this.state=i.after}castle(e,t,s,o){let r,i,n;if(console.log("attempting castle"),this.moveHistory.some(e=>e.piece instanceof Se))return void console.log("king moved");const a=this.state.squares.flat().filter(t=>t.occupant&&t.occupant instanceof we&&t.occupant.color===e);if(!a)return void console.log("no rooks");if(o){r={row:e===ne.BLACK?0:this.state.ranks-1,col:this.state.files-2},i=[s];for(let e=s+1;e<=r.col;e++)i.push(e);n=a.sort(e=>e.col)[a.length-1]}else{r={row:e===ne.BLACK?0:this.state.ranks-1,col:2},i=[s];for(let e=s-1;e>=r.col;e--)i.push(e);n=a.sort(e=>e.col)[0]}if(this.moveHistory.some(e=>e.piece===n.occupant))return void console.log("rook moved");if(i.some(s=>this.isAttackedSquare(e,this.state,t,s)||this.state.getSquare(t,s).occupant&&this.state.getSquare(t,s).occupant!==n.occupant&&!(this.state.getSquare(t,s).occupant instanceof Se)))return void console.log("cannot castle, attacked on way");const c=this.state,l=new de(this.state.squares).empty(n.row,n.col).empty(t,s).place(new Se(e),r.row,r.col).place(new we(e),r.row,r.col+(o?-1:1)),h=ae.CASTLE;this.moveHistory.push({before:c,after:l,isCapture:!1,captured:[],type:h,color:e}),this.stateHistory.push(l),this.state=l}isMoveLegal(e){return!(e.end.row<0||e.end.row>=this.state.ranks||e.end.col<0||e.end.col>=this.state.files)&&!this.isInCheck(e.color,e.after)}isInCheck(e,t){return t.squares.flat().filter(t=>!!t.occupant&&t.occupant.color!==e).flatMap(e=>e.occupant.legalMoves(e.row,e.col,t,[])).some(e=>e.captured.some(e=>e.isRoyal))}isAttackedSquare(e,t,s,o){const r=new fe(e),i=new de(t.squares).place(r,s,o);return t.squares.flat().filter(t=>!!t.occupant&&t.occupant.color!==e).flatMap(e=>e.occupant.legalMoves(e.row,e.col,i,[])).some(e=>e.captured.some(e=>e===r))}captureEffects(){}}
/**
 * @license
 * Copyright (c) 2019 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */var xe=function(e,t,s,o){var r,i=arguments.length,n=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(n=(i<3?r(n):i>3?r(t,s,n):r(t,s))||n);return i>3&&n&&Object.defineProperty(t,s,n),n};let Ce=class extends oe{constructor(){super(...arguments),this.game=new Pe,this.count=0}connectedCallback(){super.connectedCallback(),this.addEventListener("square-clicked",this.onSquareClicked.bind(this))}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("square-clicked",this.onSquareClicked.bind(this))}render(){const e=this.game.state;return this.style.setProperty("height",`${50*e.squares.length}px`),this.style.setProperty("width",`${50*e.squares[0].length}px`),this.color===ne.BLACK&&this.style.setProperty("transform","rotate(180deg)"),$`
      <div id="board">
        ${e.squares.map(e=>$`<div class="row">
            ${e.map(e=>$`<my-square
                .square=${e}
                .piece=${e.occupant}
                .selected=${e===this.selectedSquare}
                .possible=${this.possibleMoves.includes(e)}
                .color=${this.color}
              ></my-square>`)}
          </div>`)}
      </div>
    `}onSquareClicked(e){const t=e.detail;if(this.selectedPiece){if(this.selectedPiece===t.occupant)return void(this.selectedPiece=null);this.game.attemptMove(this.selectedPiece,this.selectedSquare.row,this.selectedSquare.col,t);this.selectedSquare=null,this.selectedPiece=null}else this.selectedSquare=t,this.selectedPiece=t.occupant;this.performUpdate()}get possibleMoves(){return this.selectedPiece?this.selectedPiece.legalMoves(this.selectedSquare.row,this.selectedSquare.col,this.game.state,this.game.moveHistory).filter(e=>this.game.isMoveLegal(e)).map(e=>this.game.state.getSquare(e.end.row,e.end.col)):[]}};Ce.styles=te`
    :host {
      display: block;
      border: solid 1px gray;
      padding: 16px;
      max-width: 800px;
    }

    #board {
      background-image: url('/dist/img/bg.svg');
      display: inline-block;
    }

    .row {
      height: ${50}px;
    }
  `,xe([X({type:String})],Ce.prototype,"color",void 0),xe([X({type:Object})],Ce.prototype,"game",void 0),xe([X({type:Object})],Ce.prototype,"selectedPiece",void 0),xe([X({type:Object})],Ce.prototype,"selectedSquare",void 0),xe([X({type:Number})],Ce.prototype,"count",void 0),Ce=xe([Q("my-element")],Ce)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2xpdC1odG1sL2xpYi9kb20uanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2xpdC1odG1sL2xpYi90ZW1wbGF0ZS5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbGl0LWh0bWwvbGliL21vZGlmeS10ZW1wbGF0ZS5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbGl0LWh0bWwvbGliL2RpcmVjdGl2ZS5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbGl0LWh0bWwvbGliL3BhcnQuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2xpdC1odG1sL2xpYi90ZW1wbGF0ZS1pbnN0YW5jZS5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbGl0LWh0bWwvbGliL3RlbXBsYXRlLXJlc3VsdC5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbGl0LWh0bWwvbGliL3BhcnRzLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9saXQtaHRtbC9saWIvdGVtcGxhdGUtZmFjdG9yeS5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbGl0LWh0bWwvbGliL3JlbmRlci5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbGl0LWh0bWwvbGliL2RlZmF1bHQtdGVtcGxhdGUtcHJvY2Vzc29yLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9saXQtaHRtbC9saXQtaHRtbC5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbGl0LWh0bWwvbGliL3NoYWR5LXJlbmRlci5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbGl0LWVsZW1lbnQvbGliL3VwZGF0aW5nLWVsZW1lbnQuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2xpdC1lbGVtZW50L2xpYi9kZWNvcmF0b3JzLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9saXQtZWxlbWVudC9saWIvY3NzLXRhZy5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbGl0LWVsZW1lbnQvbGl0LWVsZW1lbnQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NoZXNzL2NvbnN0LnRzIiwid2VicGFjazovLy8uL3NyYy91aS9teS1waWVjZS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvdWkvbXktc3F1YXJlLnRzIiwid2VicGFjazovLy8uL3NyYy9jaGVzcy9zcXVhcmUudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NoZXNzL3N0YXRlLnRzIiwid2VicGFjazovLy8uL3NyYy9jaGVzcy9waWVjZS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvY2hlc3MvZ2FtZS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvdWkvbXktZWxlbWVudC50cyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsImlzQ0VQb2x5ZmlsbCIsIndpbmRvdyIsImN1c3RvbUVsZW1lbnRzIiwidW5kZWZpbmVkIiwicG9seWZpbGxXcmFwRmx1c2hDYWxsYmFjayIsInJlbW92ZU5vZGVzIiwiY29udGFpbmVyIiwic3RhcnQiLCJlbmQiLCJuZXh0U2libGluZyIsInJlbW92ZUNoaWxkIiwibWFya2VyIiwiU3RyaW5nIiwiTWF0aCIsInJhbmRvbSIsInNsaWNlIiwibm9kZU1hcmtlciIsIm1hcmtlclJlZ2V4IiwiUmVnRXhwIiwiVGVtcGxhdGUiLCJyZXN1bHQiLCJlbGVtZW50IiwidGhpcyIsInBhcnRzIiwibm9kZXNUb1JlbW92ZSIsInN0YWNrIiwid2Fsa2VyIiwiZG9jdW1lbnQiLCJjcmVhdGVUcmVlV2Fsa2VyIiwiY29udGVudCIsImxhc3RQYXJ0SW5kZXgiLCJpbmRleCIsInBhcnRJbmRleCIsInN0cmluZ3MiLCJ2YWx1ZXMiLCJsZW5ndGgiLCJub2RlIiwibmV4dE5vZGUiLCJub2RlVHlwZSIsImhhc0F0dHJpYnV0ZXMiLCJhdHRyaWJ1dGVzIiwiY291bnQiLCJlbmRzV2l0aCIsInN0cmluZ0ZvclBhcnQiLCJsYXN0QXR0cmlidXRlTmFtZVJlZ2V4IiwiZXhlYyIsImF0dHJpYnV0ZUxvb2t1cE5hbWUiLCJ0b0xvd2VyQ2FzZSIsImF0dHJpYnV0ZVZhbHVlIiwiZ2V0QXR0cmlidXRlIiwicmVtb3ZlQXR0cmlidXRlIiwic3RhdGljcyIsInNwbGl0IiwicHVzaCIsInR5cGUiLCJ0YWdOYW1lIiwiY3VycmVudE5vZGUiLCJkYXRhIiwiaW5kZXhPZiIsInBhcmVudCIsInBhcmVudE5vZGUiLCJsYXN0SW5kZXgiLCJpbnNlcnQiLCJjcmVhdGVNYXJrZXIiLCJtYXRjaCIsImNyZWF0ZVRleHROb2RlIiwiaW5zZXJ0QmVmb3JlIiwicHJldmlvdXNTaWJsaW5nIiwicG9wIiwic3RyIiwic3VmZml4IiwiaXNUZW1wbGF0ZVBhcnRBY3RpdmUiLCJwYXJ0IiwiY3JlYXRlQ29tbWVudCIsInJlbW92ZU5vZGVzRnJvbVRlbXBsYXRlIiwidGVtcGxhdGUiLCJuZXh0QWN0aXZlSW5kZXhJblRlbXBsYXRlUGFydHMiLCJub2RlSW5kZXgiLCJyZW1vdmVDb3VudCIsIm5vZGVzVG9SZW1vdmVJblRlbXBsYXRlIiwiY3VycmVudFJlbW92aW5nTm9kZSIsImhhcyIsImZvckVhY2giLCJjb3VudE5vZGVzIiwic3RhcnRJbmRleCIsImRpcmVjdGl2ZXMiLCJXZWFrTWFwIiwiaXNEaXJlY3RpdmUiLCJub0NoYW5nZSIsIm5vdGhpbmciLCJwcm9jZXNzb3IiLCJvcHRpb25zIiwiX19wYXJ0cyIsInNldFZhbHVlIiwiY29tbWl0IiwiZnJhZ21lbnQiLCJjbG9uZU5vZGUiLCJpbXBvcnROb2RlIiwibm9kZU5hbWUiLCJoYW5kbGVUZXh0RXhwcmVzc2lvbiIsImluc2VydEFmdGVyTm9kZSIsImhhbmRsZUF0dHJpYnV0ZUV4cHJlc3Npb25zIiwiYWRvcHROb2RlIiwidXBncmFkZSIsImNvbW1lbnRNYXJrZXIiLCJodG1sIiwiaXNDb21tZW50QmluZGluZyIsImNvbW1lbnRPcGVuIiwibGFzdEluZGV4T2YiLCJhdHRyaWJ1dGVNYXRjaCIsInN1YnN0ciIsImNyZWF0ZUVsZW1lbnQiLCJpbm5lckhUTUwiLCJnZXRIVE1MIiwiaXNQcmltaXRpdmUiLCJpc0l0ZXJhYmxlIiwiQXJyYXkiLCJpc0FycmF5IiwiaXRlcmF0b3IiLCJBdHRyaWJ1dGVDb21taXR0ZXIiLCJkaXJ0eSIsIl9jcmVhdGVQYXJ0IiwidGV4dCIsInYiLCJzZXRBdHRyaWJ1dGUiLCJfZ2V0VmFsdWUiLCJjb21taXR0ZXIiLCJkaXJlY3RpdmUiLCJfX3BlbmRpbmdWYWx1ZSIsInN0YXJ0Tm9kZSIsImFwcGVuZENoaWxkIiwiZW5kTm9kZSIsInJlZiIsIl9faW5zZXJ0IiwiX19jb21taXRUZXh0IiwiX19jb21taXRUZW1wbGF0ZVJlc3VsdCIsIk5vZGUiLCJfX2NvbW1pdE5vZGUiLCJfX2NvbW1pdEl0ZXJhYmxlIiwiY2xlYXIiLCJ2YWx1ZUFzU3RyaW5nIiwidGVtcGxhdGVGYWN0b3J5IiwidXBkYXRlIiwiaW5zdGFuY2UiLCJfY2xvbmUiLCJpdGVtUGFydHMiLCJpdGVtUGFydCIsIml0ZW0iLCJhcHBlbmRJbnRvUGFydCIsImluc2VydEFmdGVyUGFydCIsIkVycm9yIiwiUHJvcGVydHlDb21taXR0ZXIiLCJzdXBlciIsInNpbmdsZSIsIlByb3BlcnR5UGFydCIsImV2ZW50T3B0aW9uc1N1cHBvcnRlZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiX2UiLCJldmVudE5hbWUiLCJldmVudENvbnRleHQiLCJfX2JvdW5kSGFuZGxlRXZlbnQiLCJlIiwiaGFuZGxlRXZlbnQiLCJuZXdMaXN0ZW5lciIsIm9sZExpc3RlbmVyIiwic2hvdWxkUmVtb3ZlTGlzdGVuZXIiLCJjYXB0dXJlIiwib25jZSIsInBhc3NpdmUiLCJzaG91bGRBZGRMaXN0ZW5lciIsIl9fb3B0aW9ucyIsImdldE9wdGlvbnMiLCJldmVudCIsInRlbXBsYXRlQ2FjaGUiLCJ0ZW1wbGF0ZUNhY2hlcyIsInN0cmluZ3NBcnJheSIsImtleVN0cmluZyIsIk1hcCIsInNldCIsImpvaW4iLCJnZXRUZW1wbGF0ZUVsZW1lbnQiLCJkZWZhdWx0VGVtcGxhdGVQcm9jZXNzb3IiLCJwcmVmaXgiLCJnZXRUZW1wbGF0ZUNhY2hlS2V5Iiwic2NvcGVOYW1lIiwiY29tcGF0aWJsZVNoYWR5Q1NTVmVyc2lvbiIsIlNoYWR5Q1NTIiwicHJlcGFyZVRlbXBsYXRlRG9tIiwiY29uc29sZSIsIndhcm4iLCJzaGFkeVRlbXBsYXRlRmFjdG9yeSIsImNhY2hlS2V5IiwiVEVNUExBVEVfVFlQRVMiLCJzaGFkeVJlbmRlclNldCIsIlNldCIsInByZXBhcmVUZW1wbGF0ZVN0eWxlcyIsInJlbmRlcmVkRE9NIiwiYWRkIiwidGVtcGxhdGVFbGVtZW50Iiwic3R5bGVzIiwicXVlcnlTZWxlY3RvckFsbCIsImNvbmRlbnNlZFN0eWxlIiwic3R5bGUiLCJ0ZXh0Q29udGVudCIsInRlbXBsYXRlcyIsImZyb20iLCJyZW1vdmVTdHlsZXNGcm9tTGl0VGVtcGxhdGVzIiwicmVmTm9kZSIsImluc2VydENvdW50Iiwid2Fsa2VySW5kZXgiLCJpbnNlcnROb2RlSW50b1RlbXBsYXRlIiwiZmlyc3RDaGlsZCIsInF1ZXJ5U2VsZWN0b3IiLCJuYXRpdmVTaGFkb3ciLCJyZW1vdmVzIiwiSlNDb21waWxlcl9yZW5hbWVQcm9wZXJ0eSIsInByb3AiLCJfb2JqIiwiZGVmYXVsdENvbnZlcnRlciIsIkJvb2xlYW4iLCJKU09OIiwic3RyaW5naWZ5IiwiTnVtYmVyIiwicGFyc2UiLCJub3RFcXVhbCIsIm9sZCIsImRlZmF1bHRQcm9wZXJ0eURlY2xhcmF0aW9uIiwiYXR0cmlidXRlIiwiY29udmVydGVyIiwicmVmbGVjdCIsImhhc0NoYW5nZWQiLCJVcGRhdGluZ0VsZW1lbnQiLCJIVE1MRWxlbWVudCIsIl91cGRhdGVTdGF0ZSIsIl9pbnN0YW5jZVByb3BlcnRpZXMiLCJfdXBkYXRlUHJvbWlzZSIsIlByb21pc2UiLCJyZXMiLCJfZW5hYmxlVXBkYXRpbmdSZXNvbHZlciIsIl9jaGFuZ2VkUHJvcGVydGllcyIsIl9yZWZsZWN0aW5nUHJvcGVydGllcyIsImluaXRpYWxpemUiLCJmaW5hbGl6ZSIsIl9jbGFzc1Byb3BlcnRpZXMiLCJhdHRyIiwiX2F0dHJpYnV0ZU5hbWVGb3JQcm9wZXJ0eSIsIl9hdHRyaWJ1dGVUb1Byb3BlcnR5TWFwIiwic3VwZXJQcm9wZXJ0aWVzIiwiZ2V0UHJvdG90eXBlT2YiLCJrIiwiX2Vuc3VyZUNsYXNzUHJvcGVydGllcyIsIm5vQWNjZXNzb3IiLCJkZXNjcmlwdG9yIiwiZ2V0UHJvcGVydHlEZXNjcmlwdG9yIiwiX29wdGlvbnMiLCJvbGRWYWx1ZSIsIl9yZXF1ZXN0VXBkYXRlIiwiY29uZmlndXJhYmxlIiwic3VwZXJDdG9yIiwicHJvcHMiLCJwcm9wZXJ0aWVzIiwicHJvcEtleXMiLCJnZXRPd25Qcm9wZXJ0eU5hbWVzIiwiZ2V0T3duUHJvcGVydHlTeW1ib2xzIiwiY3JlYXRlUHJvcGVydHkiLCJmcm9tQXR0cmlidXRlIiwidG9BdHRyaWJ1dGUiLCJfc2F2ZUluc3RhbmNlUHJvcGVydGllcyIsImNvbnN0cnVjdG9yIiwiX3YiLCJlbmFibGVVcGRhdGluZyIsIl9hdHRyaWJ1dGVUb1Byb3BlcnR5IiwiY3RvciIsImF0dHJWYWx1ZSIsIl9wcm9wZXJ0eVZhbHVlVG9BdHRyaWJ1dGUiLCJwcm9wTmFtZSIsImdldFByb3BlcnR5T3B0aW9ucyIsIl9wcm9wZXJ0eVZhbHVlRnJvbUF0dHJpYnV0ZSIsInNob3VsZFJlcXVlc3RVcGRhdGUiLCJfdmFsdWVIYXNDaGFuZ2VkIiwiX2hhc1JlcXVlc3RlZFVwZGF0ZSIsIl9lbnF1ZXVlVXBkYXRlIiwidXBkYXRlQ29tcGxldGUiLCJwZXJmb3JtVXBkYXRlIiwiX2FwcGx5SW5zdGFuY2VQcm9wZXJ0aWVzIiwic2hvdWxkVXBkYXRlIiwiY2hhbmdlZFByb3BlcnRpZXMiLCJfbWFya1VwZGF0ZWQiLCJmaXJzdFVwZGF0ZWQiLCJ1cGRhdGVkIiwiX2dldFVwZGF0ZUNvbXBsZXRlIiwic2l6ZSIsIl9wcm9wZXJ0eVRvQXR0cmlidXRlIiwiY3VzdG9tRWxlbWVudCIsImNsYXNzT3JEZXNjcmlwdG9yIiwiY2xhenoiLCJkZWZpbmUiLCJsZWdhY3lDdXN0b21FbGVtZW50Iiwia2luZCIsImVsZW1lbnRzIiwic3RhbmRhcmRDdXN0b21FbGVtZW50Iiwic3RhbmRhcmRQcm9wZXJ0eSIsImFzc2lnbiIsInBsYWNlbWVudCIsImluaXRpYWxpemVyIiwicHJvdG9PckRlc2NyaXB0b3IiLCJwcm90byIsImxlZ2FjeVByb3BlcnR5Iiwic3VwcG9ydHNBZG9wdGluZ1N0eWxlU2hlZXRzIiwiRG9jdW1lbnQiLCJDU1NTdHlsZVNoZWV0IiwiY29uc3RydWN0aW9uVG9rZW4iLCJDU1NSZXN1bHQiLCJjc3NUZXh0Iiwic2FmZVRva2VuIiwiX3N0eWxlU2hlZXQiLCJyZXBsYWNlU3luYyIsImNzcyIsInJlZHVjZSIsImFjYyIsImlkeCIsInRleHRGcm9tQ1NTUmVzdWx0IiwicmVuZGVyTm90SW1wbGVtZW50ZWQiLCJ1c2VyU3R5bGVzIiwiZ2V0U3R5bGVzIiwiX3N0eWxlcyIsImFkZFN0eWxlcyIsInJlZHVjZVJpZ2h0IiwidW5zaGlmdCIsIl9nZXRVbmlxdWVTdHlsZXMiLCJyZW5kZXJSb290IiwiY3JlYXRlUmVuZGVyUm9vdCIsIlNoYWRvd1Jvb3QiLCJhZG9wdFN0eWxlcyIsImF0dGFjaFNoYWRvdyIsImFkb3B0ZWRTdHlsZVNoZWV0cyIsIm1hcCIsInN0eWxlU2hlZXQiLCJfbmVlZHNTaGltQWRvcHRlZFN0eWxlU2hlZXRzIiwiU2NvcGluZ1NoaW0iLCJwcmVwYXJlQWRvcHRlZENzc1RleHQiLCJsb2NhbE5hbWUiLCJjb25uZWN0ZWRDYWxsYmFjayIsImhhc1VwZGF0ZWQiLCJzdHlsZUVsZW1lbnQiLCJ0ZW1wbGF0ZVJlc3VsdCIsInJlbmRlciIsImhhc1JlbmRlcmVkIiwibmVlZHNTY29waW5nIiwiaG9zdCIsImZpcnN0U2NvcGVSZW5kZXIiLCJyZW5kZXJDb250YWluZXIiLCJjcmVhdGVEb2N1bWVudEZyYWdtZW50IiwiYXBwZW5kSW50byIsImRlbGV0ZSIsImRlZHVwIiwicm93IiwiY29sIiwia2V5cyIsInBhcnNlSW50IiwiTm90SW1wbGVtZW50ZWRFcnJvciIsIkNvbG9yIiwiTW92ZVR5cGUiLCJwaWVjZSIsImltZyIsInNlbGVjdGVkIiwicG9zc2libGUiLCJfb25DbGljayIsImNvbG9yIiwiQkxBQ0siLCJkaXNwYXRjaEV2ZW50IiwiQ3VzdG9tRXZlbnQiLCJidWJibGVzIiwiY29tcG9zZWQiLCJkZXRhaWwiLCJzcXVhcmUiLCJTcXVhcmUiLCJvY2N1cGFudCIsInRvU3RyaW5nIiwib25jbGljayIsInNxdWFyZXMiLCJyYW5rcyIsImZpbGVzIiwibmV3U3F1YXJlcyIsIm5ld1JvdyIsIm5ld1NxdWFyZSIsInBsYWNlIiwiZ2V0U3F1YXJlIiwiZW1wdHkiLCJzdGF0ZSIsIm1vdmVIaXN0b3J5IiwiV0hJVEUiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJ0YXJnZXRzIiwibW92ZXMiLCJmbGF0TWFwIiwibW92ZSIsInNpZ24iLCJmaXJzdCIsInJlbGF0aXZlIiwiZmlsdGVyIiwidGFyZ2V0IiwiaXNDYXB0dXJlIiwiYmVmb3JlIiwiYWZ0ZXIiLCJjYXB0dXJlZCIsIk1PVkUiLCJkaXIiLCJyaWRlIiwicm93RGlyIiwiY29sRGlyIiwiaXNSb3lhbCIsInlEaXIiLCJtb3ZlVGFyZ2V0cyIsImNhcHR1cmVUYXJnZXRzIiwiZW5wYXNzYW50IiwiZW5QYXNzYW50IiwibGFzdE1vdmUiLCJhYnMiLCJFTlBBU1NBTlQiLCJpbml0aWFsIiwicGllY2VQb3NpdGlvbnMiLCIwIiwiMSIsIjIiLCIzIiwiNCIsIjUiLCI2IiwiNyIsImoiLCJnZW5lcmF0ZVN0YXJ0U3RhdGUiLCJzdGF0ZUhpc3RvcnkiLCJjYXN0bGUiLCJsZWdhbE1vdmVzIiwiaXNNb3ZlTGVnYWwiLCJsZWdhbE1vdmUiLCJmaW5kIiwiZXF1YWxzIiwiYSIsImIiLCJsb2ciLCJjYXB0dXJlRWZmZWN0cyIsImtpbmdzaWRlIiwiY29scyIsInJvb2tTcXVhcmUiLCJzb21lIiwicm9va1NxdWFyZXMiLCJmbGF0Iiwic29ydCIsInRyYXZlbENvbCIsImlzQXR0YWNrZWRTcXVhcmUiLCJDQVNUTEUiLCJpc0luQ2hlY2siLCJkdW1teSIsInN0YXRlV2l0aER1bW15IiwiZ2FtZSIsIm9uU3F1YXJlQ2xpY2tlZCIsImRpc2Nvbm5lY3RlZENhbGxiYWNrIiwic2V0UHJvcGVydHkiLCJzZWxlY3RlZFNxdWFyZSIsInBvc3NpYmxlTW92ZXMiLCJpbmNsdWRlcyIsInNlbGVjdGVkUGllY2UiLCJhdHRlbXB0TW92ZSJdLCJtYXBwaW5ncyI6ImFBQ0UsSUFBSUEsRUFBbUIsR0FHdkIsU0FBU0MsRUFBb0JDLEdBRzVCLEdBQUdGLEVBQWlCRSxHQUNuQixPQUFPRixFQUFpQkUsR0FBVUMsUUFHbkMsSUFBSUMsRUFBU0osRUFBaUJFLEdBQVksQ0FDekNHLEVBQUdILEVBQ0hJLEdBQUcsRUFDSEgsUUFBUyxJQVVWLE9BTkFJLEVBQVFMLEdBQVVNLEtBQUtKLEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNGLEdBRy9ERyxFQUFPRSxHQUFJLEVBR0pGLEVBQU9ELFFBS2ZGLEVBQW9CUSxFQUFJRixFQUd4Qk4sRUFBb0JTLEVBQUlWLEVBR3hCQyxFQUFvQlUsRUFBSSxTQUFTUixFQUFTUyxFQUFNQyxHQUMzQ1osRUFBb0JhLEVBQUVYLEVBQVNTLElBQ2xDRyxPQUFPQyxlQUFlYixFQUFTUyxFQUFNLENB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RTlCNUQsSUFBSzRELEdBQVN2WCxLQUFLbWIsS0FBS25FLE1BQU1GLFVBQVVTLEVBQUtyWSxJQUFJNlYsSUFBS3dDLEVBQUtyWSxJQUFJOFYsTUFabEMsS0FyRzNCLEdBQUE5SixPQUFTc0gsRUFBRzs7Ozs7Ozs7Ozs7Ozs7Z0JQekJEOztJTzRDUSxJQUF6Qm5VLEVBQVMsQ0FBQzJELEtBQU0xQyxVLDZCQUNTLElBQXpCakIsRUFBUyxDQUFDMkQsS0FBTTVFLFUsNEJBR1MsSUFBekJpQixFQUFTLENBQUMyRCxLQUFNNUUsVSxxQ0FDUyxJQUF6QmlCLEVBQVMsQ0FBQzJELEtBQU01RSxVLHNDQU1qQixJQURDaUIsRUFBUyxDQUFDMkQsS0FBTXlLLFUsNkJBOUJOLEdBQVMsSUFEckJ1RSxFQUFjLGVBQ0YiLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IChjKSAyMDE3IFRoZSBQb2x5bWVyIFByb2plY3QgQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqIFRoaXMgY29kZSBtYXkgb25seSBiZSB1c2VkIHVuZGVyIHRoZSBCU0Qgc3R5bGUgbGljZW5zZSBmb3VuZCBhdFxuICogaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0xJQ0VOU0UudHh0XG4gKiBUaGUgY29tcGxldGUgc2V0IG9mIGF1dGhvcnMgbWF5IGJlIGZvdW5kIGF0XG4gKiBodHRwOi8vcG9seW1lci5naXRodWIuaW8vQVVUSE9SUy50eHRcbiAqIFRoZSBjb21wbGV0ZSBzZXQgb2YgY29udHJpYnV0b3JzIG1heSBiZSBmb3VuZCBhdFxuICogaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0NPTlRSSUJVVE9SUy50eHRcbiAqIENvZGUgZGlzdHJpYnV0ZWQgYnkgR29vZ2xlIGFzIHBhcnQgb2YgdGhlIHBvbHltZXIgcHJvamVjdCBpcyBhbHNvXG4gKiBzdWJqZWN0IHRvIGFuIGFkZGl0aW9uYWwgSVAgcmlnaHRzIGdyYW50IGZvdW5kIGF0XG4gKiBodHRwOi8vcG9seW1lci5naXRodWIuaW8vUEFURU5UUy50eHRcbiAqL1xuLyoqXG4gKiBUcnVlIGlmIHRoZSBjdXN0b20gZWxlbWVudHMgcG9seWZpbGwgaXMgaW4gdXNlLlxuICovXG5leHBvcnQgY29uc3QgaXNDRVBvbHlmaWxsID0gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiZcbiAgICB3aW5kb3cuY3VzdG9tRWxlbWVudHMgIT0gbnVsbCAmJlxuICAgIHdpbmRvdy5jdXN0b21FbGVtZW50cy5wb2x5ZmlsbFdyYXBGbHVzaENhbGxiYWNrICE9PVxuICAgICAgICB1bmRlZmluZWQ7XG4vKipcbiAqIFJlcGFyZW50cyBub2Rlcywgc3RhcnRpbmcgZnJvbSBgc3RhcnRgIChpbmNsdXNpdmUpIHRvIGBlbmRgIChleGNsdXNpdmUpLFxuICogaW50byBhbm90aGVyIGNvbnRhaW5lciAoY291bGQgYmUgdGhlIHNhbWUgY29udGFpbmVyKSwgYmVmb3JlIGBiZWZvcmVgLiBJZlxuICogYGJlZm9yZWAgaXMgbnVsbCwgaXQgYXBwZW5kcyB0aGUgbm9kZXMgdG8gdGhlIGNvbnRhaW5lci5cbiAqL1xuZXhwb3J0IGNvbnN0IHJlcGFyZW50Tm9kZXMgPSAoY29udGFpbmVyLCBzdGFydCwgZW5kID0gbnVsbCwgYmVmb3JlID0gbnVsbCkgPT4ge1xuICAgIHdoaWxlIChzdGFydCAhPT0gZW5kKSB7XG4gICAgICAgIGNvbnN0IG4gPSBzdGFydC5uZXh0U2libGluZztcbiAgICAgICAgY29udGFpbmVyLmluc2VydEJlZm9yZShzdGFydCwgYmVmb3JlKTtcbiAgICAgICAgc3RhcnQgPSBuO1xuICAgIH1cbn07XG4vKipcbiAqIFJlbW92ZXMgbm9kZXMsIHN0YXJ0aW5nIGZyb20gYHN0YXJ0YCAoaW5jbHVzaXZlKSB0byBgZW5kYCAoZXhjbHVzaXZlKSwgZnJvbVxuICogYGNvbnRhaW5lcmAuXG4gKi9cbmV4cG9ydCBjb25zdCByZW1vdmVOb2RlcyA9IChjb250YWluZXIsIHN0YXJ0LCBlbmQgPSBudWxsKSA9PiB7XG4gICAgd2hpbGUgKHN0YXJ0ICE9PSBlbmQpIHtcbiAgICAgICAgY29uc3QgbiA9IHN0YXJ0Lm5leHRTaWJsaW5nO1xuICAgICAgICBjb250YWluZXIucmVtb3ZlQ2hpbGQoc3RhcnQpO1xuICAgICAgICBzdGFydCA9IG47XG4gICAgfVxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRvbS5qcy5tYXAiLCIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTcgVGhlIFBvbHltZXIgUHJvamVjdCBBdXRob3JzLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogVGhpcyBjb2RlIG1heSBvbmx5IGJlIHVzZWQgdW5kZXIgdGhlIEJTRCBzdHlsZSBsaWNlbnNlIGZvdW5kIGF0XG4gKiBodHRwOi8vcG9seW1lci5naXRodWIuaW8vTElDRU5TRS50eHRcbiAqIFRoZSBjb21wbGV0ZSBzZXQgb2YgYXV0aG9ycyBtYXkgYmUgZm91bmQgYXRcbiAqIGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9BVVRIT1JTLnR4dFxuICogVGhlIGNvbXBsZXRlIHNldCBvZiBjb250cmlidXRvcnMgbWF5IGJlIGZvdW5kIGF0XG4gKiBodHRwOi8vcG9seW1lci5naXRodWIuaW8vQ09OVFJJQlVUT1JTLnR4dFxuICogQ29kZSBkaXN0cmlidXRlZCBieSBHb29nbGUgYXMgcGFydCBvZiB0aGUgcG9seW1lciBwcm9qZWN0IGlzIGFsc29cbiAqIHN1YmplY3QgdG8gYW4gYWRkaXRpb25hbCBJUCByaWdodHMgZ3JhbnQgZm91bmQgYXRcbiAqIGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9QQVRFTlRTLnR4dFxuICovXG4vKipcbiAqIEFuIGV4cHJlc3Npb24gbWFya2VyIHdpdGggZW1iZWRkZWQgdW5pcXVlIGtleSB0byBhdm9pZCBjb2xsaXNpb24gd2l0aFxuICogcG9zc2libGUgdGV4dCBpbiB0ZW1wbGF0ZXMuXG4gKi9cbmV4cG9ydCBjb25zdCBtYXJrZXIgPSBge3tsaXQtJHtTdHJpbmcoTWF0aC5yYW5kb20oKSkuc2xpY2UoMil9fX1gO1xuLyoqXG4gKiBBbiBleHByZXNzaW9uIG1hcmtlciB1c2VkIHRleHQtcG9zaXRpb25zLCBtdWx0aS1iaW5kaW5nIGF0dHJpYnV0ZXMsIGFuZFxuICogYXR0cmlidXRlcyB3aXRoIG1hcmt1cC1saWtlIHRleHQgdmFsdWVzLlxuICovXG5leHBvcnQgY29uc3Qgbm9kZU1hcmtlciA9IGA8IS0tJHttYXJrZXJ9LS0+YDtcbmV4cG9ydCBjb25zdCBtYXJrZXJSZWdleCA9IG5ldyBSZWdFeHAoYCR7bWFya2VyfXwke25vZGVNYXJrZXJ9YCk7XG4vKipcbiAqIFN1ZmZpeCBhcHBlbmRlZCB0byBhbGwgYm91bmQgYXR0cmlidXRlIG5hbWVzLlxuICovXG5leHBvcnQgY29uc3QgYm91bmRBdHRyaWJ1dGVTdWZmaXggPSAnJGxpdCQnO1xuLyoqXG4gKiBBbiB1cGRhdGFibGUgVGVtcGxhdGUgdGhhdCB0cmFja3MgdGhlIGxvY2F0aW9uIG9mIGR5bmFtaWMgcGFydHMuXG4gKi9cbmV4cG9ydCBjbGFzcyBUZW1wbGF0ZSB7XG4gICAgY29uc3RydWN0b3IocmVzdWx0LCBlbGVtZW50KSB7XG4gICAgICAgIHRoaXMucGFydHMgPSBbXTtcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICAgICAgY29uc3Qgbm9kZXNUb1JlbW92ZSA9IFtdO1xuICAgICAgICBjb25zdCBzdGFjayA9IFtdO1xuICAgICAgICAvLyBFZGdlIG5lZWRzIGFsbCA0IHBhcmFtZXRlcnMgcHJlc2VudDsgSUUxMSBuZWVkcyAzcmQgcGFyYW1ldGVyIHRvIGJlIG51bGxcbiAgICAgICAgY29uc3Qgd2Fsa2VyID0gZG9jdW1lbnQuY3JlYXRlVHJlZVdhbGtlcihlbGVtZW50LmNvbnRlbnQsIDEzMyAvKiBOb2RlRmlsdGVyLlNIT1dfe0VMRU1FTlR8Q09NTUVOVHxURVhUfSAqLywgbnVsbCwgZmFsc2UpO1xuICAgICAgICAvLyBLZWVwcyB0cmFjayBvZiB0aGUgbGFzdCBpbmRleCBhc3NvY2lhdGVkIHdpdGggYSBwYXJ0LiBXZSB0cnkgdG8gZGVsZXRlXG4gICAgICAgIC8vIHVubmVjZXNzYXJ5IG5vZGVzLCBidXQgd2UgbmV2ZXIgd2FudCB0byBhc3NvY2lhdGUgdHdvIGRpZmZlcmVudCBwYXJ0c1xuICAgICAgICAvLyB0byB0aGUgc2FtZSBpbmRleC4gVGhleSBtdXN0IGhhdmUgYSBjb25zdGFudCBub2RlIGJldHdlZW4uXG4gICAgICAgIGxldCBsYXN0UGFydEluZGV4ID0gMDtcbiAgICAgICAgbGV0IGluZGV4ID0gLTE7XG4gICAgICAgIGxldCBwYXJ0SW5kZXggPSAwO1xuICAgICAgICBjb25zdCB7IHN0cmluZ3MsIHZhbHVlczogeyBsZW5ndGggfSB9ID0gcmVzdWx0O1xuICAgICAgICB3aGlsZSAocGFydEluZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgICAgICBjb25zdCBub2RlID0gd2Fsa2VyLm5leHROb2RlKCk7XG4gICAgICAgICAgICBpZiAobm9kZSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIC8vIFdlJ3ZlIGV4aGF1c3RlZCB0aGUgY29udGVudCBpbnNpZGUgYSBuZXN0ZWQgdGVtcGxhdGUgZWxlbWVudC5cbiAgICAgICAgICAgICAgICAvLyBCZWNhdXNlIHdlIHN0aWxsIGhhdmUgcGFydHMgKHRoZSBvdXRlciBmb3ItbG9vcCksIHdlIGtub3c6XG4gICAgICAgICAgICAgICAgLy8gLSBUaGVyZSBpcyBhIHRlbXBsYXRlIGluIHRoZSBzdGFja1xuICAgICAgICAgICAgICAgIC8vIC0gVGhlIHdhbGtlciB3aWxsIGZpbmQgYSBuZXh0Tm9kZSBvdXRzaWRlIHRoZSB0ZW1wbGF0ZVxuICAgICAgICAgICAgICAgIHdhbGtlci5jdXJyZW50Tm9kZSA9IHN0YWNrLnBvcCgpO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgICAgIGlmIChub2RlLm5vZGVUeXBlID09PSAxIC8qIE5vZGUuRUxFTUVOVF9OT0RFICovKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5vZGUuaGFzQXR0cmlidXRlcygpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSBub2RlLmF0dHJpYnV0ZXM7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHsgbGVuZ3RoIH0gPSBhdHRyaWJ1dGVzO1xuICAgICAgICAgICAgICAgICAgICAvLyBQZXJcbiAgICAgICAgICAgICAgICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL05hbWVkTm9kZU1hcCxcbiAgICAgICAgICAgICAgICAgICAgLy8gYXR0cmlidXRlcyBhcmUgbm90IGd1YXJhbnRlZWQgdG8gYmUgcmV0dXJuZWQgaW4gZG9jdW1lbnQgb3JkZXIuXG4gICAgICAgICAgICAgICAgICAgIC8vIEluIHBhcnRpY3VsYXIsIEVkZ2UvSUUgY2FuIHJldHVybiB0aGVtIG91dCBvZiBvcmRlciwgc28gd2UgY2Fubm90XG4gICAgICAgICAgICAgICAgICAgIC8vIGFzc3VtZSBhIGNvcnJlc3BvbmRlbmNlIGJldHdlZW4gcGFydCBpbmRleCBhbmQgYXR0cmlidXRlIGluZGV4LlxuICAgICAgICAgICAgICAgICAgICBsZXQgY291bnQgPSAwO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZW5kc1dpdGgoYXR0cmlidXRlc1tpXS5uYW1lLCBib3VuZEF0dHJpYnV0ZVN1ZmZpeCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudCsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHdoaWxlIChjb3VudC0tID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gR2V0IHRoZSB0ZW1wbGF0ZSBsaXRlcmFsIHNlY3Rpb24gbGVhZGluZyB1cCB0byB0aGUgZmlyc3RcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGV4cHJlc3Npb24gaW4gdGhpcyBhdHRyaWJ1dGVcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cmluZ0ZvclBhcnQgPSBzdHJpbmdzW3BhcnRJbmRleF07XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIHRoZSBhdHRyaWJ1dGUgbmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmFtZSA9IGxhc3RBdHRyaWJ1dGVOYW1lUmVnZXguZXhlYyhzdHJpbmdGb3JQYXJ0KVsyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgdGhlIGNvcnJlc3BvbmRpbmcgYXR0cmlidXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBbGwgYm91bmQgYXR0cmlidXRlcyBoYXZlIGhhZCBhIHN1ZmZpeCBhZGRlZCBpblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGVtcGxhdGVSZXN1bHQjZ2V0SFRNTCB0byBvcHQgb3V0IG9mIHNwZWNpYWwgYXR0cmlidXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBoYW5kbGluZy4gVG8gbG9vayB1cCB0aGUgYXR0cmlidXRlIHZhbHVlIHdlIGFsc28gbmVlZCB0byBhZGRcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBzdWZmaXguXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhdHRyaWJ1dGVMb29rdXBOYW1lID0gbmFtZS50b0xvd2VyQ2FzZSgpICsgYm91bmRBdHRyaWJ1dGVTdWZmaXg7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhdHRyaWJ1dGVWYWx1ZSA9IG5vZGUuZ2V0QXR0cmlidXRlKGF0dHJpYnV0ZUxvb2t1cE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5yZW1vdmVBdHRyaWJ1dGUoYXR0cmlidXRlTG9va3VwTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGF0aWNzID0gYXR0cmlidXRlVmFsdWUuc3BsaXQobWFya2VyUmVnZXgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJ0cy5wdXNoKHsgdHlwZTogJ2F0dHJpYnV0ZScsIGluZGV4LCBuYW1lLCBzdHJpbmdzOiBzdGF0aWNzIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFydEluZGV4ICs9IHN0YXRpY3MubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobm9kZS50YWdOYW1lID09PSAnVEVNUExBVEUnKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YWNrLnB1c2gobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIHdhbGtlci5jdXJyZW50Tm9kZSA9IG5vZGUuY29udGVudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChub2RlLm5vZGVUeXBlID09PSAzIC8qIE5vZGUuVEVYVF9OT0RFICovKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IG5vZGUuZGF0YTtcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5pbmRleE9mKG1hcmtlcikgPj0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnQgPSBub2RlLnBhcmVudE5vZGU7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cmluZ3MgPSBkYXRhLnNwbGl0KG1hcmtlclJlZ2V4KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGFzdEluZGV4ID0gc3RyaW5ncy5sZW5ndGggLSAxO1xuICAgICAgICAgICAgICAgICAgICAvLyBHZW5lcmF0ZSBhIG5ldyB0ZXh0IG5vZGUgZm9yIGVhY2ggbGl0ZXJhbCBzZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgIC8vIFRoZXNlIG5vZGVzIGFyZSBhbHNvIHVzZWQgYXMgdGhlIG1hcmtlcnMgZm9yIG5vZGUgcGFydHNcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsYXN0SW5kZXg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGluc2VydDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzID0gc3RyaW5nc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzID09PSAnJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc2VydCA9IGNyZWF0ZU1hcmtlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSBsYXN0QXR0cmlidXRlTmFtZVJlZ2V4LmV4ZWMocyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1hdGNoICE9PSBudWxsICYmIGVuZHNXaXRoKG1hdGNoWzJdLCBib3VuZEF0dHJpYnV0ZVN1ZmZpeCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcyA9IHMuc2xpY2UoMCwgbWF0Y2guaW5kZXgpICsgbWF0Y2hbMV0gK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hbMl0uc2xpY2UoMCwgLWJvdW5kQXR0cmlidXRlU3VmZml4Lmxlbmd0aCkgKyBtYXRjaFszXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zZXJ0ID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUocyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQuaW5zZXJ0QmVmb3JlKGluc2VydCwgbm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcnRzLnB1c2goeyB0eXBlOiAnbm9kZScsIGluZGV4OiArK2luZGV4IH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZXJlJ3Mgbm8gdGV4dCwgd2UgbXVzdCBpbnNlcnQgYSBjb21tZW50IHRvIG1hcmsgb3VyIHBsYWNlLlxuICAgICAgICAgICAgICAgICAgICAvLyBFbHNlLCB3ZSBjYW4gdHJ1c3QgaXQgd2lsbCBzdGljayBhcm91bmQgYWZ0ZXIgY2xvbmluZy5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0cmluZ3NbbGFzdEluZGV4XSA9PT0gJycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC5pbnNlcnRCZWZvcmUoY3JlYXRlTWFya2VyKCksIG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNUb1JlbW92ZS5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5kYXRhID0gc3RyaW5nc1tsYXN0SW5kZXhdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIFdlIGhhdmUgYSBwYXJ0IGZvciBlYWNoIG1hdGNoIGZvdW5kXG4gICAgICAgICAgICAgICAgICAgIHBhcnRJbmRleCArPSBsYXN0SW5kZXg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobm9kZS5ub2RlVHlwZSA9PT0gOCAvKiBOb2RlLkNPTU1FTlRfTk9ERSAqLykge1xuICAgICAgICAgICAgICAgIGlmIChub2RlLmRhdGEgPT09IG1hcmtlcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnQgPSBub2RlLnBhcmVudE5vZGU7XG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCBhIG5ldyBtYXJrZXIgbm9kZSB0byBiZSB0aGUgc3RhcnROb2RlIG9mIHRoZSBQYXJ0IGlmIGFueSBvZlxuICAgICAgICAgICAgICAgICAgICAvLyB0aGUgZm9sbG93aW5nIGFyZSB0cnVlOlxuICAgICAgICAgICAgICAgICAgICAvLyAgKiBXZSBkb24ndCBoYXZlIGEgcHJldmlvdXNTaWJsaW5nXG4gICAgICAgICAgICAgICAgICAgIC8vICAqIFRoZSBwcmV2aW91c1NpYmxpbmcgaXMgYWxyZWFkeSB0aGUgc3RhcnQgb2YgYSBwcmV2aW91cyBwYXJ0XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLnByZXZpb3VzU2libGluZyA9PT0gbnVsbCB8fCBpbmRleCA9PT0gbGFzdFBhcnRJbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC5pbnNlcnRCZWZvcmUoY3JlYXRlTWFya2VyKCksIG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGxhc3RQYXJ0SW5kZXggPSBpbmRleDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJ0cy5wdXNoKHsgdHlwZTogJ25vZGUnLCBpbmRleCB9KTtcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgd2UgZG9uJ3QgaGF2ZSBhIG5leHRTaWJsaW5nLCBrZWVwIHRoaXMgbm9kZSBzbyB3ZSBoYXZlIGFuIGVuZC5cbiAgICAgICAgICAgICAgICAgICAgLy8gRWxzZSwgd2UgY2FuIHJlbW92ZSBpdCB0byBzYXZlIGZ1dHVyZSBjb3N0cy5cbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUubmV4dFNpYmxpbmcgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuZGF0YSA9ICcnO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNUb1JlbW92ZS5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXgtLTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBwYXJ0SW5kZXgrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBpID0gLTE7XG4gICAgICAgICAgICAgICAgICAgIHdoaWxlICgoaSA9IG5vZGUuZGF0YS5pbmRleE9mKG1hcmtlciwgaSArIDEpKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvbW1lbnQgbm9kZSBoYXMgYSBiaW5kaW5nIG1hcmtlciBpbnNpZGUsIG1ha2UgYW4gaW5hY3RpdmUgcGFydFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGJpbmRpbmcgd29uJ3Qgd29yaywgYnV0IHN1YnNlcXVlbnQgYmluZGluZ3Mgd2lsbFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVE9ETyAoanVzdGluZmFnbmFuaSk6IGNvbnNpZGVyIHdoZXRoZXIgaXQncyBldmVuIHdvcnRoIGl0IHRvXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBtYWtlIGJpbmRpbmdzIGluIGNvbW1lbnRzIHdvcmtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFydHMucHVzaCh7IHR5cGU6ICdub2RlJywgaW5kZXg6IC0xIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFydEluZGV4Kys7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gUmVtb3ZlIHRleHQgYmluZGluZyBub2RlcyBhZnRlciB0aGUgd2FsayB0byBub3QgZGlzdHVyYiB0aGUgVHJlZVdhbGtlclxuICAgICAgICBmb3IgKGNvbnN0IG4gb2Ygbm9kZXNUb1JlbW92ZSkge1xuICAgICAgICAgICAgbi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG4pO1xuICAgICAgICB9XG4gICAgfVxufVxuY29uc3QgZW5kc1dpdGggPSAoc3RyLCBzdWZmaXgpID0+IHtcbiAgICBjb25zdCBpbmRleCA9IHN0ci5sZW5ndGggLSBzdWZmaXgubGVuZ3RoO1xuICAgIHJldHVybiBpbmRleCA+PSAwICYmIHN0ci5zbGljZShpbmRleCkgPT09IHN1ZmZpeDtcbn07XG5leHBvcnQgY29uc3QgaXNUZW1wbGF0ZVBhcnRBY3RpdmUgPSAocGFydCkgPT4gcGFydC5pbmRleCAhPT0gLTE7XG4vLyBBbGxvd3MgYGRvY3VtZW50LmNyZWF0ZUNvbW1lbnQoJycpYCB0byBiZSByZW5hbWVkIGZvciBhXG4vLyBzbWFsbCBtYW51YWwgc2l6ZS1zYXZpbmdzLlxuZXhwb3J0IGNvbnN0IGNyZWF0ZU1hcmtlciA9ICgpID0+IGRvY3VtZW50LmNyZWF0ZUNvbW1lbnQoJycpO1xuLyoqXG4gKiBUaGlzIHJlZ2V4IGV4dHJhY3RzIHRoZSBhdHRyaWJ1dGUgbmFtZSBwcmVjZWRpbmcgYW4gYXR0cmlidXRlLXBvc2l0aW9uXG4gKiBleHByZXNzaW9uLiBJdCBkb2VzIHRoaXMgYnkgbWF0Y2hpbmcgdGhlIHN5bnRheCBhbGxvd2VkIGZvciBhdHRyaWJ1dGVzXG4gKiBhZ2FpbnN0IHRoZSBzdHJpbmcgbGl0ZXJhbCBkaXJlY3RseSBwcmVjZWRpbmcgdGhlIGV4cHJlc3Npb24sIGFzc3VtaW5nIHRoYXRcbiAqIHRoZSBleHByZXNzaW9uIGlzIGluIGFuIGF0dHJpYnV0ZS12YWx1ZSBwb3NpdGlvbi5cbiAqXG4gKiBTZWUgYXR0cmlidXRlcyBpbiB0aGUgSFRNTCBzcGVjOlxuICogaHR0cHM6Ly93d3cudzMub3JnL1RSL2h0bWw1L3N5bnRheC5odG1sI2VsZW1lbnRzLWF0dHJpYnV0ZXNcbiAqXG4gKiBcIiBcXHgwOVxceDBhXFx4MGNcXHgwZFwiIGFyZSBIVE1MIHNwYWNlIGNoYXJhY3RlcnM6XG4gKiBodHRwczovL3d3dy53My5vcmcvVFIvaHRtbDUvaW5mcmFzdHJ1Y3R1cmUuaHRtbCNzcGFjZS1jaGFyYWN0ZXJzXG4gKlxuICogXCJcXDAtXFx4MUZcXHg3Ri1cXHg5RlwiIGFyZSBVbmljb2RlIGNvbnRyb2wgY2hhcmFjdGVycywgd2hpY2ggaW5jbHVkZXMgZXZlcnlcbiAqIHNwYWNlIGNoYXJhY3RlciBleGNlcHQgXCIgXCIuXG4gKlxuICogU28gYW4gYXR0cmlidXRlIGlzOlxuICogICogVGhlIG5hbWU6IGFueSBjaGFyYWN0ZXIgZXhjZXB0IGEgY29udHJvbCBjaGFyYWN0ZXIsIHNwYWNlIGNoYXJhY3RlciwgKCcpLFxuICogICAgKFwiKSwgXCI+XCIsIFwiPVwiLCBvciBcIi9cIlxuICogICogRm9sbG93ZWQgYnkgemVybyBvciBtb3JlIHNwYWNlIGNoYXJhY3RlcnNcbiAqICAqIEZvbGxvd2VkIGJ5IFwiPVwiXG4gKiAgKiBGb2xsb3dlZCBieSB6ZXJvIG9yIG1vcmUgc3BhY2UgY2hhcmFjdGVyc1xuICogICogRm9sbG93ZWQgYnk6XG4gKiAgICAqIEFueSBjaGFyYWN0ZXIgZXhjZXB0IHNwYWNlLCAoJyksIChcIiksIFwiPFwiLCBcIj5cIiwgXCI9XCIsIChgKSwgb3JcbiAqICAgICogKFwiKSB0aGVuIGFueSBub24tKFwiKSwgb3JcbiAqICAgICogKCcpIHRoZW4gYW55IG5vbi0oJylcbiAqL1xuZXhwb3J0IGNvbnN0IGxhc3RBdHRyaWJ1dGVOYW1lUmVnZXggPSBcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb250cm9sLXJlZ2V4XG4vKFsgXFx4MDlcXHgwYVxceDBjXFx4MGRdKShbXlxcMC1cXHgxRlxceDdGLVxceDlGIFwiJz49L10rKShbIFxceDA5XFx4MGFcXHgwY1xceDBkXSo9WyBcXHgwOVxceDBhXFx4MGNcXHgwZF0qKD86W14gXFx4MDlcXHgwYVxceDBjXFx4MGRcIidgPD49XSp8XCJbXlwiXSp8J1teJ10qKSkkLztcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRlbXBsYXRlLmpzLm1hcCIsIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAoYykgMjAxNyBUaGUgUG9seW1lciBQcm9qZWN0IEF1dGhvcnMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiBUaGlzIGNvZGUgbWF5IG9ubHkgYmUgdXNlZCB1bmRlciB0aGUgQlNEIHN0eWxlIGxpY2Vuc2UgZm91bmQgYXRcbiAqIGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9MSUNFTlNFLnR4dFxuICogVGhlIGNvbXBsZXRlIHNldCBvZiBhdXRob3JzIG1heSBiZSBmb3VuZCBhdFxuICogaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0FVVEhPUlMudHh0XG4gKiBUaGUgY29tcGxldGUgc2V0IG9mIGNvbnRyaWJ1dG9ycyBtYXkgYmUgZm91bmQgYXRcbiAqIGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9DT05UUklCVVRPUlMudHh0XG4gKiBDb2RlIGRpc3RyaWJ1dGVkIGJ5IEdvb2dsZSBhcyBwYXJ0IG9mIHRoZSBwb2x5bWVyIHByb2plY3QgaXMgYWxzb1xuICogc3ViamVjdCB0byBhbiBhZGRpdGlvbmFsIElQIHJpZ2h0cyBncmFudCBmb3VuZCBhdFxuICogaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL1BBVEVOVFMudHh0XG4gKi9cbi8qKlxuICogQG1vZHVsZSBzaGFkeS1yZW5kZXJcbiAqL1xuaW1wb3J0IHsgaXNUZW1wbGF0ZVBhcnRBY3RpdmUgfSBmcm9tICcuL3RlbXBsYXRlLmpzJztcbmNvbnN0IHdhbGtlck5vZGVGaWx0ZXIgPSAxMzMgLyogTm9kZUZpbHRlci5TSE9XX3tFTEVNRU5UfENPTU1FTlR8VEVYVH0gKi87XG4vKipcbiAqIFJlbW92ZXMgdGhlIGxpc3Qgb2Ygbm9kZXMgZnJvbSBhIFRlbXBsYXRlIHNhZmVseS4gSW4gYWRkaXRpb24gdG8gcmVtb3ZpbmdcbiAqIG5vZGVzIGZyb20gdGhlIFRlbXBsYXRlLCB0aGUgVGVtcGxhdGUgcGFydCBpbmRpY2VzIGFyZSB1cGRhdGVkIHRvIG1hdGNoXG4gKiB0aGUgbXV0YXRlZCBUZW1wbGF0ZSBET00uXG4gKlxuICogQXMgdGhlIHRlbXBsYXRlIGlzIHdhbGtlZCB0aGUgcmVtb3ZhbCBzdGF0ZSBpcyB0cmFja2VkIGFuZFxuICogcGFydCBpbmRpY2VzIGFyZSBhZGp1c3RlZCBhcyBuZWVkZWQuXG4gKlxuICogZGl2XG4gKiAgIGRpdiMxIChyZW1vdmUpIDwtLSBzdGFydCByZW1vdmluZyAocmVtb3Zpbmcgbm9kZSBpcyBkaXYjMSlcbiAqICAgICBkaXZcbiAqICAgICAgIGRpdiMyIChyZW1vdmUpICA8LS0gY29udGludWUgcmVtb3ZpbmcgKHJlbW92aW5nIG5vZGUgaXMgc3RpbGwgZGl2IzEpXG4gKiAgICAgICAgIGRpdlxuICogZGl2IDwtLSBzdG9wIHJlbW92aW5nIHNpbmNlIHByZXZpb3VzIHNpYmxpbmcgaXMgdGhlIHJlbW92aW5nIG5vZGUgKGRpdiMxLFxuICogcmVtb3ZlZCA0IG5vZGVzKVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlTm9kZXNGcm9tVGVtcGxhdGUodGVtcGxhdGUsIG5vZGVzVG9SZW1vdmUpIHtcbiAgICBjb25zdCB7IGVsZW1lbnQ6IHsgY29udGVudCB9LCBwYXJ0cyB9ID0gdGVtcGxhdGU7XG4gICAgY29uc3Qgd2Fsa2VyID0gZG9jdW1lbnQuY3JlYXRlVHJlZVdhbGtlcihjb250ZW50LCB3YWxrZXJOb2RlRmlsdGVyLCBudWxsLCBmYWxzZSk7XG4gICAgbGV0IHBhcnRJbmRleCA9IG5leHRBY3RpdmVJbmRleEluVGVtcGxhdGVQYXJ0cyhwYXJ0cyk7XG4gICAgbGV0IHBhcnQgPSBwYXJ0c1twYXJ0SW5kZXhdO1xuICAgIGxldCBub2RlSW5kZXggPSAtMTtcbiAgICBsZXQgcmVtb3ZlQ291bnQgPSAwO1xuICAgIGNvbnN0IG5vZGVzVG9SZW1vdmVJblRlbXBsYXRlID0gW107XG4gICAgbGV0IGN1cnJlbnRSZW1vdmluZ05vZGUgPSBudWxsO1xuICAgIHdoaWxlICh3YWxrZXIubmV4dE5vZGUoKSkge1xuICAgICAgICBub2RlSW5kZXgrKztcbiAgICAgICAgY29uc3Qgbm9kZSA9IHdhbGtlci5jdXJyZW50Tm9kZTtcbiAgICAgICAgLy8gRW5kIHJlbW92YWwgaWYgc3RlcHBlZCBwYXN0IHRoZSByZW1vdmluZyBub2RlXG4gICAgICAgIGlmIChub2RlLnByZXZpb3VzU2libGluZyA9PT0gY3VycmVudFJlbW92aW5nTm9kZSkge1xuICAgICAgICAgICAgY3VycmVudFJlbW92aW5nTm9kZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQSBub2RlIHRvIHJlbW92ZSB3YXMgZm91bmQgaW4gdGhlIHRlbXBsYXRlXG4gICAgICAgIGlmIChub2Rlc1RvUmVtb3ZlLmhhcyhub2RlKSkge1xuICAgICAgICAgICAgbm9kZXNUb1JlbW92ZUluVGVtcGxhdGUucHVzaChub2RlKTtcbiAgICAgICAgICAgIC8vIFRyYWNrIG5vZGUgd2UncmUgcmVtb3ZpbmdcbiAgICAgICAgICAgIGlmIChjdXJyZW50UmVtb3ZpbmdOb2RlID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFJlbW92aW5nTm9kZSA9IG5vZGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gV2hlbiByZW1vdmluZywgaW5jcmVtZW50IGNvdW50IGJ5IHdoaWNoIHRvIGFkanVzdCBzdWJzZXF1ZW50IHBhcnQgaW5kaWNlc1xuICAgICAgICBpZiAoY3VycmVudFJlbW92aW5nTm9kZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgcmVtb3ZlQ291bnQrKztcbiAgICAgICAgfVxuICAgICAgICB3aGlsZSAocGFydCAhPT0gdW5kZWZpbmVkICYmIHBhcnQuaW5kZXggPT09IG5vZGVJbmRleCkge1xuICAgICAgICAgICAgLy8gSWYgcGFydCBpcyBpbiBhIHJlbW92ZWQgbm9kZSBkZWFjdGl2YXRlIGl0IGJ5IHNldHRpbmcgaW5kZXggdG8gLTEgb3JcbiAgICAgICAgICAgIC8vIGFkanVzdCB0aGUgaW5kZXggYXMgbmVlZGVkLlxuICAgICAgICAgICAgcGFydC5pbmRleCA9IGN1cnJlbnRSZW1vdmluZ05vZGUgIT09IG51bGwgPyAtMSA6IHBhcnQuaW5kZXggLSByZW1vdmVDb3VudDtcbiAgICAgICAgICAgIC8vIGdvIHRvIHRoZSBuZXh0IGFjdGl2ZSBwYXJ0LlxuICAgICAgICAgICAgcGFydEluZGV4ID0gbmV4dEFjdGl2ZUluZGV4SW5UZW1wbGF0ZVBhcnRzKHBhcnRzLCBwYXJ0SW5kZXgpO1xuICAgICAgICAgICAgcGFydCA9IHBhcnRzW3BhcnRJbmRleF07XG4gICAgICAgIH1cbiAgICB9XG4gICAgbm9kZXNUb1JlbW92ZUluVGVtcGxhdGUuZm9yRWFjaCgobikgPT4gbi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG4pKTtcbn1cbmNvbnN0IGNvdW50Tm9kZXMgPSAobm9kZSkgPT4ge1xuICAgIGxldCBjb3VudCA9IChub2RlLm5vZGVUeXBlID09PSAxMSAvKiBOb2RlLkRPQ1VNRU5UX0ZSQUdNRU5UX05PREUgKi8pID8gMCA6IDE7XG4gICAgY29uc3Qgd2Fsa2VyID0gZG9jdW1lbnQuY3JlYXRlVHJlZVdhbGtlcihub2RlLCB3YWxrZXJOb2RlRmlsdGVyLCBudWxsLCBmYWxzZSk7XG4gICAgd2hpbGUgKHdhbGtlci5uZXh0Tm9kZSgpKSB7XG4gICAgICAgIGNvdW50Kys7XG4gICAgfVxuICAgIHJldHVybiBjb3VudDtcbn07XG5jb25zdCBuZXh0QWN0aXZlSW5kZXhJblRlbXBsYXRlUGFydHMgPSAocGFydHMsIHN0YXJ0SW5kZXggPSAtMSkgPT4ge1xuICAgIGZvciAobGV0IGkgPSBzdGFydEluZGV4ICsgMTsgaSA8IHBhcnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHBhcnQgPSBwYXJ0c1tpXTtcbiAgICAgICAgaWYgKGlzVGVtcGxhdGVQYXJ0QWN0aXZlKHBhcnQpKSB7XG4gICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gLTE7XG59O1xuLyoqXG4gKiBJbnNlcnRzIHRoZSBnaXZlbiBub2RlIGludG8gdGhlIFRlbXBsYXRlLCBvcHRpb25hbGx5IGJlZm9yZSB0aGUgZ2l2ZW5cbiAqIHJlZk5vZGUuIEluIGFkZGl0aW9uIHRvIGluc2VydGluZyB0aGUgbm9kZSBpbnRvIHRoZSBUZW1wbGF0ZSwgdGhlIFRlbXBsYXRlXG4gKiBwYXJ0IGluZGljZXMgYXJlIHVwZGF0ZWQgdG8gbWF0Y2ggdGhlIG11dGF0ZWQgVGVtcGxhdGUgRE9NLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zZXJ0Tm9kZUludG9UZW1wbGF0ZSh0ZW1wbGF0ZSwgbm9kZSwgcmVmTm9kZSA9IG51bGwpIHtcbiAgICBjb25zdCB7IGVsZW1lbnQ6IHsgY29udGVudCB9LCBwYXJ0cyB9ID0gdGVtcGxhdGU7XG4gICAgLy8gSWYgdGhlcmUncyBubyByZWZOb2RlLCB0aGVuIHB1dCBub2RlIGF0IGVuZCBvZiB0ZW1wbGF0ZS5cbiAgICAvLyBObyBwYXJ0IGluZGljZXMgbmVlZCB0byBiZSBzaGlmdGVkIGluIHRoaXMgY2FzZS5cbiAgICBpZiAocmVmTm9kZSA9PT0gbnVsbCB8fCByZWZOb2RlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY29udGVudC5hcHBlbmRDaGlsZChub2RlKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCB3YWxrZXIgPSBkb2N1bWVudC5jcmVhdGVUcmVlV2Fsa2VyKGNvbnRlbnQsIHdhbGtlck5vZGVGaWx0ZXIsIG51bGwsIGZhbHNlKTtcbiAgICBsZXQgcGFydEluZGV4ID0gbmV4dEFjdGl2ZUluZGV4SW5UZW1wbGF0ZVBhcnRzKHBhcnRzKTtcbiAgICBsZXQgaW5zZXJ0Q291bnQgPSAwO1xuICAgIGxldCB3YWxrZXJJbmRleCA9IC0xO1xuICAgIHdoaWxlICh3YWxrZXIubmV4dE5vZGUoKSkge1xuICAgICAgICB3YWxrZXJJbmRleCsrO1xuICAgICAgICBjb25zdCB3YWxrZXJOb2RlID0gd2Fsa2VyLmN1cnJlbnROb2RlO1xuICAgICAgICBpZiAod2Fsa2VyTm9kZSA9PT0gcmVmTm9kZSkge1xuICAgICAgICAgICAgaW5zZXJ0Q291bnQgPSBjb3VudE5vZGVzKG5vZGUpO1xuICAgICAgICAgICAgcmVmTm9kZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShub2RlLCByZWZOb2RlKTtcbiAgICAgICAgfVxuICAgICAgICB3aGlsZSAocGFydEluZGV4ICE9PSAtMSAmJiBwYXJ0c1twYXJ0SW5kZXhdLmluZGV4ID09PSB3YWxrZXJJbmRleCkge1xuICAgICAgICAgICAgLy8gSWYgd2UndmUgaW5zZXJ0ZWQgdGhlIG5vZGUsIHNpbXBseSBhZGp1c3QgYWxsIHN1YnNlcXVlbnQgcGFydHNcbiAgICAgICAgICAgIGlmIChpbnNlcnRDb3VudCA+IDApIHtcbiAgICAgICAgICAgICAgICB3aGlsZSAocGFydEluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICBwYXJ0c1twYXJ0SW5kZXhdLmluZGV4ICs9IGluc2VydENvdW50O1xuICAgICAgICAgICAgICAgICAgICBwYXJ0SW5kZXggPSBuZXh0QWN0aXZlSW5kZXhJblRlbXBsYXRlUGFydHMocGFydHMsIHBhcnRJbmRleCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHBhcnRJbmRleCA9IG5leHRBY3RpdmVJbmRleEluVGVtcGxhdGVQYXJ0cyhwYXJ0cywgcGFydEluZGV4KTtcbiAgICAgICAgfVxuICAgIH1cbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZGlmeS10ZW1wbGF0ZS5qcy5tYXAiLCIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTcgVGhlIFBvbHltZXIgUHJvamVjdCBBdXRob3JzLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogVGhpcyBjb2RlIG1heSBvbmx5IGJlIHVzZWQgdW5kZXIgdGhlIEJTRCBzdHlsZSBsaWNlbnNlIGZvdW5kIGF0XG4gKiBodHRwOi8vcG9seW1lci5naXRodWIuaW8vTElDRU5TRS50eHRcbiAqIFRoZSBjb21wbGV0ZSBzZXQgb2YgYXV0aG9ycyBtYXkgYmUgZm91bmQgYXRcbiAqIGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9BVVRIT1JTLnR4dFxuICogVGhlIGNvbXBsZXRlIHNldCBvZiBjb250cmlidXRvcnMgbWF5IGJlIGZvdW5kIGF0XG4gKiBodHRwOi8vcG9seW1lci5naXRodWIuaW8vQ09OVFJJQlVUT1JTLnR4dFxuICogQ29kZSBkaXN0cmlidXRlZCBieSBHb29nbGUgYXMgcGFydCBvZiB0aGUgcG9seW1lciBwcm9qZWN0IGlzIGFsc29cbiAqIHN1YmplY3QgdG8gYW4gYWRkaXRpb25hbCBJUCByaWdodHMgZ3JhbnQgZm91bmQgYXRcbiAqIGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9QQVRFTlRTLnR4dFxuICovXG5jb25zdCBkaXJlY3RpdmVzID0gbmV3IFdlYWtNYXAoKTtcbi8qKlxuICogQnJhbmRzIGEgZnVuY3Rpb24gYXMgYSBkaXJlY3RpdmUgZmFjdG9yeSBmdW5jdGlvbiBzbyB0aGF0IGxpdC1odG1sIHdpbGwgY2FsbFxuICogdGhlIGZ1bmN0aW9uIGR1cmluZyB0ZW1wbGF0ZSByZW5kZXJpbmcsIHJhdGhlciB0aGFuIHBhc3NpbmcgYXMgYSB2YWx1ZS5cbiAqXG4gKiBBIF9kaXJlY3RpdmVfIGlzIGEgZnVuY3Rpb24gdGhhdCB0YWtlcyBhIFBhcnQgYXMgYW4gYXJndW1lbnQuIEl0IGhhcyB0aGVcbiAqIHNpZ25hdHVyZTogYChwYXJ0OiBQYXJ0KSA9PiB2b2lkYC5cbiAqXG4gKiBBIGRpcmVjdGl2ZSBfZmFjdG9yeV8gaXMgYSBmdW5jdGlvbiB0aGF0IHRha2VzIGFyZ3VtZW50cyBmb3IgZGF0YSBhbmRcbiAqIGNvbmZpZ3VyYXRpb24gYW5kIHJldHVybnMgYSBkaXJlY3RpdmUuIFVzZXJzIG9mIGRpcmVjdGl2ZSB1c3VhbGx5IHJlZmVyIHRvXG4gKiB0aGUgZGlyZWN0aXZlIGZhY3RvcnkgYXMgdGhlIGRpcmVjdGl2ZS4gRm9yIGV4YW1wbGUsIFwiVGhlIHJlcGVhdCBkaXJlY3RpdmVcIi5cbiAqXG4gKiBVc3VhbGx5IGEgdGVtcGxhdGUgYXV0aG9yIHdpbGwgaW52b2tlIGEgZGlyZWN0aXZlIGZhY3RvcnkgaW4gdGhlaXIgdGVtcGxhdGVcbiAqIHdpdGggcmVsZXZhbnQgYXJndW1lbnRzLCB3aGljaCB3aWxsIHRoZW4gcmV0dXJuIGEgZGlyZWN0aXZlIGZ1bmN0aW9uLlxuICpcbiAqIEhlcmUncyBhbiBleGFtcGxlIG9mIHVzaW5nIHRoZSBgcmVwZWF0KClgIGRpcmVjdGl2ZSBmYWN0b3J5IHRoYXQgdGFrZXMgYW5cbiAqIGFycmF5IGFuZCBhIGZ1bmN0aW9uIHRvIHJlbmRlciBhbiBpdGVtOlxuICpcbiAqIGBgYGpzXG4gKiBodG1sYDx1bD48JHtyZXBlYXQoaXRlbXMsIChpdGVtKSA9PiBodG1sYDxsaT4ke2l0ZW19PC9saT5gKX08L3VsPmBcbiAqIGBgYFxuICpcbiAqIFdoZW4gYHJlcGVhdGAgaXMgaW52b2tlZCwgaXQgcmV0dXJucyBhIGRpcmVjdGl2ZSBmdW5jdGlvbiB0aGF0IGNsb3NlcyBvdmVyXG4gKiBgaXRlbXNgIGFuZCB0aGUgdGVtcGxhdGUgZnVuY3Rpb24uIFdoZW4gdGhlIG91dGVyIHRlbXBsYXRlIGlzIHJlbmRlcmVkLCB0aGVcbiAqIHJldHVybiBkaXJlY3RpdmUgZnVuY3Rpb24gaXMgY2FsbGVkIHdpdGggdGhlIFBhcnQgZm9yIHRoZSBleHByZXNzaW9uLlxuICogYHJlcGVhdGAgdGhlbiBwZXJmb3JtcyBpdCdzIGN1c3RvbSBsb2dpYyB0byByZW5kZXIgbXVsdGlwbGUgaXRlbXMuXG4gKlxuICogQHBhcmFtIGYgVGhlIGRpcmVjdGl2ZSBmYWN0b3J5IGZ1bmN0aW9uLiBNdXN0IGJlIGEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGFcbiAqIGZ1bmN0aW9uIG9mIHRoZSBzaWduYXR1cmUgYChwYXJ0OiBQYXJ0KSA9PiB2b2lkYC4gVGhlIHJldHVybmVkIGZ1bmN0aW9uIHdpbGxcbiAqIGJlIGNhbGxlZCB3aXRoIHRoZSBwYXJ0IG9iamVjdC5cbiAqXG4gKiBAZXhhbXBsZVxuICpcbiAqIGltcG9ydCB7ZGlyZWN0aXZlLCBodG1sfSBmcm9tICdsaXQtaHRtbCc7XG4gKlxuICogY29uc3QgaW1tdXRhYmxlID0gZGlyZWN0aXZlKCh2KSA9PiAocGFydCkgPT4ge1xuICogICBpZiAocGFydC52YWx1ZSAhPT0gdikge1xuICogICAgIHBhcnQuc2V0VmFsdWUodilcbiAqICAgfVxuICogfSk7XG4gKi9cbmV4cG9ydCBjb25zdCBkaXJlY3RpdmUgPSAoZikgPT4gKCguLi5hcmdzKSA9PiB7XG4gICAgY29uc3QgZCA9IGYoLi4uYXJncyk7XG4gICAgZGlyZWN0aXZlcy5zZXQoZCwgdHJ1ZSk7XG4gICAgcmV0dXJuIGQ7XG59KTtcbmV4cG9ydCBjb25zdCBpc0RpcmVjdGl2ZSA9IChvKSA9PiB7XG4gICAgcmV0dXJuIHR5cGVvZiBvID09PSAnZnVuY3Rpb24nICYmIGRpcmVjdGl2ZXMuaGFzKG8pO1xufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRpcmVjdGl2ZS5qcy5tYXAiLCIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTggVGhlIFBvbHltZXIgUHJvamVjdCBBdXRob3JzLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogVGhpcyBjb2RlIG1heSBvbmx5IGJlIHVzZWQgdW5kZXIgdGhlIEJTRCBzdHlsZSBsaWNlbnNlIGZvdW5kIGF0XG4gKiBodHRwOi8vcG9seW1lci5naXRodWIuaW8vTElDRU5TRS50eHRcbiAqIFRoZSBjb21wbGV0ZSBzZXQgb2YgYXV0aG9ycyBtYXkgYmUgZm91bmQgYXRcbiAqIGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9BVVRIT1JTLnR4dFxuICogVGhlIGNvbXBsZXRlIHNldCBvZiBjb250cmlidXRvcnMgbWF5IGJlIGZvdW5kIGF0XG4gKiBodHRwOi8vcG9seW1lci5naXRodWIuaW8vQ09OVFJJQlVUT1JTLnR4dFxuICogQ29kZSBkaXN0cmlidXRlZCBieSBHb29nbGUgYXMgcGFydCBvZiB0aGUgcG9seW1lciBwcm9qZWN0IGlzIGFsc29cbiAqIHN1YmplY3QgdG8gYW4gYWRkaXRpb25hbCBJUCByaWdodHMgZ3JhbnQgZm91bmQgYXRcbiAqIGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9QQVRFTlRTLnR4dFxuICovXG4vKipcbiAqIEEgc2VudGluZWwgdmFsdWUgdGhhdCBzaWduYWxzIHRoYXQgYSB2YWx1ZSB3YXMgaGFuZGxlZCBieSBhIGRpcmVjdGl2ZSBhbmRcbiAqIHNob3VsZCBub3QgYmUgd3JpdHRlbiB0byB0aGUgRE9NLlxuICovXG5leHBvcnQgY29uc3Qgbm9DaGFuZ2UgPSB7fTtcbi8qKlxuICogQSBzZW50aW5lbCB2YWx1ZSB0aGF0IHNpZ25hbHMgYSBOb2RlUGFydCB0byBmdWxseSBjbGVhciBpdHMgY29udGVudC5cbiAqL1xuZXhwb3J0IGNvbnN0IG5vdGhpbmcgPSB7fTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhcnQuanMubWFwIiwiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IChjKSAyMDE3IFRoZSBQb2x5bWVyIFByb2plY3QgQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqIFRoaXMgY29kZSBtYXkgb25seSBiZSB1c2VkIHVuZGVyIHRoZSBCU0Qgc3R5bGUgbGljZW5zZSBmb3VuZCBhdFxuICogaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0xJQ0VOU0UudHh0XG4gKiBUaGUgY29tcGxldGUgc2V0IG9mIGF1dGhvcnMgbWF5IGJlIGZvdW5kIGF0XG4gKiBodHRwOi8vcG9seW1lci5naXRodWIuaW8vQVVUSE9SUy50eHRcbiAqIFRoZSBjb21wbGV0ZSBzZXQgb2YgY29udHJpYnV0b3JzIG1heSBiZSBmb3VuZCBhdFxuICogaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0NPTlRSSUJVVE9SUy50eHRcbiAqIENvZGUgZGlzdHJpYnV0ZWQgYnkgR29vZ2xlIGFzIHBhcnQgb2YgdGhlIHBvbHltZXIgcHJvamVjdCBpcyBhbHNvXG4gKiBzdWJqZWN0IHRvIGFuIGFkZGl0aW9uYWwgSVAgcmlnaHRzIGdyYW50IGZvdW5kIGF0XG4gKiBodHRwOi8vcG9seW1lci5naXRodWIuaW8vUEFURU5UUy50eHRcbiAqL1xuLyoqXG4gKiBAbW9kdWxlIGxpdC1odG1sXG4gKi9cbmltcG9ydCB7IGlzQ0VQb2x5ZmlsbCB9IGZyb20gJy4vZG9tLmpzJztcbmltcG9ydCB7IGlzVGVtcGxhdGVQYXJ0QWN0aXZlIH0gZnJvbSAnLi90ZW1wbGF0ZS5qcyc7XG4vKipcbiAqIEFuIGluc3RhbmNlIG9mIGEgYFRlbXBsYXRlYCB0aGF0IGNhbiBiZSBhdHRhY2hlZCB0byB0aGUgRE9NIGFuZCB1cGRhdGVkXG4gKiB3aXRoIG5ldyB2YWx1ZXMuXG4gKi9cbmV4cG9ydCBjbGFzcyBUZW1wbGF0ZUluc3RhbmNlIHtcbiAgICBjb25zdHJ1Y3Rvcih0ZW1wbGF0ZSwgcHJvY2Vzc29yLCBvcHRpb25zKSB7XG4gICAgICAgIHRoaXMuX19wYXJ0cyA9IFtdO1xuICAgICAgICB0aGlzLnRlbXBsYXRlID0gdGVtcGxhdGU7XG4gICAgICAgIHRoaXMucHJvY2Vzc29yID0gcHJvY2Vzc29yO1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgIH1cbiAgICB1cGRhdGUodmFsdWVzKSB7XG4gICAgICAgIGxldCBpID0gMDtcbiAgICAgICAgZm9yIChjb25zdCBwYXJ0IG9mIHRoaXMuX19wYXJ0cykge1xuICAgICAgICAgICAgaWYgKHBhcnQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHBhcnQuc2V0VmFsdWUodmFsdWVzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGkrKztcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IHBhcnQgb2YgdGhpcy5fX3BhcnRzKSB7XG4gICAgICAgICAgICBpZiAocGFydCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcGFydC5jb21taXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBfY2xvbmUoKSB7XG4gICAgICAgIC8vIFRoZXJlIGFyZSBhIG51bWJlciBvZiBzdGVwcyBpbiB0aGUgbGlmZWN5Y2xlIG9mIGEgdGVtcGxhdGUgaW5zdGFuY2Unc1xuICAgICAgICAvLyBET00gZnJhZ21lbnQ6XG4gICAgICAgIC8vICAxLiBDbG9uZSAtIGNyZWF0ZSB0aGUgaW5zdGFuY2UgZnJhZ21lbnRcbiAgICAgICAgLy8gIDIuIEFkb3B0IC0gYWRvcHQgaW50byB0aGUgbWFpbiBkb2N1bWVudFxuICAgICAgICAvLyAgMy4gUHJvY2VzcyAtIGZpbmQgcGFydCBtYXJrZXJzIGFuZCBjcmVhdGUgcGFydHNcbiAgICAgICAgLy8gIDQuIFVwZ3JhZGUgLSB1cGdyYWRlIGN1c3RvbSBlbGVtZW50c1xuICAgICAgICAvLyAgNS4gVXBkYXRlIC0gc2V0IG5vZGUsIGF0dHJpYnV0ZSwgcHJvcGVydHksIGV0Yy4sIHZhbHVlc1xuICAgICAgICAvLyAgNi4gQ29ubmVjdCAtIGNvbm5lY3QgdG8gdGhlIGRvY3VtZW50LiBPcHRpb25hbCBhbmQgb3V0c2lkZSBvZiB0aGlzXG4gICAgICAgIC8vICAgICBtZXRob2QuXG4gICAgICAgIC8vXG4gICAgICAgIC8vIFdlIGhhdmUgYSBmZXcgY29uc3RyYWludHMgb24gdGhlIG9yZGVyaW5nIG9mIHRoZXNlIHN0ZXBzOlxuICAgICAgICAvLyAgKiBXZSBuZWVkIHRvIHVwZ3JhZGUgYmVmb3JlIHVwZGF0aW5nLCBzbyB0aGF0IHByb3BlcnR5IHZhbHVlcyB3aWxsIHBhc3NcbiAgICAgICAgLy8gICAgdGhyb3VnaCBhbnkgcHJvcGVydHkgc2V0dGVycy5cbiAgICAgICAgLy8gICogV2Ugd291bGQgbGlrZSB0byBwcm9jZXNzIGJlZm9yZSB1cGdyYWRpbmcgc28gdGhhdCB3ZSdyZSBzdXJlIHRoYXQgdGhlXG4gICAgICAgIC8vICAgIGNsb25lZCBmcmFnbWVudCBpcyBpbmVydCBhbmQgbm90IGRpc3R1cmJlZCBieSBzZWxmLW1vZGlmeWluZyBET00uXG4gICAgICAgIC8vICAqIFdlIHdhbnQgY3VzdG9tIGVsZW1lbnRzIHRvIHVwZ3JhZGUgZXZlbiBpbiBkaXNjb25uZWN0ZWQgZnJhZ21lbnRzLlxuICAgICAgICAvL1xuICAgICAgICAvLyBHaXZlbiB0aGVzZSBjb25zdHJhaW50cywgd2l0aCBmdWxsIGN1c3RvbSBlbGVtZW50cyBzdXBwb3J0IHdlIHdvdWxkXG4gICAgICAgIC8vIHByZWZlciB0aGUgb3JkZXI6IENsb25lLCBQcm9jZXNzLCBBZG9wdCwgVXBncmFkZSwgVXBkYXRlLCBDb25uZWN0XG4gICAgICAgIC8vXG4gICAgICAgIC8vIEJ1dCBTYWZhcmkgZG9lcyBub3QgaW1wbGVtZW50IEN1c3RvbUVsZW1lbnRSZWdpc3RyeSN1cGdyYWRlLCBzbyB3ZVxuICAgICAgICAvLyBjYW4gbm90IGltcGxlbWVudCB0aGF0IG9yZGVyIGFuZCBzdGlsbCBoYXZlIHVwZ3JhZGUtYmVmb3JlLXVwZGF0ZSBhbmRcbiAgICAgICAgLy8gdXBncmFkZSBkaXNjb25uZWN0ZWQgZnJhZ21lbnRzLiBTbyB3ZSBpbnN0ZWFkIHNhY3JpZmljZSB0aGVcbiAgICAgICAgLy8gcHJvY2Vzcy1iZWZvcmUtdXBncmFkZSBjb25zdHJhaW50LCBzaW5jZSBpbiBDdXN0b20gRWxlbWVudHMgdjEgZWxlbWVudHNcbiAgICAgICAgLy8gbXVzdCBub3QgbW9kaWZ5IHRoZWlyIGxpZ2h0IERPTSBpbiB0aGUgY29uc3RydWN0b3IuIFdlIHN0aWxsIGhhdmUgaXNzdWVzXG4gICAgICAgIC8vIHdoZW4gY28tZXhpc3Rpbmcgd2l0aCBDRXYwIGVsZW1lbnRzIGxpa2UgUG9seW1lciAxLCBhbmQgd2l0aCBwb2x5ZmlsbHNcbiAgICAgICAgLy8gdGhhdCBkb24ndCBzdHJpY3RseSBhZGhlcmUgdG8gdGhlIG5vLW1vZGlmaWNhdGlvbiBydWxlIGJlY2F1c2Ugc2hhZG93XG4gICAgICAgIC8vIERPTSwgd2hpY2ggbWF5IGJlIGNyZWF0ZWQgaW4gdGhlIGNvbnN0cnVjdG9yLCBpcyBlbXVsYXRlZCBieSBiZWluZyBwbGFjZWRcbiAgICAgICAgLy8gaW4gdGhlIGxpZ2h0IERPTS5cbiAgICAgICAgLy9cbiAgICAgICAgLy8gVGhlIHJlc3VsdGluZyBvcmRlciBpcyBvbiBuYXRpdmUgaXM6IENsb25lLCBBZG9wdCwgVXBncmFkZSwgUHJvY2VzcyxcbiAgICAgICAgLy8gVXBkYXRlLCBDb25uZWN0LiBkb2N1bWVudC5pbXBvcnROb2RlKCkgcGVyZm9ybXMgQ2xvbmUsIEFkb3B0LCBhbmQgVXBncmFkZVxuICAgICAgICAvLyBpbiBvbmUgc3RlcC5cbiAgICAgICAgLy9cbiAgICAgICAgLy8gVGhlIEN1c3RvbSBFbGVtZW50cyB2MSBwb2x5ZmlsbCBzdXBwb3J0cyB1cGdyYWRlKCksIHNvIHRoZSBvcmRlciB3aGVuXG4gICAgICAgIC8vIHBvbHlmaWxsZWQgaXMgdGhlIG1vcmUgaWRlYWw6IENsb25lLCBQcm9jZXNzLCBBZG9wdCwgVXBncmFkZSwgVXBkYXRlLFxuICAgICAgICAvLyBDb25uZWN0LlxuICAgICAgICBjb25zdCBmcmFnbWVudCA9IGlzQ0VQb2x5ZmlsbCA/XG4gICAgICAgICAgICB0aGlzLnRlbXBsYXRlLmVsZW1lbnQuY29udGVudC5jbG9uZU5vZGUodHJ1ZSkgOlxuICAgICAgICAgICAgZG9jdW1lbnQuaW1wb3J0Tm9kZSh0aGlzLnRlbXBsYXRlLmVsZW1lbnQuY29udGVudCwgdHJ1ZSk7XG4gICAgICAgIGNvbnN0IHN0YWNrID0gW107XG4gICAgICAgIGNvbnN0IHBhcnRzID0gdGhpcy50ZW1wbGF0ZS5wYXJ0cztcbiAgICAgICAgLy8gRWRnZSBuZWVkcyBhbGwgNCBwYXJhbWV0ZXJzIHByZXNlbnQ7IElFMTEgbmVlZHMgM3JkIHBhcmFtZXRlciB0byBiZSBudWxsXG4gICAgICAgIGNvbnN0IHdhbGtlciA9IGRvY3VtZW50LmNyZWF0ZVRyZWVXYWxrZXIoZnJhZ21lbnQsIDEzMyAvKiBOb2RlRmlsdGVyLlNIT1dfe0VMRU1FTlR8Q09NTUVOVHxURVhUfSAqLywgbnVsbCwgZmFsc2UpO1xuICAgICAgICBsZXQgcGFydEluZGV4ID0gMDtcbiAgICAgICAgbGV0IG5vZGVJbmRleCA9IDA7XG4gICAgICAgIGxldCBwYXJ0O1xuICAgICAgICBsZXQgbm9kZSA9IHdhbGtlci5uZXh0Tm9kZSgpO1xuICAgICAgICAvLyBMb29wIHRocm91Z2ggYWxsIHRoZSBub2RlcyBhbmQgcGFydHMgb2YgYSB0ZW1wbGF0ZVxuICAgICAgICB3aGlsZSAocGFydEluZGV4IDwgcGFydHMubGVuZ3RoKSB7XG4gICAgICAgICAgICBwYXJ0ID0gcGFydHNbcGFydEluZGV4XTtcbiAgICAgICAgICAgIGlmICghaXNUZW1wbGF0ZVBhcnRBY3RpdmUocGFydCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9fcGFydHMucHVzaCh1bmRlZmluZWQpO1xuICAgICAgICAgICAgICAgIHBhcnRJbmRleCsrO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gUHJvZ3Jlc3MgdGhlIHRyZWUgd2Fsa2VyIHVudGlsIHdlIGZpbmQgb3VyIG5leHQgcGFydCdzIG5vZGUuXG4gICAgICAgICAgICAvLyBOb3RlIHRoYXQgbXVsdGlwbGUgcGFydHMgbWF5IHNoYXJlIHRoZSBzYW1lIG5vZGUgKGF0dHJpYnV0ZSBwYXJ0c1xuICAgICAgICAgICAgLy8gb24gYSBzaW5nbGUgZWxlbWVudCksIHNvIHRoaXMgbG9vcCBtYXkgbm90IHJ1biBhdCBhbGwuXG4gICAgICAgICAgICB3aGlsZSAobm9kZUluZGV4IDwgcGFydC5pbmRleCkge1xuICAgICAgICAgICAgICAgIG5vZGVJbmRleCsrO1xuICAgICAgICAgICAgICAgIGlmIChub2RlLm5vZGVOYW1lID09PSAnVEVNUExBVEUnKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YWNrLnB1c2gobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIHdhbGtlci5jdXJyZW50Tm9kZSA9IG5vZGUuY29udGVudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKChub2RlID0gd2Fsa2VyLm5leHROb2RlKCkpID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFdlJ3ZlIGV4aGF1c3RlZCB0aGUgY29udGVudCBpbnNpZGUgYSBuZXN0ZWQgdGVtcGxhdGUgZWxlbWVudC5cbiAgICAgICAgICAgICAgICAgICAgLy8gQmVjYXVzZSB3ZSBzdGlsbCBoYXZlIHBhcnRzICh0aGUgb3V0ZXIgZm9yLWxvb3ApLCB3ZSBrbm93OlxuICAgICAgICAgICAgICAgICAgICAvLyAtIFRoZXJlIGlzIGEgdGVtcGxhdGUgaW4gdGhlIHN0YWNrXG4gICAgICAgICAgICAgICAgICAgIC8vIC0gVGhlIHdhbGtlciB3aWxsIGZpbmQgYSBuZXh0Tm9kZSBvdXRzaWRlIHRoZSB0ZW1wbGF0ZVxuICAgICAgICAgICAgICAgICAgICB3YWxrZXIuY3VycmVudE5vZGUgPSBzdGFjay5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZSA9IHdhbGtlci5uZXh0Tm9kZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIFdlJ3ZlIGFycml2ZWQgYXQgb3VyIHBhcnQncyBub2RlLlxuICAgICAgICAgICAgaWYgKHBhcnQudHlwZSA9PT0gJ25vZGUnKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcGFydCA9IHRoaXMucHJvY2Vzc29yLmhhbmRsZVRleHRFeHByZXNzaW9uKHRoaXMub3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgcGFydC5pbnNlcnRBZnRlck5vZGUobm9kZS5wcmV2aW91c1NpYmxpbmcpO1xuICAgICAgICAgICAgICAgIHRoaXMuX19wYXJ0cy5wdXNoKHBhcnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fX3BhcnRzLnB1c2goLi4udGhpcy5wcm9jZXNzb3IuaGFuZGxlQXR0cmlidXRlRXhwcmVzc2lvbnMobm9kZSwgcGFydC5uYW1lLCBwYXJ0LnN0cmluZ3MsIHRoaXMub3B0aW9ucykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGFydEluZGV4Kys7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzQ0VQb2x5ZmlsbCkge1xuICAgICAgICAgICAgZG9jdW1lbnQuYWRvcHROb2RlKGZyYWdtZW50KTtcbiAgICAgICAgICAgIGN1c3RvbUVsZW1lbnRzLnVwZ3JhZGUoZnJhZ21lbnQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmcmFnbWVudDtcbiAgICB9XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD10ZW1wbGF0ZS1pbnN0YW5jZS5qcy5tYXAiLCIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTcgVGhlIFBvbHltZXIgUHJvamVjdCBBdXRob3JzLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogVGhpcyBjb2RlIG1heSBvbmx5IGJlIHVzZWQgdW5kZXIgdGhlIEJTRCBzdHlsZSBsaWNlbnNlIGZvdW5kIGF0XG4gKiBodHRwOi8vcG9seW1lci5naXRodWIuaW8vTElDRU5TRS50eHRcbiAqIFRoZSBjb21wbGV0ZSBzZXQgb2YgYXV0aG9ycyBtYXkgYmUgZm91bmQgYXRcbiAqIGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9BVVRIT1JTLnR4dFxuICogVGhlIGNvbXBsZXRlIHNldCBvZiBjb250cmlidXRvcnMgbWF5IGJlIGZvdW5kIGF0XG4gKiBodHRwOi8vcG9seW1lci5naXRodWIuaW8vQ09OVFJJQlVUT1JTLnR4dFxuICogQ29kZSBkaXN0cmlidXRlZCBieSBHb29nbGUgYXMgcGFydCBvZiB0aGUgcG9seW1lciBwcm9qZWN0IGlzIGFsc29cbiAqIHN1YmplY3QgdG8gYW4gYWRkaXRpb25hbCBJUCByaWdodHMgZ3JhbnQgZm91bmQgYXRcbiAqIGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9QQVRFTlRTLnR4dFxuICovXG4vKipcbiAqIEBtb2R1bGUgbGl0LWh0bWxcbiAqL1xuaW1wb3J0IHsgcmVwYXJlbnROb2RlcyB9IGZyb20gJy4vZG9tLmpzJztcbmltcG9ydCB7IGJvdW5kQXR0cmlidXRlU3VmZml4LCBsYXN0QXR0cmlidXRlTmFtZVJlZ2V4LCBtYXJrZXIsIG5vZGVNYXJrZXIgfSBmcm9tICcuL3RlbXBsYXRlLmpzJztcbmNvbnN0IGNvbW1lbnRNYXJrZXIgPSBgICR7bWFya2VyfSBgO1xuLyoqXG4gKiBUaGUgcmV0dXJuIHR5cGUgb2YgYGh0bWxgLCB3aGljaCBob2xkcyBhIFRlbXBsYXRlIGFuZCB0aGUgdmFsdWVzIGZyb21cbiAqIGludGVycG9sYXRlZCBleHByZXNzaW9ucy5cbiAqL1xuZXhwb3J0IGNsYXNzIFRlbXBsYXRlUmVzdWx0IHtcbiAgICBjb25zdHJ1Y3RvcihzdHJpbmdzLCB2YWx1ZXMsIHR5cGUsIHByb2Nlc3Nvcikge1xuICAgICAgICB0aGlzLnN0cmluZ3MgPSBzdHJpbmdzO1xuICAgICAgICB0aGlzLnZhbHVlcyA9IHZhbHVlcztcbiAgICAgICAgdGhpcy50eXBlID0gdHlwZTtcbiAgICAgICAgdGhpcy5wcm9jZXNzb3IgPSBwcm9jZXNzb3I7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBzdHJpbmcgb2YgSFRNTCB1c2VkIHRvIGNyZWF0ZSBhIGA8dGVtcGxhdGU+YCBlbGVtZW50LlxuICAgICAqL1xuICAgIGdldEhUTUwoKSB7XG4gICAgICAgIGNvbnN0IGwgPSB0aGlzLnN0cmluZ3MubGVuZ3RoIC0gMTtcbiAgICAgICAgbGV0IGh0bWwgPSAnJztcbiAgICAgICAgbGV0IGlzQ29tbWVudEJpbmRpbmcgPSBmYWxzZTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSB0aGlzLnN0cmluZ3NbaV07XG4gICAgICAgICAgICAvLyBGb3IgZWFjaCBiaW5kaW5nIHdlIHdhbnQgdG8gZGV0ZXJtaW5lIHRoZSBraW5kIG9mIG1hcmtlciB0byBpbnNlcnRcbiAgICAgICAgICAgIC8vIGludG8gdGhlIHRlbXBsYXRlIHNvdXJjZSBiZWZvcmUgaXQncyBwYXJzZWQgYnkgdGhlIGJyb3dzZXIncyBIVE1MXG4gICAgICAgICAgICAvLyBwYXJzZXIuIFRoZSBtYXJrZXIgdHlwZSBpcyBiYXNlZCBvbiB3aGV0aGVyIHRoZSBleHByZXNzaW9uIGlzIGluIGFuXG4gICAgICAgICAgICAvLyBhdHRyaWJ1dGUsIHRleHQsIG9yIGNvbW1lbnQgcG9zaXRpb24uXG4gICAgICAgICAgICAvLyAgICogRm9yIG5vZGUtcG9zaXRpb24gYmluZGluZ3Mgd2UgaW5zZXJ0IGEgY29tbWVudCB3aXRoIHRoZSBtYXJrZXJcbiAgICAgICAgICAgIC8vICAgICBzZW50aW5lbCBhcyBpdHMgdGV4dCBjb250ZW50LCBsaWtlIDwhLS17e2xpdC1ndWlkfX0tLT4uXG4gICAgICAgICAgICAvLyAgICogRm9yIGF0dHJpYnV0ZSBiaW5kaW5ncyB3ZSBpbnNlcnQganVzdCB0aGUgbWFya2VyIHNlbnRpbmVsIGZvciB0aGVcbiAgICAgICAgICAgIC8vICAgICBmaXJzdCBiaW5kaW5nLCBzbyB0aGF0IHdlIHN1cHBvcnQgdW5xdW90ZWQgYXR0cmlidXRlIGJpbmRpbmdzLlxuICAgICAgICAgICAgLy8gICAgIFN1YnNlcXVlbnQgYmluZGluZ3MgY2FuIHVzZSBhIGNvbW1lbnQgbWFya2VyIGJlY2F1c2UgbXVsdGktYmluZGluZ1xuICAgICAgICAgICAgLy8gICAgIGF0dHJpYnV0ZXMgbXVzdCBiZSBxdW90ZWQuXG4gICAgICAgICAgICAvLyAgICogRm9yIGNvbW1lbnQgYmluZGluZ3Mgd2UgaW5zZXJ0IGp1c3QgdGhlIG1hcmtlciBzZW50aW5lbCBzbyB3ZSBkb24ndFxuICAgICAgICAgICAgLy8gICAgIGNsb3NlIHRoZSBjb21tZW50LlxuICAgICAgICAgICAgLy9cbiAgICAgICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgY29kZSBzY2FucyB0aGUgdGVtcGxhdGUgc291cmNlLCBidXQgaXMgKm5vdCogYW4gSFRNTFxuICAgICAgICAgICAgLy8gcGFyc2VyLiBXZSBkb24ndCBuZWVkIHRvIHRyYWNrIHRoZSB0cmVlIHN0cnVjdHVyZSBvZiB0aGUgSFRNTCwgb25seVxuICAgICAgICAgICAgLy8gd2hldGhlciBhIGJpbmRpbmcgaXMgaW5zaWRlIGEgY29tbWVudCwgYW5kIGlmIG5vdCwgaWYgaXQgYXBwZWFycyB0byBiZVxuICAgICAgICAgICAgLy8gdGhlIGZpcnN0IGJpbmRpbmcgaW4gYW4gYXR0cmlidXRlLlxuICAgICAgICAgICAgY29uc3QgY29tbWVudE9wZW4gPSBzLmxhc3RJbmRleE9mKCc8IS0tJyk7XG4gICAgICAgICAgICAvLyBXZSdyZSBpbiBjb21tZW50IHBvc2l0aW9uIGlmIHdlIGhhdmUgYSBjb21tZW50IG9wZW4gd2l0aCBubyBmb2xsb3dpbmdcbiAgICAgICAgICAgIC8vIGNvbW1lbnQgY2xvc2UuIEJlY2F1c2UgPC0tIGNhbiBhcHBlYXIgaW4gYW4gYXR0cmlidXRlIHZhbHVlIHRoZXJlIGNhblxuICAgICAgICAgICAgLy8gYmUgZmFsc2UgcG9zaXRpdmVzLlxuICAgICAgICAgICAgaXNDb21tZW50QmluZGluZyA9IChjb21tZW50T3BlbiA+IC0xIHx8IGlzQ29tbWVudEJpbmRpbmcpICYmXG4gICAgICAgICAgICAgICAgcy5pbmRleE9mKCctLT4nLCBjb21tZW50T3BlbiArIDEpID09PSAtMTtcbiAgICAgICAgICAgIC8vIENoZWNrIHRvIHNlZSBpZiB3ZSBoYXZlIGFuIGF0dHJpYnV0ZS1saWtlIHNlcXVlbmNlIHByZWNlZGluZyB0aGVcbiAgICAgICAgICAgIC8vIGV4cHJlc3Npb24uIFRoaXMgY2FuIG1hdGNoIFwibmFtZT12YWx1ZVwiIGxpa2Ugc3RydWN0dXJlcyBpbiB0ZXh0LFxuICAgICAgICAgICAgLy8gY29tbWVudHMsIGFuZCBhdHRyaWJ1dGUgdmFsdWVzLCBzbyB0aGVyZSBjYW4gYmUgZmFsc2UtcG9zaXRpdmVzLlxuICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlTWF0Y2ggPSBsYXN0QXR0cmlidXRlTmFtZVJlZ2V4LmV4ZWMocyk7XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlTWF0Y2ggPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAvLyBXZSdyZSBvbmx5IGluIHRoaXMgYnJhbmNoIGlmIHdlIGRvbid0IGhhdmUgYSBhdHRyaWJ1dGUtbGlrZVxuICAgICAgICAgICAgICAgIC8vIHByZWNlZGluZyBzZXF1ZW5jZS4gRm9yIGNvbW1lbnRzLCB0aGlzIGd1YXJkcyBhZ2FpbnN0IHVudXN1YWxcbiAgICAgICAgICAgICAgICAvLyBhdHRyaWJ1dGUgdmFsdWVzIGxpa2UgPGRpdiBmb289XCI8IS0tJHsnYmFyJ31cIj4uIENhc2VzIGxpa2VcbiAgICAgICAgICAgICAgICAvLyA8IS0tIGZvbz0keydiYXInfS0tPiBhcmUgaGFuZGxlZCBjb3JyZWN0bHkgaW4gdGhlIGF0dHJpYnV0ZSBicmFuY2hcbiAgICAgICAgICAgICAgICAvLyBiZWxvdy5cbiAgICAgICAgICAgICAgICBodG1sICs9IHMgKyAoaXNDb21tZW50QmluZGluZyA/IGNvbW1lbnRNYXJrZXIgOiBub2RlTWFya2VyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIEZvciBhdHRyaWJ1dGVzIHdlIHVzZSBqdXN0IGEgbWFya2VyIHNlbnRpbmVsLCBhbmQgYWxzbyBhcHBlbmQgYVxuICAgICAgICAgICAgICAgIC8vICRsaXQkIHN1ZmZpeCB0byB0aGUgbmFtZSB0byBvcHQtb3V0IG9mIGF0dHJpYnV0ZS1zcGVjaWZpYyBwYXJzaW5nXG4gICAgICAgICAgICAgICAgLy8gdGhhdCBJRSBhbmQgRWRnZSBkbyBmb3Igc3R5bGUgYW5kIGNlcnRhaW4gU1ZHIGF0dHJpYnV0ZXMuXG4gICAgICAgICAgICAgICAgaHRtbCArPSBzLnN1YnN0cigwLCBhdHRyaWJ1dGVNYXRjaC5pbmRleCkgKyBhdHRyaWJ1dGVNYXRjaFsxXSArXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZU1hdGNoWzJdICsgYm91bmRBdHRyaWJ1dGVTdWZmaXggKyBhdHRyaWJ1dGVNYXRjaFszXSArXG4gICAgICAgICAgICAgICAgICAgIG1hcmtlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBodG1sICs9IHRoaXMuc3RyaW5nc1tsXTtcbiAgICAgICAgcmV0dXJuIGh0bWw7XG4gICAgfVxuICAgIGdldFRlbXBsYXRlRWxlbWVudCgpIHtcbiAgICAgICAgY29uc3QgdGVtcGxhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZW1wbGF0ZScpO1xuICAgICAgICB0ZW1wbGF0ZS5pbm5lckhUTUwgPSB0aGlzLmdldEhUTUwoKTtcbiAgICAgICAgcmV0dXJuIHRlbXBsYXRlO1xuICAgIH1cbn1cbi8qKlxuICogQSBUZW1wbGF0ZVJlc3VsdCBmb3IgU1ZHIGZyYWdtZW50cy5cbiAqXG4gKiBUaGlzIGNsYXNzIHdyYXBzIEhUTUwgaW4gYW4gYDxzdmc+YCB0YWcgaW4gb3JkZXIgdG8gcGFyc2UgaXRzIGNvbnRlbnRzIGluIHRoZVxuICogU1ZHIG5hbWVzcGFjZSwgdGhlbiBtb2RpZmllcyB0aGUgdGVtcGxhdGUgdG8gcmVtb3ZlIHRoZSBgPHN2Zz5gIHRhZyBzbyB0aGF0XG4gKiBjbG9uZXMgb25seSBjb250YWluZXIgdGhlIG9yaWdpbmFsIGZyYWdtZW50LlxuICovXG5leHBvcnQgY2xhc3MgU1ZHVGVtcGxhdGVSZXN1bHQgZXh0ZW5kcyBUZW1wbGF0ZVJlc3VsdCB7XG4gICAgZ2V0SFRNTCgpIHtcbiAgICAgICAgcmV0dXJuIGA8c3ZnPiR7c3VwZXIuZ2V0SFRNTCgpfTwvc3ZnPmA7XG4gICAgfVxuICAgIGdldFRlbXBsYXRlRWxlbWVudCgpIHtcbiAgICAgICAgY29uc3QgdGVtcGxhdGUgPSBzdXBlci5nZXRUZW1wbGF0ZUVsZW1lbnQoKTtcbiAgICAgICAgY29uc3QgY29udGVudCA9IHRlbXBsYXRlLmNvbnRlbnQ7XG4gICAgICAgIGNvbnN0IHN2Z0VsZW1lbnQgPSBjb250ZW50LmZpcnN0Q2hpbGQ7XG4gICAgICAgIGNvbnRlbnQucmVtb3ZlQ2hpbGQoc3ZnRWxlbWVudCk7XG4gICAgICAgIHJlcGFyZW50Tm9kZXMoY29udGVudCwgc3ZnRWxlbWVudC5maXJzdENoaWxkKTtcbiAgICAgICAgcmV0dXJuIHRlbXBsYXRlO1xuICAgIH1cbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRlbXBsYXRlLXJlc3VsdC5qcy5tYXAiLCIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTcgVGhlIFBvbHltZXIgUHJvamVjdCBBdXRob3JzLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogVGhpcyBjb2RlIG1heSBvbmx5IGJlIHVzZWQgdW5kZXIgdGhlIEJTRCBzdHlsZSBsaWNlbnNlIGZvdW5kIGF0XG4gKiBodHRwOi8vcG9seW1lci5naXRodWIuaW8vTElDRU5TRS50eHRcbiAqIFRoZSBjb21wbGV0ZSBzZXQgb2YgYXV0aG9ycyBtYXkgYmUgZm91bmQgYXRcbiAqIGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9BVVRIT1JTLnR4dFxuICogVGhlIGNvbXBsZXRlIHNldCBvZiBjb250cmlidXRvcnMgbWF5IGJlIGZvdW5kIGF0XG4gKiBodHRwOi8vcG9seW1lci5naXRodWIuaW8vQ09OVFJJQlVUT1JTLnR4dFxuICogQ29kZSBkaXN0cmlidXRlZCBieSBHb29nbGUgYXMgcGFydCBvZiB0aGUgcG9seW1lciBwcm9qZWN0IGlzIGFsc29cbiAqIHN1YmplY3QgdG8gYW4gYWRkaXRpb25hbCBJUCByaWdodHMgZ3JhbnQgZm91bmQgYXRcbiAqIGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9QQVRFTlRTLnR4dFxuICovXG4vKipcbiAqIEBtb2R1bGUgbGl0LWh0bWxcbiAqL1xuaW1wb3J0IHsgaXNEaXJlY3RpdmUgfSBmcm9tICcuL2RpcmVjdGl2ZS5qcyc7XG5pbXBvcnQgeyByZW1vdmVOb2RlcyB9IGZyb20gJy4vZG9tLmpzJztcbmltcG9ydCB7IG5vQ2hhbmdlLCBub3RoaW5nIH0gZnJvbSAnLi9wYXJ0LmpzJztcbmltcG9ydCB7IFRlbXBsYXRlSW5zdGFuY2UgfSBmcm9tICcuL3RlbXBsYXRlLWluc3RhbmNlLmpzJztcbmltcG9ydCB7IFRlbXBsYXRlUmVzdWx0IH0gZnJvbSAnLi90ZW1wbGF0ZS1yZXN1bHQuanMnO1xuaW1wb3J0IHsgY3JlYXRlTWFya2VyIH0gZnJvbSAnLi90ZW1wbGF0ZS5qcyc7XG5leHBvcnQgY29uc3QgaXNQcmltaXRpdmUgPSAodmFsdWUpID0+IHtcbiAgICByZXR1cm4gKHZhbHVlID09PSBudWxsIHx8XG4gICAgICAgICEodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyB8fCB0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicpKTtcbn07XG5leHBvcnQgY29uc3QgaXNJdGVyYWJsZSA9ICh2YWx1ZSkgPT4ge1xuICAgIHJldHVybiBBcnJheS5pc0FycmF5KHZhbHVlKSB8fFxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAhISh2YWx1ZSAmJiB2YWx1ZVtTeW1ib2wuaXRlcmF0b3JdKTtcbn07XG4vKipcbiAqIFdyaXRlcyBhdHRyaWJ1dGUgdmFsdWVzIHRvIHRoZSBET00gZm9yIGEgZ3JvdXAgb2YgQXR0cmlidXRlUGFydHMgYm91bmQgdG8gYVxuICogc2luZ2xlIGF0dHJpYnV0ZS4gVGhlIHZhbHVlIGlzIG9ubHkgc2V0IG9uY2UgZXZlbiBpZiB0aGVyZSBhcmUgbXVsdGlwbGUgcGFydHNcbiAqIGZvciBhbiBhdHRyaWJ1dGUuXG4gKi9cbmV4cG9ydCBjbGFzcyBBdHRyaWJ1dGVDb21taXR0ZXIge1xuICAgIGNvbnN0cnVjdG9yKGVsZW1lbnQsIG5hbWUsIHN0cmluZ3MpIHtcbiAgICAgICAgdGhpcy5kaXJ0eSA9IHRydWU7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMuc3RyaW5ncyA9IHN0cmluZ3M7XG4gICAgICAgIHRoaXMucGFydHMgPSBbXTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHJpbmdzLmxlbmd0aCAtIDE7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5wYXJ0c1tpXSA9IHRoaXMuX2NyZWF0ZVBhcnQoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgc2luZ2xlIHBhcnQuIE92ZXJyaWRlIHRoaXMgdG8gY3JlYXRlIGEgZGlmZmVybnQgdHlwZSBvZiBwYXJ0LlxuICAgICAqL1xuICAgIF9jcmVhdGVQYXJ0KCkge1xuICAgICAgICByZXR1cm4gbmV3IEF0dHJpYnV0ZVBhcnQodGhpcyk7XG4gICAgfVxuICAgIF9nZXRWYWx1ZSgpIHtcbiAgICAgICAgY29uc3Qgc3RyaW5ncyA9IHRoaXMuc3RyaW5ncztcbiAgICAgICAgY29uc3QgbCA9IHN0cmluZ3MubGVuZ3RoIC0gMTtcbiAgICAgICAgbGV0IHRleHQgPSAnJztcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgIHRleHQgKz0gc3RyaW5nc1tpXTtcbiAgICAgICAgICAgIGNvbnN0IHBhcnQgPSB0aGlzLnBhcnRzW2ldO1xuICAgICAgICAgICAgaWYgKHBhcnQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHYgPSBwYXJ0LnZhbHVlO1xuICAgICAgICAgICAgICAgIGlmIChpc1ByaW1pdGl2ZSh2KSB8fCAhaXNJdGVyYWJsZSh2KSkge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0ICs9IHR5cGVvZiB2ID09PSAnc3RyaW5nJyA/IHYgOiBTdHJpbmcodik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2Ygdikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArPSB0eXBlb2YgdCA9PT0gJ3N0cmluZycgPyB0IDogU3RyaW5nKHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRleHQgKz0gc3RyaW5nc1tsXTtcbiAgICAgICAgcmV0dXJuIHRleHQ7XG4gICAgfVxuICAgIGNvbW1pdCgpIHtcbiAgICAgICAgaWYgKHRoaXMuZGlydHkpIHtcbiAgICAgICAgICAgIHRoaXMuZGlydHkgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUodGhpcy5uYW1lLCB0aGlzLl9nZXRWYWx1ZSgpKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbi8qKlxuICogQSBQYXJ0IHRoYXQgY29udHJvbHMgYWxsIG9yIHBhcnQgb2YgYW4gYXR0cmlidXRlIHZhbHVlLlxuICovXG5leHBvcnQgY2xhc3MgQXR0cmlidXRlUGFydCB7XG4gICAgY29uc3RydWN0b3IoY29tbWl0dGVyKSB7XG4gICAgICAgIHRoaXMudmFsdWUgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuY29tbWl0dGVyID0gY29tbWl0dGVyO1xuICAgIH1cbiAgICBzZXRWYWx1ZSh2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgIT09IG5vQ2hhbmdlICYmICghaXNQcmltaXRpdmUodmFsdWUpIHx8IHZhbHVlICE9PSB0aGlzLnZhbHVlKSkge1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgLy8gSWYgdGhlIHZhbHVlIGlzIGEgbm90IGEgZGlyZWN0aXZlLCBkaXJ0eSB0aGUgY29tbWl0dGVyIHNvIHRoYXQgaXQnbGxcbiAgICAgICAgICAgIC8vIGNhbGwgc2V0QXR0cmlidXRlLiBJZiB0aGUgdmFsdWUgaXMgYSBkaXJlY3RpdmUsIGl0J2xsIGRpcnR5IHRoZVxuICAgICAgICAgICAgLy8gY29tbWl0dGVyIGlmIGl0IGNhbGxzIHNldFZhbHVlKCkuXG4gICAgICAgICAgICBpZiAoIWlzRGlyZWN0aXZlKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY29tbWl0dGVyLmRpcnR5ID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBjb21taXQoKSB7XG4gICAgICAgIHdoaWxlIChpc0RpcmVjdGl2ZSh0aGlzLnZhbHVlKSkge1xuICAgICAgICAgICAgY29uc3QgZGlyZWN0aXZlID0gdGhpcy52YWx1ZTtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSBub0NoYW5nZTtcbiAgICAgICAgICAgIGRpcmVjdGl2ZSh0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy52YWx1ZSA9PT0gbm9DaGFuZ2UpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNvbW1pdHRlci5jb21taXQoKTtcbiAgICB9XG59XG4vKipcbiAqIEEgUGFydCB0aGF0IGNvbnRyb2xzIGEgbG9jYXRpb24gd2l0aGluIGEgTm9kZSB0cmVlLiBMaWtlIGEgUmFuZ2UsIE5vZGVQYXJ0XG4gKiBoYXMgc3RhcnQgYW5kIGVuZCBsb2NhdGlvbnMgYW5kIGNhbiBzZXQgYW5kIHVwZGF0ZSB0aGUgTm9kZXMgYmV0d2VlbiB0aG9zZVxuICogbG9jYXRpb25zLlxuICpcbiAqIE5vZGVQYXJ0cyBzdXBwb3J0IHNldmVyYWwgdmFsdWUgdHlwZXM6IHByaW1pdGl2ZXMsIE5vZGVzLCBUZW1wbGF0ZVJlc3VsdHMsXG4gKiBhcyB3ZWxsIGFzIGFycmF5cyBhbmQgaXRlcmFibGVzIG9mIHRob3NlIHR5cGVzLlxuICovXG5leHBvcnQgY2xhc3MgTm9kZVBhcnQge1xuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5fX3BlbmRpbmdWYWx1ZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQXBwZW5kcyB0aGlzIHBhcnQgaW50byBhIGNvbnRhaW5lci5cbiAgICAgKlxuICAgICAqIFRoaXMgcGFydCBtdXN0IGJlIGVtcHR5LCBhcyBpdHMgY29udGVudHMgYXJlIG5vdCBhdXRvbWF0aWNhbGx5IG1vdmVkLlxuICAgICAqL1xuICAgIGFwcGVuZEludG8oY29udGFpbmVyKSB7XG4gICAgICAgIHRoaXMuc3RhcnROb2RlID0gY29udGFpbmVyLmFwcGVuZENoaWxkKGNyZWF0ZU1hcmtlcigpKTtcbiAgICAgICAgdGhpcy5lbmROb2RlID0gY29udGFpbmVyLmFwcGVuZENoaWxkKGNyZWF0ZU1hcmtlcigpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW5zZXJ0cyB0aGlzIHBhcnQgYWZ0ZXIgdGhlIGByZWZgIG5vZGUgKGJldHdlZW4gYHJlZmAgYW5kIGByZWZgJ3MgbmV4dFxuICAgICAqIHNpYmxpbmcpLiBCb3RoIGByZWZgIGFuZCBpdHMgbmV4dCBzaWJsaW5nIG11c3QgYmUgc3RhdGljLCB1bmNoYW5naW5nIG5vZGVzXG4gICAgICogc3VjaCBhcyB0aG9zZSB0aGF0IGFwcGVhciBpbiBhIGxpdGVyYWwgc2VjdGlvbiBvZiBhIHRlbXBsYXRlLlxuICAgICAqXG4gICAgICogVGhpcyBwYXJ0IG11c3QgYmUgZW1wdHksIGFzIGl0cyBjb250ZW50cyBhcmUgbm90IGF1dG9tYXRpY2FsbHkgbW92ZWQuXG4gICAgICovXG4gICAgaW5zZXJ0QWZ0ZXJOb2RlKHJlZikge1xuICAgICAgICB0aGlzLnN0YXJ0Tm9kZSA9IHJlZjtcbiAgICAgICAgdGhpcy5lbmROb2RlID0gcmVmLm5leHRTaWJsaW5nO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBcHBlbmRzIHRoaXMgcGFydCBpbnRvIGEgcGFyZW50IHBhcnQuXG4gICAgICpcbiAgICAgKiBUaGlzIHBhcnQgbXVzdCBiZSBlbXB0eSwgYXMgaXRzIGNvbnRlbnRzIGFyZSBub3QgYXV0b21hdGljYWxseSBtb3ZlZC5cbiAgICAgKi9cbiAgICBhcHBlbmRJbnRvUGFydChwYXJ0KSB7XG4gICAgICAgIHBhcnQuX19pbnNlcnQodGhpcy5zdGFydE5vZGUgPSBjcmVhdGVNYXJrZXIoKSk7XG4gICAgICAgIHBhcnQuX19pbnNlcnQodGhpcy5lbmROb2RlID0gY3JlYXRlTWFya2VyKCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbnNlcnRzIHRoaXMgcGFydCBhZnRlciB0aGUgYHJlZmAgcGFydC5cbiAgICAgKlxuICAgICAqIFRoaXMgcGFydCBtdXN0IGJlIGVtcHR5LCBhcyBpdHMgY29udGVudHMgYXJlIG5vdCBhdXRvbWF0aWNhbGx5IG1vdmVkLlxuICAgICAqL1xuICAgIGluc2VydEFmdGVyUGFydChyZWYpIHtcbiAgICAgICAgcmVmLl9faW5zZXJ0KHRoaXMuc3RhcnROb2RlID0gY3JlYXRlTWFya2VyKCkpO1xuICAgICAgICB0aGlzLmVuZE5vZGUgPSByZWYuZW5kTm9kZTtcbiAgICAgICAgcmVmLmVuZE5vZGUgPSB0aGlzLnN0YXJ0Tm9kZTtcbiAgICB9XG4gICAgc2V0VmFsdWUodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fX3BlbmRpbmdWYWx1ZSA9IHZhbHVlO1xuICAgIH1cbiAgICBjb21taXQoKSB7XG4gICAgICAgIGlmICh0aGlzLnN0YXJ0Tm9kZS5wYXJlbnROb2RlID09PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgd2hpbGUgKGlzRGlyZWN0aXZlKHRoaXMuX19wZW5kaW5nVmFsdWUpKSB7XG4gICAgICAgICAgICBjb25zdCBkaXJlY3RpdmUgPSB0aGlzLl9fcGVuZGluZ1ZhbHVlO1xuICAgICAgICAgICAgdGhpcy5fX3BlbmRpbmdWYWx1ZSA9IG5vQ2hhbmdlO1xuICAgICAgICAgICAgZGlyZWN0aXZlKHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5fX3BlbmRpbmdWYWx1ZTtcbiAgICAgICAgaWYgKHZhbHVlID09PSBub0NoYW5nZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc1ByaW1pdGl2ZSh2YWx1ZSkpIHtcbiAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gdGhpcy52YWx1ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX19jb21taXRUZXh0KHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFRlbXBsYXRlUmVzdWx0KSB7XG4gICAgICAgICAgICB0aGlzLl9fY29tbWl0VGVtcGxhdGVSZXN1bHQodmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgTm9kZSkge1xuICAgICAgICAgICAgdGhpcy5fX2NvbW1pdE5vZGUodmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGlzSXRlcmFibGUodmFsdWUpKSB7XG4gICAgICAgICAgICB0aGlzLl9fY29tbWl0SXRlcmFibGUodmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlID09PSBub3RoaW5nKSB7XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gbm90aGluZztcbiAgICAgICAgICAgIHRoaXMuY2xlYXIoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIEZhbGxiYWNrLCB3aWxsIHJlbmRlciB0aGUgc3RyaW5nIHJlcHJlc2VudGF0aW9uXG4gICAgICAgICAgICB0aGlzLl9fY29tbWl0VGV4dCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX19pbnNlcnQobm9kZSkge1xuICAgICAgICB0aGlzLmVuZE5vZGUucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobm9kZSwgdGhpcy5lbmROb2RlKTtcbiAgICB9XG4gICAgX19jb21taXROb2RlKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLnZhbHVlID09PSB2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2xlYXIoKTtcbiAgICAgICAgdGhpcy5fX2luc2VydCh2YWx1ZSk7XG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICB9XG4gICAgX19jb21taXRUZXh0KHZhbHVlKSB7XG4gICAgICAgIGNvbnN0IG5vZGUgPSB0aGlzLnN0YXJ0Tm9kZS5uZXh0U2libGluZztcbiAgICAgICAgdmFsdWUgPSB2YWx1ZSA9PSBudWxsID8gJycgOiB2YWx1ZTtcbiAgICAgICAgLy8gSWYgYHZhbHVlYCBpc24ndCBhbHJlYWR5IGEgc3RyaW5nLCB3ZSBleHBsaWNpdGx5IGNvbnZlcnQgaXQgaGVyZSBpbiBjYXNlXG4gICAgICAgIC8vIGl0IGNhbid0IGJlIGltcGxpY2l0bHkgY29udmVydGVkIC0gaS5lLiBpdCdzIGEgc3ltYm9sLlxuICAgICAgICBjb25zdCB2YWx1ZUFzU3RyaW5nID0gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyA/IHZhbHVlIDogU3RyaW5nKHZhbHVlKTtcbiAgICAgICAgaWYgKG5vZGUgPT09IHRoaXMuZW5kTm9kZS5wcmV2aW91c1NpYmxpbmcgJiZcbiAgICAgICAgICAgIG5vZGUubm9kZVR5cGUgPT09IDMgLyogTm9kZS5URVhUX05PREUgKi8pIHtcbiAgICAgICAgICAgIC8vIElmIHdlIG9ubHkgaGF2ZSBhIHNpbmdsZSB0ZXh0IG5vZGUgYmV0d2VlbiB0aGUgbWFya2Vycywgd2UgY2FuIGp1c3RcbiAgICAgICAgICAgIC8vIHNldCBpdHMgdmFsdWUsIHJhdGhlciB0aGFuIHJlcGxhY2luZyBpdC5cbiAgICAgICAgICAgIC8vIFRPRE8oanVzdGluZmFnbmFuaSk6IENhbiB3ZSBqdXN0IGNoZWNrIGlmIHRoaXMudmFsdWUgaXMgcHJpbWl0aXZlP1xuICAgICAgICAgICAgbm9kZS5kYXRhID0gdmFsdWVBc1N0cmluZztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX19jb21taXROb2RlKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHZhbHVlQXNTdHJpbmcpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgfVxuICAgIF9fY29tbWl0VGVtcGxhdGVSZXN1bHQodmFsdWUpIHtcbiAgICAgICAgY29uc3QgdGVtcGxhdGUgPSB0aGlzLm9wdGlvbnMudGVtcGxhdGVGYWN0b3J5KHZhbHVlKTtcbiAgICAgICAgaWYgKHRoaXMudmFsdWUgaW5zdGFuY2VvZiBUZW1wbGF0ZUluc3RhbmNlICYmXG4gICAgICAgICAgICB0aGlzLnZhbHVlLnRlbXBsYXRlID09PSB0ZW1wbGF0ZSkge1xuICAgICAgICAgICAgdGhpcy52YWx1ZS51cGRhdGUodmFsdWUudmFsdWVzKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIE1ha2Ugc3VyZSB3ZSBwcm9wYWdhdGUgdGhlIHRlbXBsYXRlIHByb2Nlc3NvciBmcm9tIHRoZSBUZW1wbGF0ZVJlc3VsdFxuICAgICAgICAgICAgLy8gc28gdGhhdCB3ZSB1c2UgaXRzIHN5bnRheCBleHRlbnNpb24sIGV0Yy4gVGhlIHRlbXBsYXRlIGZhY3RvcnkgY29tZXNcbiAgICAgICAgICAgIC8vIGZyb20gdGhlIHJlbmRlciBmdW5jdGlvbiBvcHRpb25zIHNvIHRoYXQgaXQgY2FuIGNvbnRyb2wgdGVtcGxhdGVcbiAgICAgICAgICAgIC8vIGNhY2hpbmcgYW5kIHByZXByb2Nlc3NpbmcuXG4gICAgICAgICAgICBjb25zdCBpbnN0YW5jZSA9IG5ldyBUZW1wbGF0ZUluc3RhbmNlKHRlbXBsYXRlLCB2YWx1ZS5wcm9jZXNzb3IsIHRoaXMub3B0aW9ucyk7XG4gICAgICAgICAgICBjb25zdCBmcmFnbWVudCA9IGluc3RhbmNlLl9jbG9uZSgpO1xuICAgICAgICAgICAgaW5zdGFuY2UudXBkYXRlKHZhbHVlLnZhbHVlcyk7XG4gICAgICAgICAgICB0aGlzLl9fY29tbWl0Tm9kZShmcmFnbWVudCk7XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gaW5zdGFuY2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX19jb21taXRJdGVyYWJsZSh2YWx1ZSkge1xuICAgICAgICAvLyBGb3IgYW4gSXRlcmFibGUsIHdlIGNyZWF0ZSBhIG5ldyBJbnN0YW5jZVBhcnQgcGVyIGl0ZW0sIHRoZW4gc2V0IGl0c1xuICAgICAgICAvLyB2YWx1ZSB0byB0aGUgaXRlbS4gVGhpcyBpcyBhIGxpdHRsZSBiaXQgb2Ygb3ZlcmhlYWQgZm9yIGV2ZXJ5IGl0ZW0gaW5cbiAgICAgICAgLy8gYW4gSXRlcmFibGUsIGJ1dCBpdCBsZXRzIHVzIHJlY3Vyc2UgZWFzaWx5IGFuZCBlZmZpY2llbnRseSB1cGRhdGUgQXJyYXlzXG4gICAgICAgIC8vIG9mIFRlbXBsYXRlUmVzdWx0cyB0aGF0IHdpbGwgYmUgY29tbW9ubHkgcmV0dXJuZWQgZnJvbSBleHByZXNzaW9ucyBsaWtlOlxuICAgICAgICAvLyBhcnJheS5tYXAoKGkpID0+IGh0bWxgJHtpfWApLCBieSByZXVzaW5nIGV4aXN0aW5nIFRlbXBsYXRlSW5zdGFuY2VzLlxuICAgICAgICAvLyBJZiBfdmFsdWUgaXMgYW4gYXJyYXksIHRoZW4gdGhlIHByZXZpb3VzIHJlbmRlciB3YXMgb2YgYW5cbiAgICAgICAgLy8gaXRlcmFibGUgYW5kIF92YWx1ZSB3aWxsIGNvbnRhaW4gdGhlIE5vZGVQYXJ0cyBmcm9tIHRoZSBwcmV2aW91c1xuICAgICAgICAvLyByZW5kZXIuIElmIF92YWx1ZSBpcyBub3QgYW4gYXJyYXksIGNsZWFyIHRoaXMgcGFydCBhbmQgbWFrZSBhIG5ld1xuICAgICAgICAvLyBhcnJheSBmb3IgTm9kZVBhcnRzLlxuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodGhpcy52YWx1ZSkpIHtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuY2xlYXIoKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBMZXRzIHVzIGtlZXAgdHJhY2sgb2YgaG93IG1hbnkgaXRlbXMgd2Ugc3RhbXBlZCBzbyB3ZSBjYW4gY2xlYXIgbGVmdG92ZXJcbiAgICAgICAgLy8gaXRlbXMgZnJvbSBhIHByZXZpb3VzIHJlbmRlclxuICAgICAgICBjb25zdCBpdGVtUGFydHMgPSB0aGlzLnZhbHVlO1xuICAgICAgICBsZXQgcGFydEluZGV4ID0gMDtcbiAgICAgICAgbGV0IGl0ZW1QYXJ0O1xuICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgdmFsdWUpIHtcbiAgICAgICAgICAgIC8vIFRyeSB0byByZXVzZSBhbiBleGlzdGluZyBwYXJ0XG4gICAgICAgICAgICBpdGVtUGFydCA9IGl0ZW1QYXJ0c1twYXJ0SW5kZXhdO1xuICAgICAgICAgICAgLy8gSWYgbm8gZXhpc3RpbmcgcGFydCwgY3JlYXRlIGEgbmV3IG9uZVxuICAgICAgICAgICAgaWYgKGl0ZW1QYXJ0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBpdGVtUGFydCA9IG5ldyBOb2RlUGFydCh0aGlzLm9wdGlvbnMpO1xuICAgICAgICAgICAgICAgIGl0ZW1QYXJ0cy5wdXNoKGl0ZW1QYXJ0KTtcbiAgICAgICAgICAgICAgICBpZiAocGFydEluZGV4ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW1QYXJ0LmFwcGVuZEludG9QYXJ0KHRoaXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaXRlbVBhcnQuaW5zZXJ0QWZ0ZXJQYXJ0KGl0ZW1QYXJ0c1twYXJ0SW5kZXggLSAxXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaXRlbVBhcnQuc2V0VmFsdWUoaXRlbSk7XG4gICAgICAgICAgICBpdGVtUGFydC5jb21taXQoKTtcbiAgICAgICAgICAgIHBhcnRJbmRleCsrO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJ0SW5kZXggPCBpdGVtUGFydHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAvLyBUcnVuY2F0ZSB0aGUgcGFydHMgYXJyYXkgc28gX3ZhbHVlIHJlZmxlY3RzIHRoZSBjdXJyZW50IHN0YXRlXG4gICAgICAgICAgICBpdGVtUGFydHMubGVuZ3RoID0gcGFydEluZGV4O1xuICAgICAgICAgICAgdGhpcy5jbGVhcihpdGVtUGFydCAmJiBpdGVtUGFydC5lbmROb2RlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjbGVhcihzdGFydE5vZGUgPSB0aGlzLnN0YXJ0Tm9kZSkge1xuICAgICAgICByZW1vdmVOb2Rlcyh0aGlzLnN0YXJ0Tm9kZS5wYXJlbnROb2RlLCBzdGFydE5vZGUubmV4dFNpYmxpbmcsIHRoaXMuZW5kTm9kZSk7XG4gICAgfVxufVxuLyoqXG4gKiBJbXBsZW1lbnRzIGEgYm9vbGVhbiBhdHRyaWJ1dGUsIHJvdWdobHkgYXMgZGVmaW5lZCBpbiB0aGUgSFRNTFxuICogc3BlY2lmaWNhdGlvbi5cbiAqXG4gKiBJZiB0aGUgdmFsdWUgaXMgdHJ1dGh5LCB0aGVuIHRoZSBhdHRyaWJ1dGUgaXMgcHJlc2VudCB3aXRoIGEgdmFsdWUgb2ZcbiAqICcnLiBJZiB0aGUgdmFsdWUgaXMgZmFsc2V5LCB0aGUgYXR0cmlidXRlIGlzIHJlbW92ZWQuXG4gKi9cbmV4cG9ydCBjbGFzcyBCb29sZWFuQXR0cmlidXRlUGFydCB7XG4gICAgY29uc3RydWN0b3IoZWxlbWVudCwgbmFtZSwgc3RyaW5ncykge1xuICAgICAgICB0aGlzLnZhbHVlID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLl9fcGVuZGluZ1ZhbHVlID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAoc3RyaW5ncy5sZW5ndGggIT09IDIgfHwgc3RyaW5nc1swXSAhPT0gJycgfHwgc3RyaW5nc1sxXSAhPT0gJycpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQm9vbGVhbiBhdHRyaWJ1dGVzIGNhbiBvbmx5IGNvbnRhaW4gYSBzaW5nbGUgZXhwcmVzc2lvbicpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMuc3RyaW5ncyA9IHN0cmluZ3M7XG4gICAgfVxuICAgIHNldFZhbHVlKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX19wZW5kaW5nVmFsdWUgPSB2YWx1ZTtcbiAgICB9XG4gICAgY29tbWl0KCkge1xuICAgICAgICB3aGlsZSAoaXNEaXJlY3RpdmUodGhpcy5fX3BlbmRpbmdWYWx1ZSkpIHtcbiAgICAgICAgICAgIGNvbnN0IGRpcmVjdGl2ZSA9IHRoaXMuX19wZW5kaW5nVmFsdWU7XG4gICAgICAgICAgICB0aGlzLl9fcGVuZGluZ1ZhbHVlID0gbm9DaGFuZ2U7XG4gICAgICAgICAgICBkaXJlY3RpdmUodGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX19wZW5kaW5nVmFsdWUgPT09IG5vQ2hhbmdlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdmFsdWUgPSAhIXRoaXMuX19wZW5kaW5nVmFsdWU7XG4gICAgICAgIGlmICh0aGlzLnZhbHVlICE9PSB2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZSh0aGlzLm5hbWUsICcnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUodGhpcy5uYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9fcGVuZGluZ1ZhbHVlID0gbm9DaGFuZ2U7XG4gICAgfVxufVxuLyoqXG4gKiBTZXRzIGF0dHJpYnV0ZSB2YWx1ZXMgZm9yIFByb3BlcnR5UGFydHMsIHNvIHRoYXQgdGhlIHZhbHVlIGlzIG9ubHkgc2V0IG9uY2VcbiAqIGV2ZW4gaWYgdGhlcmUgYXJlIG11bHRpcGxlIHBhcnRzIGZvciBhIHByb3BlcnR5LlxuICpcbiAqIElmIGFuIGV4cHJlc3Npb24gY29udHJvbHMgdGhlIHdob2xlIHByb3BlcnR5IHZhbHVlLCB0aGVuIHRoZSB2YWx1ZSBpcyBzaW1wbHlcbiAqIGFzc2lnbmVkIHRvIHRoZSBwcm9wZXJ0eSB1bmRlciBjb250cm9sLiBJZiB0aGVyZSBhcmUgc3RyaW5nIGxpdGVyYWxzIG9yXG4gKiBtdWx0aXBsZSBleHByZXNzaW9ucywgdGhlbiB0aGUgc3RyaW5ncyBhcmUgZXhwcmVzc2lvbnMgYXJlIGludGVycG9sYXRlZCBpbnRvXG4gKiBhIHN0cmluZyBmaXJzdC5cbiAqL1xuZXhwb3J0IGNsYXNzIFByb3BlcnR5Q29tbWl0dGVyIGV4dGVuZHMgQXR0cmlidXRlQ29tbWl0dGVyIHtcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50LCBuYW1lLCBzdHJpbmdzKSB7XG4gICAgICAgIHN1cGVyKGVsZW1lbnQsIG5hbWUsIHN0cmluZ3MpO1xuICAgICAgICB0aGlzLnNpbmdsZSA9XG4gICAgICAgICAgICAoc3RyaW5ncy5sZW5ndGggPT09IDIgJiYgc3RyaW5nc1swXSA9PT0gJycgJiYgc3RyaW5nc1sxXSA9PT0gJycpO1xuICAgIH1cbiAgICBfY3JlYXRlUGFydCgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9wZXJ0eVBhcnQodGhpcyk7XG4gICAgfVxuICAgIF9nZXRWYWx1ZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuc2luZ2xlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJ0c1swXS52YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3VwZXIuX2dldFZhbHVlKCk7XG4gICAgfVxuICAgIGNvbW1pdCgpIHtcbiAgICAgICAgaWYgKHRoaXMuZGlydHkpIHtcbiAgICAgICAgICAgIHRoaXMuZGlydHkgPSBmYWxzZTtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnRbdGhpcy5uYW1lXSA9IHRoaXMuX2dldFZhbHVlKCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5leHBvcnQgY2xhc3MgUHJvcGVydHlQYXJ0IGV4dGVuZHMgQXR0cmlidXRlUGFydCB7XG59XG4vLyBEZXRlY3QgZXZlbnQgbGlzdGVuZXIgb3B0aW9ucyBzdXBwb3J0LiBJZiB0aGUgYGNhcHR1cmVgIHByb3BlcnR5IGlzIHJlYWRcbi8vIGZyb20gdGhlIG9wdGlvbnMgb2JqZWN0LCB0aGVuIG9wdGlvbnMgYXJlIHN1cHBvcnRlZC4gSWYgbm90LCB0aGVuIHRoZSB0aGlyZFxuLy8gYXJndW1lbnQgdG8gYWRkL3JlbW92ZUV2ZW50TGlzdGVuZXIgaXMgaW50ZXJwcmV0ZWQgYXMgdGhlIGJvb2xlYW4gY2FwdHVyZVxuLy8gdmFsdWUgc28gd2Ugc2hvdWxkIG9ubHkgcGFzcyB0aGUgYGNhcHR1cmVgIHByb3BlcnR5LlxubGV0IGV2ZW50T3B0aW9uc1N1cHBvcnRlZCA9IGZhbHNlO1xuLy8gV3JhcCBpbnRvIGFuIElJRkUgYmVjYXVzZSBNUyBFZGdlIDw9IHY0MSBkb2VzIG5vdCBzdXBwb3J0IGhhdmluZyB0cnkvY2F0Y2hcbi8vIGJsb2NrcyByaWdodCBpbnRvIHRoZSBib2R5IG9mIGEgbW9kdWxlXG4oKCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICAgICAgICBnZXQgY2FwdHVyZSgpIHtcbiAgICAgICAgICAgICAgICBldmVudE9wdGlvbnNTdXBwb3J0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Rlc3QnLCBvcHRpb25zLCBvcHRpb25zKTtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Rlc3QnLCBvcHRpb25zLCBvcHRpb25zKTtcbiAgICB9XG4gICAgY2F0Y2ggKF9lKSB7XG4gICAgICAgIC8vIGV2ZW50IG9wdGlvbnMgbm90IHN1cHBvcnRlZFxuICAgIH1cbn0pKCk7XG5leHBvcnQgY2xhc3MgRXZlbnRQYXJ0IHtcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50LCBldmVudE5hbWUsIGV2ZW50Q29udGV4dCkge1xuICAgICAgICB0aGlzLnZhbHVlID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLl9fcGVuZGluZ1ZhbHVlID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgICAgICB0aGlzLmV2ZW50TmFtZSA9IGV2ZW50TmFtZTtcbiAgICAgICAgdGhpcy5ldmVudENvbnRleHQgPSBldmVudENvbnRleHQ7XG4gICAgICAgIHRoaXMuX19ib3VuZEhhbmRsZUV2ZW50ID0gKGUpID0+IHRoaXMuaGFuZGxlRXZlbnQoZSk7XG4gICAgfVxuICAgIHNldFZhbHVlKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX19wZW5kaW5nVmFsdWUgPSB2YWx1ZTtcbiAgICB9XG4gICAgY29tbWl0KCkge1xuICAgICAgICB3aGlsZSAoaXNEaXJlY3RpdmUodGhpcy5fX3BlbmRpbmdWYWx1ZSkpIHtcbiAgICAgICAgICAgIGNvbnN0IGRpcmVjdGl2ZSA9IHRoaXMuX19wZW5kaW5nVmFsdWU7XG4gICAgICAgICAgICB0aGlzLl9fcGVuZGluZ1ZhbHVlID0gbm9DaGFuZ2U7XG4gICAgICAgICAgICBkaXJlY3RpdmUodGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX19wZW5kaW5nVmFsdWUgPT09IG5vQ2hhbmdlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbmV3TGlzdGVuZXIgPSB0aGlzLl9fcGVuZGluZ1ZhbHVlO1xuICAgICAgICBjb25zdCBvbGRMaXN0ZW5lciA9IHRoaXMudmFsdWU7XG4gICAgICAgIGNvbnN0IHNob3VsZFJlbW92ZUxpc3RlbmVyID0gbmV3TGlzdGVuZXIgPT0gbnVsbCB8fFxuICAgICAgICAgICAgb2xkTGlzdGVuZXIgIT0gbnVsbCAmJlxuICAgICAgICAgICAgICAgIChuZXdMaXN0ZW5lci5jYXB0dXJlICE9PSBvbGRMaXN0ZW5lci5jYXB0dXJlIHx8XG4gICAgICAgICAgICAgICAgICAgIG5ld0xpc3RlbmVyLm9uY2UgIT09IG9sZExpc3RlbmVyLm9uY2UgfHxcbiAgICAgICAgICAgICAgICAgICAgbmV3TGlzdGVuZXIucGFzc2l2ZSAhPT0gb2xkTGlzdGVuZXIucGFzc2l2ZSk7XG4gICAgICAgIGNvbnN0IHNob3VsZEFkZExpc3RlbmVyID0gbmV3TGlzdGVuZXIgIT0gbnVsbCAmJiAob2xkTGlzdGVuZXIgPT0gbnVsbCB8fCBzaG91bGRSZW1vdmVMaXN0ZW5lcik7XG4gICAgICAgIGlmIChzaG91bGRSZW1vdmVMaXN0ZW5lcikge1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIodGhpcy5ldmVudE5hbWUsIHRoaXMuX19ib3VuZEhhbmRsZUV2ZW50LCB0aGlzLl9fb3B0aW9ucyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNob3VsZEFkZExpc3RlbmVyKSB7XG4gICAgICAgICAgICB0aGlzLl9fb3B0aW9ucyA9IGdldE9wdGlvbnMobmV3TGlzdGVuZXIpO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIodGhpcy5ldmVudE5hbWUsIHRoaXMuX19ib3VuZEhhbmRsZUV2ZW50LCB0aGlzLl9fb3B0aW9ucyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy52YWx1ZSA9IG5ld0xpc3RlbmVyO1xuICAgICAgICB0aGlzLl9fcGVuZGluZ1ZhbHVlID0gbm9DaGFuZ2U7XG4gICAgfVxuICAgIGhhbmRsZUV2ZW50KGV2ZW50KSB7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy52YWx1ZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgdGhpcy52YWx1ZS5jYWxsKHRoaXMuZXZlbnRDb250ZXh0IHx8IHRoaXMuZWxlbWVudCwgZXZlbnQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy52YWx1ZS5oYW5kbGVFdmVudChldmVudCk7XG4gICAgICAgIH1cbiAgICB9XG59XG4vLyBXZSBjb3B5IG9wdGlvbnMgYmVjYXVzZSBvZiB0aGUgaW5jb25zaXN0ZW50IGJlaGF2aW9yIG9mIGJyb3dzZXJzIHdoZW4gcmVhZGluZ1xuLy8gdGhlIHRoaXJkIGFyZ3VtZW50IG9mIGFkZC9yZW1vdmVFdmVudExpc3RlbmVyLiBJRTExIGRvZXNuJ3Qgc3VwcG9ydCBvcHRpb25zXG4vLyBhdCBhbGwuIENocm9tZSA0MSBvbmx5IHJlYWRzIGBjYXB0dXJlYCBpZiB0aGUgYXJndW1lbnQgaXMgYW4gb2JqZWN0LlxuY29uc3QgZ2V0T3B0aW9ucyA9IChvKSA9PiBvICYmXG4gICAgKGV2ZW50T3B0aW9uc1N1cHBvcnRlZCA/XG4gICAgICAgIHsgY2FwdHVyZTogby5jYXB0dXJlLCBwYXNzaXZlOiBvLnBhc3NpdmUsIG9uY2U6IG8ub25jZSB9IDpcbiAgICAgICAgby5jYXB0dXJlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhcnRzLmpzLm1hcCIsIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAoYykgMjAxNyBUaGUgUG9seW1lciBQcm9qZWN0IEF1dGhvcnMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiBUaGlzIGNvZGUgbWF5IG9ubHkgYmUgdXNlZCB1bmRlciB0aGUgQlNEIHN0eWxlIGxpY2Vuc2UgZm91bmQgYXRcbiAqIGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9MSUNFTlNFLnR4dFxuICogVGhlIGNvbXBsZXRlIHNldCBvZiBhdXRob3JzIG1heSBiZSBmb3VuZCBhdFxuICogaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0FVVEhPUlMudHh0XG4gKiBUaGUgY29tcGxldGUgc2V0IG9mIGNvbnRyaWJ1dG9ycyBtYXkgYmUgZm91bmQgYXRcbiAqIGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9DT05UUklCVVRPUlMudHh0XG4gKiBDb2RlIGRpc3RyaWJ1dGVkIGJ5IEdvb2dsZSBhcyBwYXJ0IG9mIHRoZSBwb2x5bWVyIHByb2plY3QgaXMgYWxzb1xuICogc3ViamVjdCB0byBhbiBhZGRpdGlvbmFsIElQIHJpZ2h0cyBncmFudCBmb3VuZCBhdFxuICogaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL1BBVEVOVFMudHh0XG4gKi9cbmltcG9ydCB7IG1hcmtlciwgVGVtcGxhdGUgfSBmcm9tICcuL3RlbXBsYXRlLmpzJztcbi8qKlxuICogVGhlIGRlZmF1bHQgVGVtcGxhdGVGYWN0b3J5IHdoaWNoIGNhY2hlcyBUZW1wbGF0ZXMga2V5ZWQgb25cbiAqIHJlc3VsdC50eXBlIGFuZCByZXN1bHQuc3RyaW5ncy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRlbXBsYXRlRmFjdG9yeShyZXN1bHQpIHtcbiAgICBsZXQgdGVtcGxhdGVDYWNoZSA9IHRlbXBsYXRlQ2FjaGVzLmdldChyZXN1bHQudHlwZSk7XG4gICAgaWYgKHRlbXBsYXRlQ2FjaGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0ZW1wbGF0ZUNhY2hlID0ge1xuICAgICAgICAgICAgc3RyaW5nc0FycmF5OiBuZXcgV2Vha01hcCgpLFxuICAgICAgICAgICAga2V5U3RyaW5nOiBuZXcgTWFwKClcbiAgICAgICAgfTtcbiAgICAgICAgdGVtcGxhdGVDYWNoZXMuc2V0KHJlc3VsdC50eXBlLCB0ZW1wbGF0ZUNhY2hlKTtcbiAgICB9XG4gICAgbGV0IHRlbXBsYXRlID0gdGVtcGxhdGVDYWNoZS5zdHJpbmdzQXJyYXkuZ2V0KHJlc3VsdC5zdHJpbmdzKTtcbiAgICBpZiAodGVtcGxhdGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gdGVtcGxhdGU7XG4gICAgfVxuICAgIC8vIElmIHRoZSBUZW1wbGF0ZVN0cmluZ3NBcnJheSBpcyBuZXcsIGdlbmVyYXRlIGEga2V5IGZyb20gdGhlIHN0cmluZ3NcbiAgICAvLyBUaGlzIGtleSBpcyBzaGFyZWQgYmV0d2VlbiBhbGwgdGVtcGxhdGVzIHdpdGggaWRlbnRpY2FsIGNvbnRlbnRcbiAgICBjb25zdCBrZXkgPSByZXN1bHQuc3RyaW5ncy5qb2luKG1hcmtlcik7XG4gICAgLy8gQ2hlY2sgaWYgd2UgYWxyZWFkeSBoYXZlIGEgVGVtcGxhdGUgZm9yIHRoaXMga2V5XG4gICAgdGVtcGxhdGUgPSB0ZW1wbGF0ZUNhY2hlLmtleVN0cmluZy5nZXQoa2V5KTtcbiAgICBpZiAodGVtcGxhdGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAvLyBJZiB3ZSBoYXZlIG5vdCBzZWVuIHRoaXMga2V5IGJlZm9yZSwgY3JlYXRlIGEgbmV3IFRlbXBsYXRlXG4gICAgICAgIHRlbXBsYXRlID0gbmV3IFRlbXBsYXRlKHJlc3VsdCwgcmVzdWx0LmdldFRlbXBsYXRlRWxlbWVudCgpKTtcbiAgICAgICAgLy8gQ2FjaGUgdGhlIFRlbXBsYXRlIGZvciB0aGlzIGtleVxuICAgICAgICB0ZW1wbGF0ZUNhY2hlLmtleVN0cmluZy5zZXQoa2V5LCB0ZW1wbGF0ZSk7XG4gICAgfVxuICAgIC8vIENhY2hlIGFsbCBmdXR1cmUgcXVlcmllcyBmb3IgdGhpcyBUZW1wbGF0ZVN0cmluZ3NBcnJheVxuICAgIHRlbXBsYXRlQ2FjaGUuc3RyaW5nc0FycmF5LnNldChyZXN1bHQuc3RyaW5ncywgdGVtcGxhdGUpO1xuICAgIHJldHVybiB0ZW1wbGF0ZTtcbn1cbmV4cG9ydCBjb25zdCB0ZW1wbGF0ZUNhY2hlcyA9IG5ldyBNYXAoKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRlbXBsYXRlLWZhY3RvcnkuanMubWFwIiwiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IChjKSAyMDE3IFRoZSBQb2x5bWVyIFByb2plY3QgQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqIFRoaXMgY29kZSBtYXkgb25seSBiZSB1c2VkIHVuZGVyIHRoZSBCU0Qgc3R5bGUgbGljZW5zZSBmb3VuZCBhdFxuICogaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0xJQ0VOU0UudHh0XG4gKiBUaGUgY29tcGxldGUgc2V0IG9mIGF1dGhvcnMgbWF5IGJlIGZvdW5kIGF0XG4gKiBodHRwOi8vcG9seW1lci5naXRodWIuaW8vQVVUSE9SUy50eHRcbiAqIFRoZSBjb21wbGV0ZSBzZXQgb2YgY29udHJpYnV0b3JzIG1heSBiZSBmb3VuZCBhdFxuICogaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0NPTlRSSUJVVE9SUy50eHRcbiAqIENvZGUgZGlzdHJpYnV0ZWQgYnkgR29vZ2xlIGFzIHBhcnQgb2YgdGhlIHBvbHltZXIgcHJvamVjdCBpcyBhbHNvXG4gKiBzdWJqZWN0IHRvIGFuIGFkZGl0aW9uYWwgSVAgcmlnaHRzIGdyYW50IGZvdW5kIGF0XG4gKiBodHRwOi8vcG9seW1lci5naXRodWIuaW8vUEFURU5UUy50eHRcbiAqL1xuLyoqXG4gKiBAbW9kdWxlIGxpdC1odG1sXG4gKi9cbmltcG9ydCB7IHJlbW92ZU5vZGVzIH0gZnJvbSAnLi9kb20uanMnO1xuaW1wb3J0IHsgTm9kZVBhcnQgfSBmcm9tICcuL3BhcnRzLmpzJztcbmltcG9ydCB7IHRlbXBsYXRlRmFjdG9yeSB9IGZyb20gJy4vdGVtcGxhdGUtZmFjdG9yeS5qcyc7XG5leHBvcnQgY29uc3QgcGFydHMgPSBuZXcgV2Vha01hcCgpO1xuLyoqXG4gKiBSZW5kZXJzIGEgdGVtcGxhdGUgcmVzdWx0IG9yIG90aGVyIHZhbHVlIHRvIGEgY29udGFpbmVyLlxuICpcbiAqIFRvIHVwZGF0ZSBhIGNvbnRhaW5lciB3aXRoIG5ldyB2YWx1ZXMsIHJlZXZhbHVhdGUgdGhlIHRlbXBsYXRlIGxpdGVyYWwgYW5kXG4gKiBjYWxsIGByZW5kZXJgIHdpdGggdGhlIG5ldyByZXN1bHQuXG4gKlxuICogQHBhcmFtIHJlc3VsdCBBbnkgdmFsdWUgcmVuZGVyYWJsZSBieSBOb2RlUGFydCAtIHR5cGljYWxseSBhIFRlbXBsYXRlUmVzdWx0XG4gKiAgICAgY3JlYXRlZCBieSBldmFsdWF0aW5nIGEgdGVtcGxhdGUgdGFnIGxpa2UgYGh0bWxgIG9yIGBzdmdgLlxuICogQHBhcmFtIGNvbnRhaW5lciBBIERPTSBwYXJlbnQgdG8gcmVuZGVyIHRvLiBUaGUgZW50aXJlIGNvbnRlbnRzIGFyZSBlaXRoZXJcbiAqICAgICByZXBsYWNlZCwgb3IgZWZmaWNpZW50bHkgdXBkYXRlZCBpZiB0aGUgc2FtZSByZXN1bHQgdHlwZSB3YXMgcHJldmlvdXNcbiAqICAgICByZW5kZXJlZCB0aGVyZS5cbiAqIEBwYXJhbSBvcHRpb25zIFJlbmRlck9wdGlvbnMgZm9yIHRoZSBlbnRpcmUgcmVuZGVyIHRyZWUgcmVuZGVyZWQgdG8gdGhpc1xuICogICAgIGNvbnRhaW5lci4gUmVuZGVyIG9wdGlvbnMgbXVzdCAqbm90KiBjaGFuZ2UgYmV0d2VlbiByZW5kZXJzIHRvIHRoZSBzYW1lXG4gKiAgICAgY29udGFpbmVyLCBhcyB0aG9zZSBjaGFuZ2VzIHdpbGwgbm90IGVmZmVjdCBwcmV2aW91c2x5IHJlbmRlcmVkIERPTS5cbiAqL1xuZXhwb3J0IGNvbnN0IHJlbmRlciA9IChyZXN1bHQsIGNvbnRhaW5lciwgb3B0aW9ucykgPT4ge1xuICAgIGxldCBwYXJ0ID0gcGFydHMuZ2V0KGNvbnRhaW5lcik7XG4gICAgaWYgKHBhcnQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZW1vdmVOb2Rlcyhjb250YWluZXIsIGNvbnRhaW5lci5maXJzdENoaWxkKTtcbiAgICAgICAgcGFydHMuc2V0KGNvbnRhaW5lciwgcGFydCA9IG5ldyBOb2RlUGFydChPYmplY3QuYXNzaWduKHsgdGVtcGxhdGVGYWN0b3J5IH0sIG9wdGlvbnMpKSk7XG4gICAgICAgIHBhcnQuYXBwZW5kSW50byhjb250YWluZXIpO1xuICAgIH1cbiAgICBwYXJ0LnNldFZhbHVlKHJlc3VsdCk7XG4gICAgcGFydC5jb21taXQoKTtcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1yZW5kZXIuanMubWFwIiwiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IChjKSAyMDE3IFRoZSBQb2x5bWVyIFByb2plY3QgQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqIFRoaXMgY29kZSBtYXkgb25seSBiZSB1c2VkIHVuZGVyIHRoZSBCU0Qgc3R5bGUgbGljZW5zZSBmb3VuZCBhdFxuICogaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0xJQ0VOU0UudHh0XG4gKiBUaGUgY29tcGxldGUgc2V0IG9mIGF1dGhvcnMgbWF5IGJlIGZvdW5kIGF0XG4gKiBodHRwOi8vcG9seW1lci5naXRodWIuaW8vQVVUSE9SUy50eHRcbiAqIFRoZSBjb21wbGV0ZSBzZXQgb2YgY29udHJpYnV0b3JzIG1heSBiZSBmb3VuZCBhdFxuICogaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0NPTlRSSUJVVE9SUy50eHRcbiAqIENvZGUgZGlzdHJpYnV0ZWQgYnkgR29vZ2xlIGFzIHBhcnQgb2YgdGhlIHBvbHltZXIgcHJvamVjdCBpcyBhbHNvXG4gKiBzdWJqZWN0IHRvIGFuIGFkZGl0aW9uYWwgSVAgcmlnaHRzIGdyYW50IGZvdW5kIGF0XG4gKiBodHRwOi8vcG9seW1lci5naXRodWIuaW8vUEFURU5UUy50eHRcbiAqL1xuaW1wb3J0IHsgQXR0cmlidXRlQ29tbWl0dGVyLCBCb29sZWFuQXR0cmlidXRlUGFydCwgRXZlbnRQYXJ0LCBOb2RlUGFydCwgUHJvcGVydHlDb21taXR0ZXIgfSBmcm9tICcuL3BhcnRzLmpzJztcbi8qKlxuICogQ3JlYXRlcyBQYXJ0cyB3aGVuIGEgdGVtcGxhdGUgaXMgaW5zdGFudGlhdGVkLlxuICovXG5leHBvcnQgY2xhc3MgRGVmYXVsdFRlbXBsYXRlUHJvY2Vzc29yIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGUgcGFydHMgZm9yIGFuIGF0dHJpYnV0ZS1wb3NpdGlvbiBiaW5kaW5nLCBnaXZlbiB0aGUgZXZlbnQsIGF0dHJpYnV0ZVxuICAgICAqIG5hbWUsIGFuZCBzdHJpbmcgbGl0ZXJhbHMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZWxlbWVudCBUaGUgZWxlbWVudCBjb250YWluaW5nIHRoZSBiaW5kaW5nXG4gICAgICogQHBhcmFtIG5hbWUgIFRoZSBhdHRyaWJ1dGUgbmFtZVxuICAgICAqIEBwYXJhbSBzdHJpbmdzIFRoZSBzdHJpbmcgbGl0ZXJhbHMuIFRoZXJlIGFyZSBhbHdheXMgYXQgbGVhc3QgdHdvIHN0cmluZ3MsXG4gICAgICogICBldmVudCBmb3IgZnVsbHktY29udHJvbGxlZCBiaW5kaW5ncyB3aXRoIGEgc2luZ2xlIGV4cHJlc3Npb24uXG4gICAgICovXG4gICAgaGFuZGxlQXR0cmlidXRlRXhwcmVzc2lvbnMoZWxlbWVudCwgbmFtZSwgc3RyaW5ncywgb3B0aW9ucykge1xuICAgICAgICBjb25zdCBwcmVmaXggPSBuYW1lWzBdO1xuICAgICAgICBpZiAocHJlZml4ID09PSAnLicpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbW1pdHRlciA9IG5ldyBQcm9wZXJ0eUNvbW1pdHRlcihlbGVtZW50LCBuYW1lLnNsaWNlKDEpLCBzdHJpbmdzKTtcbiAgICAgICAgICAgIHJldHVybiBjb21taXR0ZXIucGFydHM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHByZWZpeCA9PT0gJ0AnKSB7XG4gICAgICAgICAgICByZXR1cm4gW25ldyBFdmVudFBhcnQoZWxlbWVudCwgbmFtZS5zbGljZSgxKSwgb3B0aW9ucy5ldmVudENvbnRleHQpXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocHJlZml4ID09PSAnPycpIHtcbiAgICAgICAgICAgIHJldHVybiBbbmV3IEJvb2xlYW5BdHRyaWJ1dGVQYXJ0KGVsZW1lbnQsIG5hbWUuc2xpY2UoMSksIHN0cmluZ3MpXTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjb21taXR0ZXIgPSBuZXcgQXR0cmlidXRlQ29tbWl0dGVyKGVsZW1lbnQsIG5hbWUsIHN0cmluZ3MpO1xuICAgICAgICByZXR1cm4gY29tbWl0dGVyLnBhcnRzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgcGFydHMgZm9yIGEgdGV4dC1wb3NpdGlvbiBiaW5kaW5nLlxuICAgICAqIEBwYXJhbSB0ZW1wbGF0ZUZhY3RvcnlcbiAgICAgKi9cbiAgICBoYW5kbGVUZXh0RXhwcmVzc2lvbihvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiBuZXcgTm9kZVBhcnQob3B0aW9ucyk7XG4gICAgfVxufVxuZXhwb3J0IGNvbnN0IGRlZmF1bHRUZW1wbGF0ZVByb2Nlc3NvciA9IG5ldyBEZWZhdWx0VGVtcGxhdGVQcm9jZXNzb3IoKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRlZmF1bHQtdGVtcGxhdGUtcHJvY2Vzc29yLmpzLm1hcCIsIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAoYykgMjAxNyBUaGUgUG9seW1lciBQcm9qZWN0IEF1dGhvcnMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiBUaGlzIGNvZGUgbWF5IG9ubHkgYmUgdXNlZCB1bmRlciB0aGUgQlNEIHN0eWxlIGxpY2Vuc2UgZm91bmQgYXRcbiAqIGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9MSUNFTlNFLnR4dFxuICogVGhlIGNvbXBsZXRlIHNldCBvZiBhdXRob3JzIG1heSBiZSBmb3VuZCBhdFxuICogaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0FVVEhPUlMudHh0XG4gKiBUaGUgY29tcGxldGUgc2V0IG9mIGNvbnRyaWJ1dG9ycyBtYXkgYmUgZm91bmQgYXRcbiAqIGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9DT05UUklCVVRPUlMudHh0XG4gKiBDb2RlIGRpc3RyaWJ1dGVkIGJ5IEdvb2dsZSBhcyBwYXJ0IG9mIHRoZSBwb2x5bWVyIHByb2plY3QgaXMgYWxzb1xuICogc3ViamVjdCB0byBhbiBhZGRpdGlvbmFsIElQIHJpZ2h0cyBncmFudCBmb3VuZCBhdFxuICogaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL1BBVEVOVFMudHh0XG4gKi9cbi8qKlxuICpcbiAqIE1haW4gbGl0LWh0bWwgbW9kdWxlLlxuICpcbiAqIE1haW4gZXhwb3J0czpcbiAqXG4gKiAtICBbW2h0bWxdXVxuICogLSAgW1tzdmddXVxuICogLSAgW1tyZW5kZXJdXVxuICpcbiAqIEBtb2R1bGUgbGl0LWh0bWxcbiAqIEBwcmVmZXJyZWRcbiAqL1xuLyoqXG4gKiBEbyBub3QgcmVtb3ZlIHRoaXMgY29tbWVudDsgaXQga2VlcHMgdHlwZWRvYyBmcm9tIG1pc3BsYWNpbmcgdGhlIG1vZHVsZVxuICogZG9jcy5cbiAqL1xuaW1wb3J0IHsgZGVmYXVsdFRlbXBsYXRlUHJvY2Vzc29yIH0gZnJvbSAnLi9saWIvZGVmYXVsdC10ZW1wbGF0ZS1wcm9jZXNzb3IuanMnO1xuaW1wb3J0IHsgU1ZHVGVtcGxhdGVSZXN1bHQsIFRlbXBsYXRlUmVzdWx0IH0gZnJvbSAnLi9saWIvdGVtcGxhdGUtcmVzdWx0LmpzJztcbmV4cG9ydCB7IERlZmF1bHRUZW1wbGF0ZVByb2Nlc3NvciwgZGVmYXVsdFRlbXBsYXRlUHJvY2Vzc29yIH0gZnJvbSAnLi9saWIvZGVmYXVsdC10ZW1wbGF0ZS1wcm9jZXNzb3IuanMnO1xuZXhwb3J0IHsgZGlyZWN0aXZlLCBpc0RpcmVjdGl2ZSB9IGZyb20gJy4vbGliL2RpcmVjdGl2ZS5qcyc7XG4vLyBUT0RPKGp1c3RpbmZhZ25hbmkpOiByZW1vdmUgbGluZSB3aGVuIHdlIGdldCBOb2RlUGFydCBtb3ZpbmcgbWV0aG9kc1xuZXhwb3J0IHsgcmVtb3ZlTm9kZXMsIHJlcGFyZW50Tm9kZXMgfSBmcm9tICcuL2xpYi9kb20uanMnO1xuZXhwb3J0IHsgbm9DaGFuZ2UsIG5vdGhpbmcgfSBmcm9tICcuL2xpYi9wYXJ0LmpzJztcbmV4cG9ydCB7IEF0dHJpYnV0ZUNvbW1pdHRlciwgQXR0cmlidXRlUGFydCwgQm9vbGVhbkF0dHJpYnV0ZVBhcnQsIEV2ZW50UGFydCwgaXNJdGVyYWJsZSwgaXNQcmltaXRpdmUsIE5vZGVQYXJ0LCBQcm9wZXJ0eUNvbW1pdHRlciwgUHJvcGVydHlQYXJ0IH0gZnJvbSAnLi9saWIvcGFydHMuanMnO1xuZXhwb3J0IHsgcGFydHMsIHJlbmRlciB9IGZyb20gJy4vbGliL3JlbmRlci5qcyc7XG5leHBvcnQgeyB0ZW1wbGF0ZUNhY2hlcywgdGVtcGxhdGVGYWN0b3J5IH0gZnJvbSAnLi9saWIvdGVtcGxhdGUtZmFjdG9yeS5qcyc7XG5leHBvcnQgeyBUZW1wbGF0ZUluc3RhbmNlIH0gZnJvbSAnLi9saWIvdGVtcGxhdGUtaW5zdGFuY2UuanMnO1xuZXhwb3J0IHsgU1ZHVGVtcGxhdGVSZXN1bHQsIFRlbXBsYXRlUmVzdWx0IH0gZnJvbSAnLi9saWIvdGVtcGxhdGUtcmVzdWx0LmpzJztcbmV4cG9ydCB7IGNyZWF0ZU1hcmtlciwgaXNUZW1wbGF0ZVBhcnRBY3RpdmUsIFRlbXBsYXRlIH0gZnJvbSAnLi9saWIvdGVtcGxhdGUuanMnO1xuLy8gSU1QT1JUQU5UOiBkbyBub3QgY2hhbmdlIHRoZSBwcm9wZXJ0eSBuYW1lIG9yIHRoZSBhc3NpZ25tZW50IGV4cHJlc3Npb24uXG4vLyBUaGlzIGxpbmUgd2lsbCBiZSB1c2VkIGluIHJlZ2V4ZXMgdG8gc2VhcmNoIGZvciBsaXQtaHRtbCB1c2FnZS5cbi8vIFRPRE8oanVzdGluZmFnbmFuaSk6IGluamVjdCB2ZXJzaW9uIG51bWJlciBhdCBidWlsZCB0aW1lXG5pZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAod2luZG93WydsaXRIdG1sVmVyc2lvbnMnXSB8fCAod2luZG93WydsaXRIdG1sVmVyc2lvbnMnXSA9IFtdKSkucHVzaCgnMS4yLjEnKTtcbn1cbi8qKlxuICogSW50ZXJwcmV0cyBhIHRlbXBsYXRlIGxpdGVyYWwgYXMgYW4gSFRNTCB0ZW1wbGF0ZSB0aGF0IGNhbiBlZmZpY2llbnRseVxuICogcmVuZGVyIHRvIGFuZCB1cGRhdGUgYSBjb250YWluZXIuXG4gKi9cbmV4cG9ydCBjb25zdCBodG1sID0gKHN0cmluZ3MsIC4uLnZhbHVlcykgPT4gbmV3IFRlbXBsYXRlUmVzdWx0KHN0cmluZ3MsIHZhbHVlcywgJ2h0bWwnLCBkZWZhdWx0VGVtcGxhdGVQcm9jZXNzb3IpO1xuLyoqXG4gKiBJbnRlcnByZXRzIGEgdGVtcGxhdGUgbGl0ZXJhbCBhcyBhbiBTVkcgdGVtcGxhdGUgdGhhdCBjYW4gZWZmaWNpZW50bHlcbiAqIHJlbmRlciB0byBhbmQgdXBkYXRlIGEgY29udGFpbmVyLlxuICovXG5leHBvcnQgY29uc3Qgc3ZnID0gKHN0cmluZ3MsIC4uLnZhbHVlcykgPT4gbmV3IFNWR1RlbXBsYXRlUmVzdWx0KHN0cmluZ3MsIHZhbHVlcywgJ3N2ZycsIGRlZmF1bHRUZW1wbGF0ZVByb2Nlc3Nvcik7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1saXQtaHRtbC5qcy5tYXAiLCIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTcgVGhlIFBvbHltZXIgUHJvamVjdCBBdXRob3JzLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogVGhpcyBjb2RlIG1heSBvbmx5IGJlIHVzZWQgdW5kZXIgdGhlIEJTRCBzdHlsZSBsaWNlbnNlIGZvdW5kIGF0XG4gKiBodHRwOi8vcG9seW1lci5naXRodWIuaW8vTElDRU5TRS50eHRcbiAqIFRoZSBjb21wbGV0ZSBzZXQgb2YgYXV0aG9ycyBtYXkgYmUgZm91bmQgYXRcbiAqIGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9BVVRIT1JTLnR4dFxuICogVGhlIGNvbXBsZXRlIHNldCBvZiBjb250cmlidXRvcnMgbWF5IGJlIGZvdW5kIGF0XG4gKiBodHRwOi8vcG9seW1lci5naXRodWIuaW8vQ09OVFJJQlVUT1JTLnR4dFxuICogQ29kZSBkaXN0cmlidXRlZCBieSBHb29nbGUgYXMgcGFydCBvZiB0aGUgcG9seW1lciBwcm9qZWN0IGlzIGFsc29cbiAqIHN1YmplY3QgdG8gYW4gYWRkaXRpb25hbCBJUCByaWdodHMgZ3JhbnQgZm91bmQgYXRcbiAqIGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9QQVRFTlRTLnR4dFxuICovXG4vKipcbiAqIE1vZHVsZSB0byBhZGQgc2hhZHkgRE9NL3NoYWR5IENTUyBwb2x5ZmlsbCBzdXBwb3J0IHRvIGxpdC1odG1sIHRlbXBsYXRlXG4gKiByZW5kZXJpbmcuIFNlZSB0aGUgW1tyZW5kZXJdXSBtZXRob2QgZm9yIGRldGFpbHMuXG4gKlxuICogQG1vZHVsZSBzaGFkeS1yZW5kZXJcbiAqIEBwcmVmZXJyZWRcbiAqL1xuLyoqXG4gKiBEbyBub3QgcmVtb3ZlIHRoaXMgY29tbWVudDsgaXQga2VlcHMgdHlwZWRvYyBmcm9tIG1pc3BsYWNpbmcgdGhlIG1vZHVsZVxuICogZG9jcy5cbiAqL1xuaW1wb3J0IHsgcmVtb3ZlTm9kZXMgfSBmcm9tICcuL2RvbS5qcyc7XG5pbXBvcnQgeyBpbnNlcnROb2RlSW50b1RlbXBsYXRlLCByZW1vdmVOb2Rlc0Zyb21UZW1wbGF0ZSB9IGZyb20gJy4vbW9kaWZ5LXRlbXBsYXRlLmpzJztcbmltcG9ydCB7IHBhcnRzLCByZW5kZXIgYXMgbGl0UmVuZGVyIH0gZnJvbSAnLi9yZW5kZXIuanMnO1xuaW1wb3J0IHsgdGVtcGxhdGVDYWNoZXMgfSBmcm9tICcuL3RlbXBsYXRlLWZhY3RvcnkuanMnO1xuaW1wb3J0IHsgVGVtcGxhdGVJbnN0YW5jZSB9IGZyb20gJy4vdGVtcGxhdGUtaW5zdGFuY2UuanMnO1xuaW1wb3J0IHsgbWFya2VyLCBUZW1wbGF0ZSB9IGZyb20gJy4vdGVtcGxhdGUuanMnO1xuZXhwb3J0IHsgaHRtbCwgc3ZnLCBUZW1wbGF0ZVJlc3VsdCB9IGZyb20gJy4uL2xpdC1odG1sLmpzJztcbi8vIEdldCBhIGtleSB0byBsb29rdXAgaW4gYHRlbXBsYXRlQ2FjaGVzYC5cbmNvbnN0IGdldFRlbXBsYXRlQ2FjaGVLZXkgPSAodHlwZSwgc2NvcGVOYW1lKSA9PiBgJHt0eXBlfS0tJHtzY29wZU5hbWV9YDtcbmxldCBjb21wYXRpYmxlU2hhZHlDU1NWZXJzaW9uID0gdHJ1ZTtcbmlmICh0eXBlb2Ygd2luZG93LlNoYWR5Q1NTID09PSAndW5kZWZpbmVkJykge1xuICAgIGNvbXBhdGlibGVTaGFkeUNTU1ZlcnNpb24gPSBmYWxzZTtcbn1cbmVsc2UgaWYgKHR5cGVvZiB3aW5kb3cuU2hhZHlDU1MucHJlcGFyZVRlbXBsYXRlRG9tID09PSAndW5kZWZpbmVkJykge1xuICAgIGNvbnNvbGUud2FybihgSW5jb21wYXRpYmxlIFNoYWR5Q1NTIHZlcnNpb24gZGV0ZWN0ZWQuIGAgK1xuICAgICAgICBgUGxlYXNlIHVwZGF0ZSB0byBhdCBsZWFzdCBAd2ViY29tcG9uZW50cy93ZWJjb21wb25lbnRzanNAMi4wLjIgYW5kIGAgK1xuICAgICAgICBgQHdlYmNvbXBvbmVudHMvc2hhZHljc3NAMS4zLjEuYCk7XG4gICAgY29tcGF0aWJsZVNoYWR5Q1NTVmVyc2lvbiA9IGZhbHNlO1xufVxuLyoqXG4gKiBUZW1wbGF0ZSBmYWN0b3J5IHdoaWNoIHNjb3BlcyB0ZW1wbGF0ZSBET00gdXNpbmcgU2hhZHlDU1MuXG4gKiBAcGFyYW0gc2NvcGVOYW1lIHtzdHJpbmd9XG4gKi9cbmNvbnN0IHNoYWR5VGVtcGxhdGVGYWN0b3J5ID0gKHNjb3BlTmFtZSkgPT4gKHJlc3VsdCkgPT4ge1xuICAgIGNvbnN0IGNhY2hlS2V5ID0gZ2V0VGVtcGxhdGVDYWNoZUtleShyZXN1bHQudHlwZSwgc2NvcGVOYW1lKTtcbiAgICBsZXQgdGVtcGxhdGVDYWNoZSA9IHRlbXBsYXRlQ2FjaGVzLmdldChjYWNoZUtleSk7XG4gICAgaWYgKHRlbXBsYXRlQ2FjaGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0ZW1wbGF0ZUNhY2hlID0ge1xuICAgICAgICAgICAgc3RyaW5nc0FycmF5OiBuZXcgV2Vha01hcCgpLFxuICAgICAgICAgICAga2V5U3RyaW5nOiBuZXcgTWFwKClcbiAgICAgICAgfTtcbiAgICAgICAgdGVtcGxhdGVDYWNoZXMuc2V0KGNhY2hlS2V5LCB0ZW1wbGF0ZUNhY2hlKTtcbiAgICB9XG4gICAgbGV0IHRlbXBsYXRlID0gdGVtcGxhdGVDYWNoZS5zdHJpbmdzQXJyYXkuZ2V0KHJlc3VsdC5zdHJpbmdzKTtcbiAgICBpZiAodGVtcGxhdGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gdGVtcGxhdGU7XG4gICAgfVxuICAgIGNvbnN0IGtleSA9IHJlc3VsdC5zdHJpbmdzLmpvaW4obWFya2VyKTtcbiAgICB0ZW1wbGF0ZSA9IHRlbXBsYXRlQ2FjaGUua2V5U3RyaW5nLmdldChrZXkpO1xuICAgIGlmICh0ZW1wbGF0ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGNvbnN0IGVsZW1lbnQgPSByZXN1bHQuZ2V0VGVtcGxhdGVFbGVtZW50KCk7XG4gICAgICAgIGlmIChjb21wYXRpYmxlU2hhZHlDU1NWZXJzaW9uKSB7XG4gICAgICAgICAgICB3aW5kb3cuU2hhZHlDU1MucHJlcGFyZVRlbXBsYXRlRG9tKGVsZW1lbnQsIHNjb3BlTmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGVtcGxhdGUgPSBuZXcgVGVtcGxhdGUocmVzdWx0LCBlbGVtZW50KTtcbiAgICAgICAgdGVtcGxhdGVDYWNoZS5rZXlTdHJpbmcuc2V0KGtleSwgdGVtcGxhdGUpO1xuICAgIH1cbiAgICB0ZW1wbGF0ZUNhY2hlLnN0cmluZ3NBcnJheS5zZXQocmVzdWx0LnN0cmluZ3MsIHRlbXBsYXRlKTtcbiAgICByZXR1cm4gdGVtcGxhdGU7XG59O1xuY29uc3QgVEVNUExBVEVfVFlQRVMgPSBbJ2h0bWwnLCAnc3ZnJ107XG4vKipcbiAqIFJlbW92ZXMgYWxsIHN0eWxlIGVsZW1lbnRzIGZyb20gVGVtcGxhdGVzIGZvciB0aGUgZ2l2ZW4gc2NvcGVOYW1lLlxuICovXG5jb25zdCByZW1vdmVTdHlsZXNGcm9tTGl0VGVtcGxhdGVzID0gKHNjb3BlTmFtZSkgPT4ge1xuICAgIFRFTVBMQVRFX1RZUEVTLmZvckVhY2goKHR5cGUpID0+IHtcbiAgICAgICAgY29uc3QgdGVtcGxhdGVzID0gdGVtcGxhdGVDYWNoZXMuZ2V0KGdldFRlbXBsYXRlQ2FjaGVLZXkodHlwZSwgc2NvcGVOYW1lKSk7XG4gICAgICAgIGlmICh0ZW1wbGF0ZXMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGVtcGxhdGVzLmtleVN0cmluZy5mb3JFYWNoKCh0ZW1wbGF0ZSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgZWxlbWVudDogeyBjb250ZW50IH0gfSA9IHRlbXBsYXRlO1xuICAgICAgICAgICAgICAgIC8vIElFIDExIGRvZXNuJ3Qgc3VwcG9ydCB0aGUgaXRlcmFibGUgcGFyYW0gU2V0IGNvbnN0cnVjdG9yXG4gICAgICAgICAgICAgICAgY29uc3Qgc3R5bGVzID0gbmV3IFNldCgpO1xuICAgICAgICAgICAgICAgIEFycmF5LmZyb20oY29udGVudC5xdWVyeVNlbGVjdG9yQWxsKCdzdHlsZScpKS5mb3JFYWNoKChzKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHN0eWxlcy5hZGQocyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmVtb3ZlTm9kZXNGcm9tVGVtcGxhdGUodGVtcGxhdGUsIHN0eWxlcyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0pO1xufTtcbmNvbnN0IHNoYWR5UmVuZGVyU2V0ID0gbmV3IFNldCgpO1xuLyoqXG4gKiBGb3IgdGhlIGdpdmVuIHNjb3BlIG5hbWUsIGVuc3VyZXMgdGhhdCBTaGFkeUNTUyBzdHlsZSBzY29waW5nIGlzIHBlcmZvcm1lZC5cbiAqIFRoaXMgaXMgZG9uZSBqdXN0IG9uY2UgcGVyIHNjb3BlIG5hbWUgc28gdGhlIGZyYWdtZW50IGFuZCB0ZW1wbGF0ZSBjYW5ub3RcbiAqIGJlIG1vZGlmaWVkLlxuICogKDEpIGV4dHJhY3RzIHN0eWxlcyBmcm9tIHRoZSByZW5kZXJlZCBmcmFnbWVudCBhbmQgaGFuZHMgdGhlbSB0byBTaGFkeUNTU1xuICogdG8gYmUgc2NvcGVkIGFuZCBhcHBlbmRlZCB0byB0aGUgZG9jdW1lbnRcbiAqICgyKSByZW1vdmVzIHN0eWxlIGVsZW1lbnRzIGZyb20gYWxsIGxpdC1odG1sIFRlbXBsYXRlcyBmb3IgdGhpcyBzY29wZSBuYW1lLlxuICpcbiAqIE5vdGUsIDxzdHlsZT4gZWxlbWVudHMgY2FuIG9ubHkgYmUgcGxhY2VkIGludG8gdGVtcGxhdGVzIGZvciB0aGVcbiAqIGluaXRpYWwgcmVuZGVyaW5nIG9mIHRoZSBzY29wZS4gSWYgPHN0eWxlPiBlbGVtZW50cyBhcmUgaW5jbHVkZWQgaW4gdGVtcGxhdGVzXG4gKiBkeW5hbWljYWxseSByZW5kZXJlZCB0byB0aGUgc2NvcGUgKGFmdGVyIHRoZSBmaXJzdCBzY29wZSByZW5kZXIpLCB0aGV5IHdpbGxcbiAqIG5vdCBiZSBzY29wZWQgYW5kIHRoZSA8c3R5bGU+IHdpbGwgYmUgbGVmdCBpbiB0aGUgdGVtcGxhdGUgYW5kIHJlbmRlcmVkXG4gKiBvdXRwdXQuXG4gKi9cbmNvbnN0IHByZXBhcmVUZW1wbGF0ZVN0eWxlcyA9IChzY29wZU5hbWUsIHJlbmRlcmVkRE9NLCB0ZW1wbGF0ZSkgPT4ge1xuICAgIHNoYWR5UmVuZGVyU2V0LmFkZChzY29wZU5hbWUpO1xuICAgIC8vIElmIGByZW5kZXJlZERPTWAgaXMgc3RhbXBlZCBmcm9tIGEgVGVtcGxhdGUsIHRoZW4gd2UgbmVlZCB0byBlZGl0IHRoYXRcbiAgICAvLyBUZW1wbGF0ZSdzIHVuZGVybHlpbmcgdGVtcGxhdGUgZWxlbWVudC4gT3RoZXJ3aXNlLCB3ZSBjcmVhdGUgb25lIGhlcmVcbiAgICAvLyB0byBnaXZlIHRvIFNoYWR5Q1NTLCB3aGljaCBzdGlsbCByZXF1aXJlcyBvbmUgd2hpbGUgc2NvcGluZy5cbiAgICBjb25zdCB0ZW1wbGF0ZUVsZW1lbnQgPSAhIXRlbXBsYXRlID8gdGVtcGxhdGUuZWxlbWVudCA6IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RlbXBsYXRlJyk7XG4gICAgLy8gTW92ZSBzdHlsZXMgb3V0IG9mIHJlbmRlcmVkIERPTSBhbmQgc3RvcmUuXG4gICAgY29uc3Qgc3R5bGVzID0gcmVuZGVyZWRET00ucXVlcnlTZWxlY3RvckFsbCgnc3R5bGUnKTtcbiAgICBjb25zdCB7IGxlbmd0aCB9ID0gc3R5bGVzO1xuICAgIC8vIElmIHRoZXJlIGFyZSBubyBzdHlsZXMsIHNraXAgdW5uZWNlc3Nhcnkgd29ya1xuICAgIGlmIChsZW5ndGggPT09IDApIHtcbiAgICAgICAgLy8gRW5zdXJlIHByZXBhcmVUZW1wbGF0ZVN0eWxlcyBpcyBjYWxsZWQgdG8gc3VwcG9ydCBhZGRpbmdcbiAgICAgICAgLy8gc3R5bGVzIHZpYSBgcHJlcGFyZUFkb3B0ZWRDc3NUZXh0YCBzaW5jZSB0aGF0IHJlcXVpcmVzIHRoYXRcbiAgICAgICAgLy8gYHByZXBhcmVUZW1wbGF0ZVN0eWxlc2AgaXMgY2FsbGVkLlxuICAgICAgICAvL1xuICAgICAgICAvLyBTaGFkeUNTUyB3aWxsIG9ubHkgdXBkYXRlIHN0eWxlcyBjb250YWluaW5nIEBhcHBseSBpbiB0aGUgdGVtcGxhdGVcbiAgICAgICAgLy8gZ2l2ZW4gdG8gYHByZXBhcmVUZW1wbGF0ZVN0eWxlc2AuIElmIG5vIGxpdCBUZW1wbGF0ZSB3YXMgZ2l2ZW4sXG4gICAgICAgIC8vIFNoYWR5Q1NTIHdpbGwgbm90IGJlIGFibGUgdG8gdXBkYXRlIHVzZXMgb2YgQGFwcGx5IGluIGFueSByZWxldmFudFxuICAgICAgICAvLyB0ZW1wbGF0ZS4gSG93ZXZlciwgdGhpcyBpcyBub3QgYSBwcm9ibGVtIGJlY2F1c2Ugd2Ugb25seSBjcmVhdGUgdGhlXG4gICAgICAgIC8vIHRlbXBsYXRlIGZvciB0aGUgcHVycG9zZSBvZiBzdXBwb3J0aW5nIGBwcmVwYXJlQWRvcHRlZENzc1RleHRgLFxuICAgICAgICAvLyB3aGljaCBkb2Vzbid0IHN1cHBvcnQgQGFwcGx5IGF0IGFsbC5cbiAgICAgICAgd2luZG93LlNoYWR5Q1NTLnByZXBhcmVUZW1wbGF0ZVN0eWxlcyh0ZW1wbGF0ZUVsZW1lbnQsIHNjb3BlTmFtZSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgY29uZGVuc2VkU3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpO1xuICAgIC8vIENvbGxlY3Qgc3R5bGVzIGludG8gYSBzaW5nbGUgc3R5bGUuIFRoaXMgaGVscHMgdXMgbWFrZSBzdXJlIFNoYWR5Q1NTXG4gICAgLy8gbWFuaXB1bGF0aW9ucyB3aWxsIG5vdCBwcmV2ZW50IHVzIGZyb20gYmVpbmcgYWJsZSB0byBmaXggdXAgdGVtcGxhdGVcbiAgICAvLyBwYXJ0IGluZGljZXMuXG4gICAgLy8gTk9URTogY29sbGVjdGluZyBzdHlsZXMgaXMgaW5lZmZpY2llbnQgZm9yIGJyb3dzZXJzIGJ1dCBTaGFkeUNTU1xuICAgIC8vIGN1cnJlbnRseSBkb2VzIHRoaXMgYW55d2F5LiBXaGVuIGl0IGRvZXMgbm90LCB0aGlzIHNob3VsZCBiZSBjaGFuZ2VkLlxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3Qgc3R5bGUgPSBzdHlsZXNbaV07XG4gICAgICAgIHN0eWxlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc3R5bGUpO1xuICAgICAgICBjb25kZW5zZWRTdHlsZS50ZXh0Q29udGVudCArPSBzdHlsZS50ZXh0Q29udGVudDtcbiAgICB9XG4gICAgLy8gUmVtb3ZlIHN0eWxlcyBmcm9tIG5lc3RlZCB0ZW1wbGF0ZXMgaW4gdGhpcyBzY29wZS5cbiAgICByZW1vdmVTdHlsZXNGcm9tTGl0VGVtcGxhdGVzKHNjb3BlTmFtZSk7XG4gICAgLy8gQW5kIHRoZW4gcHV0IHRoZSBjb25kZW5zZWQgc3R5bGUgaW50byB0aGUgXCJyb290XCIgdGVtcGxhdGUgcGFzc2VkIGluIGFzXG4gICAgLy8gYHRlbXBsYXRlYC5cbiAgICBjb25zdCBjb250ZW50ID0gdGVtcGxhdGVFbGVtZW50LmNvbnRlbnQ7XG4gICAgaWYgKCEhdGVtcGxhdGUpIHtcbiAgICAgICAgaW5zZXJ0Tm9kZUludG9UZW1wbGF0ZSh0ZW1wbGF0ZSwgY29uZGVuc2VkU3R5bGUsIGNvbnRlbnQuZmlyc3RDaGlsZCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBjb250ZW50Lmluc2VydEJlZm9yZShjb25kZW5zZWRTdHlsZSwgY29udGVudC5maXJzdENoaWxkKTtcbiAgICB9XG4gICAgLy8gTm90ZSwgaXQncyBpbXBvcnRhbnQgdGhhdCBTaGFkeUNTUyBnZXRzIHRoZSB0ZW1wbGF0ZSB0aGF0IGBsaXQtaHRtbGBcbiAgICAvLyB3aWxsIGFjdHVhbGx5IHJlbmRlciBzbyB0aGF0IGl0IGNhbiB1cGRhdGUgdGhlIHN0eWxlIGluc2lkZSB3aGVuXG4gICAgLy8gbmVlZGVkIChlLmcuIEBhcHBseSBuYXRpdmUgU2hhZG93IERPTSBjYXNlKS5cbiAgICB3aW5kb3cuU2hhZHlDU1MucHJlcGFyZVRlbXBsYXRlU3R5bGVzKHRlbXBsYXRlRWxlbWVudCwgc2NvcGVOYW1lKTtcbiAgICBjb25zdCBzdHlsZSA9IGNvbnRlbnQucXVlcnlTZWxlY3Rvcignc3R5bGUnKTtcbiAgICBpZiAod2luZG93LlNoYWR5Q1NTLm5hdGl2ZVNoYWRvdyAmJiBzdHlsZSAhPT0gbnVsbCkge1xuICAgICAgICAvLyBXaGVuIGluIG5hdGl2ZSBTaGFkb3cgRE9NLCBlbnN1cmUgdGhlIHN0eWxlIGNyZWF0ZWQgYnkgU2hhZHlDU1MgaXNcbiAgICAgICAgLy8gaW5jbHVkZWQgaW4gaW5pdGlhbGx5IHJlbmRlcmVkIG91dHB1dCAoYHJlbmRlcmVkRE9NYCkuXG4gICAgICAgIHJlbmRlcmVkRE9NLmluc2VydEJlZm9yZShzdHlsZS5jbG9uZU5vZGUodHJ1ZSksIHJlbmRlcmVkRE9NLmZpcnN0Q2hpbGQpO1xuICAgIH1cbiAgICBlbHNlIGlmICghIXRlbXBsYXRlKSB7XG4gICAgICAgIC8vIFdoZW4gbm8gc3R5bGUgaXMgbGVmdCBpbiB0aGUgdGVtcGxhdGUsIHBhcnRzIHdpbGwgYmUgYnJva2VuIGFzIGFcbiAgICAgICAgLy8gcmVzdWx0LiBUbyBmaXggdGhpcywgd2UgcHV0IGJhY2sgdGhlIHN0eWxlIG5vZGUgU2hhZHlDU1MgcmVtb3ZlZFxuICAgICAgICAvLyBhbmQgdGhlbiB0ZWxsIGxpdCB0byByZW1vdmUgdGhhdCBub2RlIGZyb20gdGhlIHRlbXBsYXRlLlxuICAgICAgICAvLyBUaGVyZSBjYW4gYmUgbm8gc3R5bGUgaW4gdGhlIHRlbXBsYXRlIGluIDIgY2FzZXMgKDEpIHdoZW4gU2hhZHkgRE9NXG4gICAgICAgIC8vIGlzIGluIHVzZSwgU2hhZHlDU1MgcmVtb3ZlcyBhbGwgc3R5bGVzLCAoMikgd2hlbiBuYXRpdmUgU2hhZG93IERPTVxuICAgICAgICAvLyBpcyBpbiB1c2UgU2hhZHlDU1MgcmVtb3ZlcyB0aGUgc3R5bGUgaWYgaXQgY29udGFpbnMgbm8gY29udGVudC5cbiAgICAgICAgLy8gTk9URSwgU2hhZHlDU1MgY3JlYXRlcyBpdHMgb3duIHN0eWxlIHNvIHdlIGNhbiBzYWZlbHkgYWRkL3JlbW92ZVxuICAgICAgICAvLyBgY29uZGVuc2VkU3R5bGVgIGhlcmUuXG4gICAgICAgIGNvbnRlbnQuaW5zZXJ0QmVmb3JlKGNvbmRlbnNlZFN0eWxlLCBjb250ZW50LmZpcnN0Q2hpbGQpO1xuICAgICAgICBjb25zdCByZW1vdmVzID0gbmV3IFNldCgpO1xuICAgICAgICByZW1vdmVzLmFkZChjb25kZW5zZWRTdHlsZSk7XG4gICAgICAgIHJlbW92ZU5vZGVzRnJvbVRlbXBsYXRlKHRlbXBsYXRlLCByZW1vdmVzKTtcbiAgICB9XG59O1xuLyoqXG4gKiBFeHRlbnNpb24gdG8gdGhlIHN0YW5kYXJkIGByZW5kZXJgIG1ldGhvZCB3aGljaCBzdXBwb3J0cyByZW5kZXJpbmdcbiAqIHRvIFNoYWRvd1Jvb3RzIHdoZW4gdGhlIFNoYWR5RE9NIChodHRwczovL2dpdGh1Yi5jb20vd2ViY29tcG9uZW50cy9zaGFkeWRvbSlcbiAqIGFuZCBTaGFkeUNTUyAoaHR0cHM6Ly9naXRodWIuY29tL3dlYmNvbXBvbmVudHMvc2hhZHljc3MpIHBvbHlmaWxscyBhcmUgdXNlZFxuICogb3Igd2hlbiB0aGUgd2ViY29tcG9uZW50c2pzXG4gKiAoaHR0cHM6Ly9naXRodWIuY29tL3dlYmNvbXBvbmVudHMvd2ViY29tcG9uZW50c2pzKSBwb2x5ZmlsbCBpcyB1c2VkLlxuICpcbiAqIEFkZHMgYSBgc2NvcGVOYW1lYCBvcHRpb24gd2hpY2ggaXMgdXNlZCB0byBzY29wZSBlbGVtZW50IERPTSBhbmQgc3R5bGVzaGVldHNcbiAqIHdoZW4gbmF0aXZlIFNoYWRvd0RPTSBpcyB1bmF2YWlsYWJsZS4gVGhlIGBzY29wZU5hbWVgIHdpbGwgYmUgYWRkZWQgdG9cbiAqIHRoZSBjbGFzcyBhdHRyaWJ1dGUgb2YgYWxsIHJlbmRlcmVkIERPTS4gSW4gYWRkaXRpb24sIGFueSBzdHlsZSBlbGVtZW50cyB3aWxsXG4gKiBiZSBhdXRvbWF0aWNhbGx5IHJlLXdyaXR0ZW4gd2l0aCB0aGlzIGBzY29wZU5hbWVgIHNlbGVjdG9yIGFuZCBtb3ZlZCBvdXRcbiAqIG9mIHRoZSByZW5kZXJlZCBET00gYW5kIGludG8gdGhlIGRvY3VtZW50IGA8aGVhZD5gLlxuICpcbiAqIEl0IGlzIGNvbW1vbiB0byB1c2UgdGhpcyByZW5kZXIgbWV0aG9kIGluIGNvbmp1bmN0aW9uIHdpdGggYSBjdXN0b20gZWxlbWVudFxuICogd2hpY2ggcmVuZGVycyBhIHNoYWRvd1Jvb3QuIFdoZW4gdGhpcyBpcyBkb25lLCB0eXBpY2FsbHkgdGhlIGVsZW1lbnQnc1xuICogYGxvY2FsTmFtZWAgc2hvdWxkIGJlIHVzZWQgYXMgdGhlIGBzY29wZU5hbWVgLlxuICpcbiAqIEluIGFkZGl0aW9uIHRvIERPTSBzY29waW5nLCBTaGFkeUNTUyBhbHNvIHN1cHBvcnRzIGEgYmFzaWMgc2hpbSBmb3IgY3NzXG4gKiBjdXN0b20gcHJvcGVydGllcyAobmVlZGVkIG9ubHkgb24gb2xkZXIgYnJvd3NlcnMgbGlrZSBJRTExKSBhbmQgYSBzaGltIGZvclxuICogYSBkZXByZWNhdGVkIGZlYXR1cmUgY2FsbGVkIGBAYXBwbHlgIHRoYXQgc3VwcG9ydHMgYXBwbHlpbmcgYSBzZXQgb2YgY3NzXG4gKiBjdXN0b20gcHJvcGVydGllcyB0byBhIGdpdmVuIGxvY2F0aW9uLlxuICpcbiAqIFVzYWdlIGNvbnNpZGVyYXRpb25zOlxuICpcbiAqICogUGFydCB2YWx1ZXMgaW4gYDxzdHlsZT5gIGVsZW1lbnRzIGFyZSBvbmx5IGFwcGxpZWQgdGhlIGZpcnN0IHRpbWUgYSBnaXZlblxuICogYHNjb3BlTmFtZWAgcmVuZGVycy4gU3Vic2VxdWVudCBjaGFuZ2VzIHRvIHBhcnRzIGluIHN0eWxlIGVsZW1lbnRzIHdpbGwgaGF2ZVxuICogbm8gZWZmZWN0LiBCZWNhdXNlIG9mIHRoaXMsIHBhcnRzIGluIHN0eWxlIGVsZW1lbnRzIHNob3VsZCBvbmx5IGJlIHVzZWQgZm9yXG4gKiB2YWx1ZXMgdGhhdCB3aWxsIG5ldmVyIGNoYW5nZSwgZm9yIGV4YW1wbGUgcGFydHMgdGhhdCBzZXQgc2NvcGUtd2lkZSB0aGVtZVxuICogdmFsdWVzIG9yIHBhcnRzIHdoaWNoIHJlbmRlciBzaGFyZWQgc3R5bGUgZWxlbWVudHMuXG4gKlxuICogKiBOb3RlLCBkdWUgdG8gYSBsaW1pdGF0aW9uIG9mIHRoZSBTaGFkeURPTSBwb2x5ZmlsbCwgcmVuZGVyaW5nIGluIGFcbiAqIGN1c3RvbSBlbGVtZW50J3MgYGNvbnN0cnVjdG9yYCBpcyBub3Qgc3VwcG9ydGVkLiBJbnN0ZWFkIHJlbmRlcmluZyBzaG91bGRcbiAqIGVpdGhlciBkb25lIGFzeW5jaHJvbm91c2x5LCBmb3IgZXhhbXBsZSBhdCBtaWNyb3Rhc2sgdGltaW5nIChmb3IgZXhhbXBsZVxuICogYFByb21pc2UucmVzb2x2ZSgpYCksIG9yIGJlIGRlZmVycmVkIHVudGlsIHRoZSBmaXJzdCB0aW1lIHRoZSBlbGVtZW50J3NcbiAqIGBjb25uZWN0ZWRDYWxsYmFja2AgcnVucy5cbiAqXG4gKiBVc2FnZSBjb25zaWRlcmF0aW9ucyB3aGVuIHVzaW5nIHNoaW1tZWQgY3VzdG9tIHByb3BlcnRpZXMgb3IgYEBhcHBseWA6XG4gKlxuICogKiBXaGVuZXZlciBhbnkgZHluYW1pYyBjaGFuZ2VzIGFyZSBtYWRlIHdoaWNoIGFmZmVjdFxuICogY3NzIGN1c3RvbSBwcm9wZXJ0aWVzLCBgU2hhZHlDU1Muc3R5bGVFbGVtZW50KGVsZW1lbnQpYCBtdXN0IGJlIGNhbGxlZFxuICogdG8gdXBkYXRlIHRoZSBlbGVtZW50LiBUaGVyZSBhcmUgdHdvIGNhc2VzIHdoZW4gdGhpcyBpcyBuZWVkZWQ6XG4gKiAoMSkgdGhlIGVsZW1lbnQgaXMgY29ubmVjdGVkIHRvIGEgbmV3IHBhcmVudCwgKDIpIGEgY2xhc3MgaXMgYWRkZWQgdG8gdGhlXG4gKiBlbGVtZW50IHRoYXQgY2F1c2VzIGl0IHRvIG1hdGNoIGRpZmZlcmVudCBjdXN0b20gcHJvcGVydGllcy5cbiAqIFRvIGFkZHJlc3MgdGhlIGZpcnN0IGNhc2Ugd2hlbiByZW5kZXJpbmcgYSBjdXN0b20gZWxlbWVudCwgYHN0eWxlRWxlbWVudGBcbiAqIHNob3VsZCBiZSBjYWxsZWQgaW4gdGhlIGVsZW1lbnQncyBgY29ubmVjdGVkQ2FsbGJhY2tgLlxuICpcbiAqICogU2hpbW1lZCBjdXN0b20gcHJvcGVydGllcyBtYXkgb25seSBiZSBkZWZpbmVkIGVpdGhlciBmb3IgYW4gZW50aXJlXG4gKiBzaGFkb3dSb290IChmb3IgZXhhbXBsZSwgaW4gYSBgOmhvc3RgIHJ1bGUpIG9yIHZpYSBhIHJ1bGUgdGhhdCBkaXJlY3RseVxuICogbWF0Y2hlcyBhbiBlbGVtZW50IHdpdGggYSBzaGFkb3dSb290LiBJbiBvdGhlciB3b3JkcywgaW5zdGVhZCBvZiBmbG93aW5nIGZyb21cbiAqIHBhcmVudCB0byBjaGlsZCBhcyBkbyBuYXRpdmUgY3NzIGN1c3RvbSBwcm9wZXJ0aWVzLCBzaGltbWVkIGN1c3RvbSBwcm9wZXJ0aWVzXG4gKiBmbG93IG9ubHkgZnJvbSBzaGFkb3dSb290cyB0byBuZXN0ZWQgc2hhZG93Um9vdHMuXG4gKlxuICogKiBXaGVuIHVzaW5nIGBAYXBwbHlgIG1peGluZyBjc3Mgc2hvcnRoYW5kIHByb3BlcnR5IG5hbWVzIHdpdGhcbiAqIG5vbi1zaG9ydGhhbmQgbmFtZXMgKGZvciBleGFtcGxlIGBib3JkZXJgIGFuZCBgYm9yZGVyLXdpZHRoYCkgaXMgbm90XG4gKiBzdXBwb3J0ZWQuXG4gKi9cbmV4cG9ydCBjb25zdCByZW5kZXIgPSAocmVzdWx0LCBjb250YWluZXIsIG9wdGlvbnMpID0+IHtcbiAgICBpZiAoIW9wdGlvbnMgfHwgdHlwZW9mIG9wdGlvbnMgIT09ICdvYmplY3QnIHx8ICFvcHRpb25zLnNjb3BlTmFtZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBgc2NvcGVOYW1lYCBvcHRpb24gaXMgcmVxdWlyZWQuJyk7XG4gICAgfVxuICAgIGNvbnN0IHNjb3BlTmFtZSA9IG9wdGlvbnMuc2NvcGVOYW1lO1xuICAgIGNvbnN0IGhhc1JlbmRlcmVkID0gcGFydHMuaGFzKGNvbnRhaW5lcik7XG4gICAgY29uc3QgbmVlZHNTY29waW5nID0gY29tcGF0aWJsZVNoYWR5Q1NTVmVyc2lvbiAmJlxuICAgICAgICBjb250YWluZXIubm9kZVR5cGUgPT09IDExIC8qIE5vZGUuRE9DVU1FTlRfRlJBR01FTlRfTk9ERSAqLyAmJlxuICAgICAgICAhIWNvbnRhaW5lci5ob3N0O1xuICAgIC8vIEhhbmRsZSBmaXJzdCByZW5kZXIgdG8gYSBzY29wZSBzcGVjaWFsbHkuLi5cbiAgICBjb25zdCBmaXJzdFNjb3BlUmVuZGVyID0gbmVlZHNTY29waW5nICYmICFzaGFkeVJlbmRlclNldC5oYXMoc2NvcGVOYW1lKTtcbiAgICAvLyBPbiBmaXJzdCBzY29wZSByZW5kZXIsIHJlbmRlciBpbnRvIGEgZnJhZ21lbnQ7IHRoaXMgY2Fubm90IGJlIGEgc2luZ2xlXG4gICAgLy8gZnJhZ21lbnQgdGhhdCBpcyByZXVzZWQgc2luY2UgbmVzdGVkIHJlbmRlcnMgY2FuIG9jY3VyIHN5bmNocm9ub3VzbHkuXG4gICAgY29uc3QgcmVuZGVyQ29udGFpbmVyID0gZmlyc3RTY29wZVJlbmRlciA/IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSA6IGNvbnRhaW5lcjtcbiAgICBsaXRSZW5kZXIocmVzdWx0LCByZW5kZXJDb250YWluZXIsIE9iamVjdC5hc3NpZ24oeyB0ZW1wbGF0ZUZhY3Rvcnk6IHNoYWR5VGVtcGxhdGVGYWN0b3J5KHNjb3BlTmFtZSkgfSwgb3B0aW9ucykpO1xuICAgIC8vIFdoZW4gcGVyZm9ybWluZyBmaXJzdCBzY29wZSByZW5kZXIsXG4gICAgLy8gKDEpIFdlJ3ZlIHJlbmRlcmVkIGludG8gYSBmcmFnbWVudCBzbyB0aGF0IHRoZXJlJ3MgYSBjaGFuY2UgdG9cbiAgICAvLyBgcHJlcGFyZVRlbXBsYXRlU3R5bGVzYCBiZWZvcmUgc3ViLWVsZW1lbnRzIGhpdCB0aGUgRE9NXG4gICAgLy8gKHdoaWNoIG1pZ2h0IGNhdXNlIHRoZW0gdG8gcmVuZGVyIGJhc2VkIG9uIGEgY29tbW9uIHBhdHRlcm4gb2ZcbiAgICAvLyByZW5kZXJpbmcgaW4gYSBjdXN0b20gZWxlbWVudCdzIGBjb25uZWN0ZWRDYWxsYmFja2ApO1xuICAgIC8vICgyKSBTY29wZSB0aGUgdGVtcGxhdGUgd2l0aCBTaGFkeUNTUyBvbmUgdGltZSBvbmx5IGZvciB0aGlzIHNjb3BlLlxuICAgIC8vICgzKSBSZW5kZXIgdGhlIGZyYWdtZW50IGludG8gdGhlIGNvbnRhaW5lciBhbmQgbWFrZSBzdXJlIHRoZVxuICAgIC8vIGNvbnRhaW5lciBrbm93cyBpdHMgYHBhcnRgIGlzIHRoZSBvbmUgd2UganVzdCByZW5kZXJlZC4gVGhpcyBlbnN1cmVzXG4gICAgLy8gRE9NIHdpbGwgYmUgcmUtdXNlZCBvbiBzdWJzZXF1ZW50IHJlbmRlcnMuXG4gICAgaWYgKGZpcnN0U2NvcGVSZW5kZXIpIHtcbiAgICAgICAgY29uc3QgcGFydCA9IHBhcnRzLmdldChyZW5kZXJDb250YWluZXIpO1xuICAgICAgICBwYXJ0cy5kZWxldGUocmVuZGVyQ29udGFpbmVyKTtcbiAgICAgICAgLy8gU2hhZHlDU1MgbWlnaHQgaGF2ZSBzdHlsZSBzaGVldHMgKGUuZy4gZnJvbSBgcHJlcGFyZUFkb3B0ZWRDc3NUZXh0YClcbiAgICAgICAgLy8gdGhhdCBzaG91bGQgYXBwbHkgdG8gYHJlbmRlckNvbnRhaW5lcmAgZXZlbiBpZiB0aGUgcmVuZGVyZWQgdmFsdWUgaXNcbiAgICAgICAgLy8gbm90IGEgVGVtcGxhdGVJbnN0YW5jZS4gSG93ZXZlciwgaXQgd2lsbCBvbmx5IGluc2VydCBzY29wZWQgc3R5bGVzXG4gICAgICAgIC8vIGludG8gdGhlIGRvY3VtZW50IGlmIGBwcmVwYXJlVGVtcGxhdGVTdHlsZXNgIGhhcyBhbHJlYWR5IGJlZW4gY2FsbGVkXG4gICAgICAgIC8vIGZvciB0aGUgZ2l2ZW4gc2NvcGUgbmFtZS5cbiAgICAgICAgY29uc3QgdGVtcGxhdGUgPSBwYXJ0LnZhbHVlIGluc3RhbmNlb2YgVGVtcGxhdGVJbnN0YW5jZSA/XG4gICAgICAgICAgICBwYXJ0LnZhbHVlLnRlbXBsYXRlIDpcbiAgICAgICAgICAgIHVuZGVmaW5lZDtcbiAgICAgICAgcHJlcGFyZVRlbXBsYXRlU3R5bGVzKHNjb3BlTmFtZSwgcmVuZGVyQ29udGFpbmVyLCB0ZW1wbGF0ZSk7XG4gICAgICAgIHJlbW92ZU5vZGVzKGNvbnRhaW5lciwgY29udGFpbmVyLmZpcnN0Q2hpbGQpO1xuICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQocmVuZGVyQ29udGFpbmVyKTtcbiAgICAgICAgcGFydHMuc2V0KGNvbnRhaW5lciwgcGFydCk7XG4gICAgfVxuICAgIC8vIEFmdGVyIGVsZW1lbnRzIGhhdmUgaGl0IHRoZSBET00sIHVwZGF0ZSBzdHlsaW5nIGlmIHRoaXMgaXMgdGhlXG4gICAgLy8gaW5pdGlhbCByZW5kZXIgdG8gdGhpcyBjb250YWluZXIuXG4gICAgLy8gVGhpcyBpcyBuZWVkZWQgd2hlbmV2ZXIgZHluYW1pYyBjaGFuZ2VzIGFyZSBtYWRlIHNvIGl0IHdvdWxkIGJlXG4gICAgLy8gc2FmZXN0IHRvIGRvIGV2ZXJ5IHJlbmRlcjsgaG93ZXZlciwgdGhpcyB3b3VsZCByZWdyZXNzIHBlcmZvcm1hbmNlXG4gICAgLy8gc28gd2UgbGVhdmUgaXQgdXAgdG8gdGhlIHVzZXIgdG8gY2FsbCBgU2hhZHlDU1Muc3R5bGVFbGVtZW50YFxuICAgIC8vIGZvciBkeW5hbWljIGNoYW5nZXMuXG4gICAgaWYgKCFoYXNSZW5kZXJlZCAmJiBuZWVkc1Njb3BpbmcpIHtcbiAgICAgICAgd2luZG93LlNoYWR5Q1NTLnN0eWxlRWxlbWVudChjb250YWluZXIuaG9zdCk7XG4gICAgfVxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNoYWR5LXJlbmRlci5qcy5tYXAiLCIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTcgVGhlIFBvbHltZXIgUHJvamVjdCBBdXRob3JzLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogVGhpcyBjb2RlIG1heSBvbmx5IGJlIHVzZWQgdW5kZXIgdGhlIEJTRCBzdHlsZSBsaWNlbnNlIGZvdW5kIGF0XG4gKiBodHRwOi8vcG9seW1lci5naXRodWIuaW8vTElDRU5TRS50eHRcbiAqIFRoZSBjb21wbGV0ZSBzZXQgb2YgYXV0aG9ycyBtYXkgYmUgZm91bmQgYXRcbiAqIGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9BVVRIT1JTLnR4dFxuICogVGhlIGNvbXBsZXRlIHNldCBvZiBjb250cmlidXRvcnMgbWF5IGJlIGZvdW5kIGF0XG4gKiBodHRwOi8vcG9seW1lci5naXRodWIuaW8vQ09OVFJJQlVUT1JTLnR4dFxuICogQ29kZSBkaXN0cmlidXRlZCBieSBHb29nbGUgYXMgcGFydCBvZiB0aGUgcG9seW1lciBwcm9qZWN0IGlzIGFsc29cbiAqIHN1YmplY3QgdG8gYW4gYWRkaXRpb25hbCBJUCByaWdodHMgZ3JhbnQgZm91bmQgYXRcbiAqIGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9QQVRFTlRTLnR4dFxuICovXG52YXIgX2E7XG4vKipcbiAqIFdoZW4gdXNpbmcgQ2xvc3VyZSBDb21waWxlciwgSlNDb21waWxlcl9yZW5hbWVQcm9wZXJ0eShwcm9wZXJ0eSwgb2JqZWN0KSBpc1xuICogcmVwbGFjZWQgYXQgY29tcGlsZSB0aW1lIGJ5IHRoZSBtdW5nZWQgbmFtZSBmb3Igb2JqZWN0W3Byb3BlcnR5XS4gV2UgY2Fubm90XG4gKiBhbGlhcyB0aGlzIGZ1bmN0aW9uLCBzbyB3ZSBoYXZlIHRvIHVzZSBhIHNtYWxsIHNoaW0gdGhhdCBoYXMgdGhlIHNhbWVcbiAqIGJlaGF2aW9yIHdoZW4gbm90IGNvbXBpbGluZy5cbiAqL1xud2luZG93LkpTQ29tcGlsZXJfcmVuYW1lUHJvcGVydHkgPVxuICAgIChwcm9wLCBfb2JqKSA9PiBwcm9wO1xuZXhwb3J0IGNvbnN0IGRlZmF1bHRDb252ZXJ0ZXIgPSB7XG4gICAgdG9BdHRyaWJ1dGUodmFsdWUsIHR5cGUpIHtcbiAgICAgICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgICAgICBjYXNlIEJvb2xlYW46XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlID8gJycgOiBudWxsO1xuICAgICAgICAgICAgY2FzZSBPYmplY3Q6XG4gICAgICAgICAgICBjYXNlIEFycmF5OlxuICAgICAgICAgICAgICAgIC8vIGlmIHRoZSB2YWx1ZSBpcyBgbnVsbGAgb3IgYHVuZGVmaW5lZGAgcGFzcyB0aGlzIHRocm91Z2hcbiAgICAgICAgICAgICAgICAvLyB0byBhbGxvdyByZW1vdmluZy9ubyBjaGFuZ2UgYmVoYXZpb3IuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlID09IG51bGwgPyB2YWx1ZSA6IEpTT04uc3RyaW5naWZ5KHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbiAgICBmcm9tQXR0cmlidXRlKHZhbHVlLCB0eXBlKSB7XG4gICAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICAgICAgY2FzZSBCb29sZWFuOlxuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZSAhPT0gbnVsbDtcbiAgICAgICAgICAgIGNhc2UgTnVtYmVyOlxuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZSA9PT0gbnVsbCA/IG51bGwgOiBOdW1iZXIodmFsdWUpO1xuICAgICAgICAgICAgY2FzZSBPYmplY3Q6XG4gICAgICAgICAgICBjYXNlIEFycmF5OlxuICAgICAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxufTtcbi8qKlxuICogQ2hhbmdlIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0cnVlIGlmIGB2YWx1ZWAgaXMgZGlmZmVyZW50IGZyb20gYG9sZFZhbHVlYC5cbiAqIFRoaXMgbWV0aG9kIGlzIHVzZWQgYXMgdGhlIGRlZmF1bHQgZm9yIGEgcHJvcGVydHkncyBgaGFzQ2hhbmdlZGAgZnVuY3Rpb24uXG4gKi9cbmV4cG9ydCBjb25zdCBub3RFcXVhbCA9ICh2YWx1ZSwgb2xkKSA9PiB7XG4gICAgLy8gVGhpcyBlbnN1cmVzIChvbGQ9PU5hTiwgdmFsdWU9PU5hTikgYWx3YXlzIHJldHVybnMgZmFsc2VcbiAgICByZXR1cm4gb2xkICE9PSB2YWx1ZSAmJiAob2xkID09PSBvbGQgfHwgdmFsdWUgPT09IHZhbHVlKTtcbn07XG5jb25zdCBkZWZhdWx0UHJvcGVydHlEZWNsYXJhdGlvbiA9IHtcbiAgICBhdHRyaWJ1dGU6IHRydWUsXG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGNvbnZlcnRlcjogZGVmYXVsdENvbnZlcnRlcixcbiAgICByZWZsZWN0OiBmYWxzZSxcbiAgICBoYXNDaGFuZ2VkOiBub3RFcXVhbFxufTtcbmNvbnN0IFNUQVRFX0hBU19VUERBVEVEID0gMTtcbmNvbnN0IFNUQVRFX1VQREFURV9SRVFVRVNURUQgPSAxIDw8IDI7XG5jb25zdCBTVEFURV9JU19SRUZMRUNUSU5HX1RPX0FUVFJJQlVURSA9IDEgPDwgMztcbmNvbnN0IFNUQVRFX0lTX1JFRkxFQ1RJTkdfVE9fUFJPUEVSVFkgPSAxIDw8IDQ7XG4vKipcbiAqIFRoZSBDbG9zdXJlIEpTIENvbXBpbGVyIGRvZXNuJ3QgY3VycmVudGx5IGhhdmUgZ29vZCBzdXBwb3J0IGZvciBzdGF0aWNcbiAqIHByb3BlcnR5IHNlbWFudGljcyB3aGVyZSBcInRoaXNcIiBpcyBkeW5hbWljIChlLmcuXG4gKiBodHRwczovL2dpdGh1Yi5jb20vZ29vZ2xlL2Nsb3N1cmUtY29tcGlsZXIvaXNzdWVzLzMxNzcgYW5kIG90aGVycykgc28gd2UgdXNlXG4gKiB0aGlzIGhhY2sgdG8gYnlwYXNzIGFueSByZXdyaXRpbmcgYnkgdGhlIGNvbXBpbGVyLlxuICovXG5jb25zdCBmaW5hbGl6ZWQgPSAnZmluYWxpemVkJztcbi8qKlxuICogQmFzZSBlbGVtZW50IGNsYXNzIHdoaWNoIG1hbmFnZXMgZWxlbWVudCBwcm9wZXJ0aWVzIGFuZCBhdHRyaWJ1dGVzLiBXaGVuXG4gKiBwcm9wZXJ0aWVzIGNoYW5nZSwgdGhlIGB1cGRhdGVgIG1ldGhvZCBpcyBhc3luY2hyb25vdXNseSBjYWxsZWQuIFRoaXMgbWV0aG9kXG4gKiBzaG91bGQgYmUgc3VwcGxpZWQgYnkgc3ViY2xhc3NlcnMgdG8gcmVuZGVyIHVwZGF0ZXMgYXMgZGVzaXJlZC5cbiAqL1xuZXhwb3J0IGNsYXNzIFVwZGF0aW5nRWxlbWVudCBleHRlbmRzIEhUTUxFbGVtZW50IHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5fdXBkYXRlU3RhdGUgPSAwO1xuICAgICAgICB0aGlzLl9pbnN0YW5jZVByb3BlcnRpZXMgPSB1bmRlZmluZWQ7XG4gICAgICAgIC8vIEluaXRpYWxpemUgdG8gYW4gdW5yZXNvbHZlZCBQcm9taXNlIHNvIHdlIGNhbiBtYWtlIHN1cmUgdGhlIGVsZW1lbnQgaGFzXG4gICAgICAgIC8vIGNvbm5lY3RlZCBiZWZvcmUgZmlyc3QgdXBkYXRlLlxuICAgICAgICB0aGlzLl91cGRhdGVQcm9taXNlID0gbmV3IFByb21pc2UoKHJlcykgPT4gdGhpcy5fZW5hYmxlVXBkYXRpbmdSZXNvbHZlciA9IHJlcyk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNYXAgd2l0aCBrZXlzIGZvciBhbnkgcHJvcGVydGllcyB0aGF0IGhhdmUgY2hhbmdlZCBzaW5jZSB0aGUgbGFzdFxuICAgICAgICAgKiB1cGRhdGUgY3ljbGUgd2l0aCBwcmV2aW91cyB2YWx1ZXMuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9jaGFuZ2VkUHJvcGVydGllcyA9IG5ldyBNYXAoKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1hcCB3aXRoIGtleXMgb2YgcHJvcGVydGllcyB0aGF0IHNob3VsZCBiZSByZWZsZWN0ZWQgd2hlbiB1cGRhdGVkLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fcmVmbGVjdGluZ1Byb3BlcnRpZXMgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbGlzdCBvZiBhdHRyaWJ1dGVzIGNvcnJlc3BvbmRpbmcgdG8gdGhlIHJlZ2lzdGVyZWQgcHJvcGVydGllcy5cbiAgICAgKiBAbm9jb2xsYXBzZVxuICAgICAqL1xuICAgIHN0YXRpYyBnZXQgb2JzZXJ2ZWRBdHRyaWJ1dGVzKCkge1xuICAgICAgICAvLyBub3RlOiBwaWdneSBiYWNraW5nIG9uIHRoaXMgdG8gZW5zdXJlIHdlJ3JlIGZpbmFsaXplZC5cbiAgICAgICAgdGhpcy5maW5hbGl6ZSgpO1xuICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0gW107XG4gICAgICAgIC8vIFVzZSBmb3JFYWNoIHNvIHRoaXMgd29ya3MgZXZlbiBpZiBmb3Ivb2YgbG9vcHMgYXJlIGNvbXBpbGVkIHRvIGZvciBsb29wc1xuICAgICAgICAvLyBleHBlY3RpbmcgYXJyYXlzXG4gICAgICAgIHRoaXMuX2NsYXNzUHJvcGVydGllcy5mb3JFYWNoKCh2LCBwKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBhdHRyID0gdGhpcy5fYXR0cmlidXRlTmFtZUZvclByb3BlcnR5KHAsIHYpO1xuICAgICAgICAgICAgaWYgKGF0dHIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2F0dHJpYnV0ZVRvUHJvcGVydHlNYXAuc2V0KGF0dHIsIHApO1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMucHVzaChhdHRyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBhdHRyaWJ1dGVzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFbnN1cmVzIHRoZSBwcml2YXRlIGBfY2xhc3NQcm9wZXJ0aWVzYCBwcm9wZXJ0eSBtZXRhZGF0YSBpcyBjcmVhdGVkLlxuICAgICAqIEluIGFkZGl0aW9uIHRvIGBmaW5hbGl6ZWAgdGhpcyBpcyBhbHNvIGNhbGxlZCBpbiBgY3JlYXRlUHJvcGVydHlgIHRvXG4gICAgICogZW5zdXJlIHRoZSBgQHByb3BlcnR5YCBkZWNvcmF0b3IgY2FuIGFkZCBwcm9wZXJ0eSBtZXRhZGF0YS5cbiAgICAgKi9cbiAgICAvKiogQG5vY29sbGFwc2UgKi9cbiAgICBzdGF0aWMgX2Vuc3VyZUNsYXNzUHJvcGVydGllcygpIHtcbiAgICAgICAgLy8gZW5zdXJlIHByaXZhdGUgc3RvcmFnZSBmb3IgcHJvcGVydHkgZGVjbGFyYXRpb25zLlxuICAgICAgICBpZiAoIXRoaXMuaGFzT3duUHJvcGVydHkoSlNDb21waWxlcl9yZW5hbWVQcm9wZXJ0eSgnX2NsYXNzUHJvcGVydGllcycsIHRoaXMpKSkge1xuICAgICAgICAgICAgdGhpcy5fY2xhc3NQcm9wZXJ0aWVzID0gbmV3IE1hcCgpO1xuICAgICAgICAgICAgLy8gTk9URTogV29ya2Fyb3VuZCBJRTExIG5vdCBzdXBwb3J0aW5nIE1hcCBjb25zdHJ1Y3RvciBhcmd1bWVudC5cbiAgICAgICAgICAgIGNvbnN0IHN1cGVyUHJvcGVydGllcyA9IE9iamVjdC5nZXRQcm90b3R5cGVPZih0aGlzKS5fY2xhc3NQcm9wZXJ0aWVzO1xuICAgICAgICAgICAgaWYgKHN1cGVyUHJvcGVydGllcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgc3VwZXJQcm9wZXJ0aWVzLmZvckVhY2goKHYsIGspID0+IHRoaXMuX2NsYXNzUHJvcGVydGllcy5zZXQoaywgdikpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBwcm9wZXJ0eSBhY2Nlc3NvciBvbiB0aGUgZWxlbWVudCBwcm90b3R5cGUgaWYgb25lIGRvZXMgbm90IGV4aXN0XG4gICAgICogYW5kIHN0b3JlcyBhIFByb3BlcnR5RGVjbGFyYXRpb24gZm9yIHRoZSBwcm9wZXJ0eSB3aXRoIHRoZSBnaXZlbiBvcHRpb25zLlxuICAgICAqIFRoZSBwcm9wZXJ0eSBzZXR0ZXIgY2FsbHMgdGhlIHByb3BlcnR5J3MgYGhhc0NoYW5nZWRgIHByb3BlcnR5IG9wdGlvblxuICAgICAqIG9yIHVzZXMgYSBzdHJpY3QgaWRlbnRpdHkgY2hlY2sgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgb3Igbm90IHRvIHJlcXVlc3RcbiAgICAgKiBhbiB1cGRhdGUuXG4gICAgICpcbiAgICAgKiBUaGlzIG1ldGhvZCBtYXkgYmUgb3ZlcnJpZGRlbiB0byBjdXN0b21pemUgcHJvcGVydGllczsgaG93ZXZlcixcbiAgICAgKiB3aGVuIGRvaW5nIHNvLCBpdCdzIGltcG9ydGFudCB0byBjYWxsIGBzdXBlci5jcmVhdGVQcm9wZXJ0eWAgdG8gZW5zdXJlXG4gICAgICogdGhlIHByb3BlcnR5IGlzIHNldHVwIGNvcnJlY3RseS4gVGhpcyBtZXRob2QgY2FsbHNcbiAgICAgKiBgZ2V0UHJvcGVydHlEZXNjcmlwdG9yYCBpbnRlcm5hbGx5IHRvIGdldCBhIGRlc2NyaXB0b3IgdG8gaW5zdGFsbC5cbiAgICAgKiBUbyBjdXN0b21pemUgd2hhdCBwcm9wZXJ0aWVzIGRvIHdoZW4gdGhleSBhcmUgZ2V0IG9yIHNldCwgb3ZlcnJpZGVcbiAgICAgKiBgZ2V0UHJvcGVydHlEZXNjcmlwdG9yYC4gVG8gY3VzdG9taXplIHRoZSBvcHRpb25zIGZvciBhIHByb3BlcnR5LFxuICAgICAqIGltcGxlbWVudCBgY3JlYXRlUHJvcGVydHlgIGxpa2UgdGhpczpcbiAgICAgKlxuICAgICAqIHN0YXRpYyBjcmVhdGVQcm9wZXJ0eShuYW1lLCBvcHRpb25zKSB7XG4gICAgICogICBvcHRpb25zID0gT2JqZWN0LmFzc2lnbihvcHRpb25zLCB7bXlPcHRpb246IHRydWV9KTtcbiAgICAgKiAgIHN1cGVyLmNyZWF0ZVByb3BlcnR5KG5hbWUsIG9wdGlvbnMpO1xuICAgICAqIH1cbiAgICAgKlxuICAgICAqIEBub2NvbGxhcHNlXG4gICAgICovXG4gICAgc3RhdGljIGNyZWF0ZVByb3BlcnR5KG5hbWUsIG9wdGlvbnMgPSBkZWZhdWx0UHJvcGVydHlEZWNsYXJhdGlvbikge1xuICAgICAgICAvLyBOb3RlLCBzaW5jZSB0aGlzIGNhbiBiZSBjYWxsZWQgYnkgdGhlIGBAcHJvcGVydHlgIGRlY29yYXRvciB3aGljaFxuICAgICAgICAvLyBpcyBjYWxsZWQgYmVmb3JlIGBmaW5hbGl6ZWAsIHdlIGVuc3VyZSBzdG9yYWdlIGV4aXN0cyBmb3IgcHJvcGVydHlcbiAgICAgICAgLy8gbWV0YWRhdGEuXG4gICAgICAgIHRoaXMuX2Vuc3VyZUNsYXNzUHJvcGVydGllcygpO1xuICAgICAgICB0aGlzLl9jbGFzc1Byb3BlcnRpZXMuc2V0KG5hbWUsIG9wdGlvbnMpO1xuICAgICAgICAvLyBEbyBub3QgZ2VuZXJhdGUgYW4gYWNjZXNzb3IgaWYgdGhlIHByb3RvdHlwZSBhbHJlYWR5IGhhcyBvbmUsIHNpbmNlXG4gICAgICAgIC8vIGl0IHdvdWxkIGJlIGxvc3Qgb3RoZXJ3aXNlIGFuZCB0aGF0IHdvdWxkIG5ldmVyIGJlIHRoZSB1c2VyJ3MgaW50ZW50aW9uO1xuICAgICAgICAvLyBJbnN0ZWFkLCB3ZSBleHBlY3QgdXNlcnMgdG8gY2FsbCBgcmVxdWVzdFVwZGF0ZWAgdGhlbXNlbHZlcyBmcm9tXG4gICAgICAgIC8vIHVzZXItZGVmaW5lZCBhY2Nlc3NvcnMuIE5vdGUgdGhhdCBpZiB0aGUgc3VwZXIgaGFzIGFuIGFjY2Vzc29yIHdlIHdpbGxcbiAgICAgICAgLy8gc3RpbGwgb3ZlcndyaXRlIGl0XG4gICAgICAgIGlmIChvcHRpb25zLm5vQWNjZXNzb3IgfHwgdGhpcy5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkobmFtZSkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBrZXkgPSB0eXBlb2YgbmFtZSA9PT0gJ3N5bWJvbCcgPyBTeW1ib2woKSA6IGBfXyR7bmFtZX1gO1xuICAgICAgICBjb25zdCBkZXNjcmlwdG9yID0gdGhpcy5nZXRQcm9wZXJ0eURlc2NyaXB0b3IobmFtZSwga2V5LCBvcHRpb25zKTtcbiAgICAgICAgaWYgKGRlc2NyaXB0b3IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMucHJvdG90eXBlLCBuYW1lLCBkZXNjcmlwdG9yKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgcHJvcGVydHkgZGVzY3JpcHRvciB0byBiZSBkZWZpbmVkIG9uIHRoZSBnaXZlbiBuYW1lZCBwcm9wZXJ0eS5cbiAgICAgKiBJZiBubyBkZXNjcmlwdG9yIGlzIHJldHVybmVkLCB0aGUgcHJvcGVydHkgd2lsbCBub3QgYmVjb21lIGFuIGFjY2Vzc29yLlxuICAgICAqIEZvciBleGFtcGxlLFxuICAgICAqXG4gICAgICogICBjbGFzcyBNeUVsZW1lbnQgZXh0ZW5kcyBMaXRFbGVtZW50IHtcbiAgICAgKiAgICAgc3RhdGljIGdldFByb3BlcnR5RGVzY3JpcHRvcihuYW1lLCBrZXksIG9wdGlvbnMpIHtcbiAgICAgKiAgICAgICBjb25zdCBkZWZhdWx0RGVzY3JpcHRvciA9XG4gICAgICogICAgICAgICAgIHN1cGVyLmdldFByb3BlcnR5RGVzY3JpcHRvcihuYW1lLCBrZXksIG9wdGlvbnMpO1xuICAgICAqICAgICAgIGNvbnN0IHNldHRlciA9IGRlZmF1bHREZXNjcmlwdG9yLnNldDtcbiAgICAgKiAgICAgICByZXR1cm4ge1xuICAgICAqICAgICAgICAgZ2V0OiBkZWZhdWx0RGVzY3JpcHRvci5nZXQsXG4gICAgICogICAgICAgICBzZXQodmFsdWUpIHtcbiAgICAgKiAgICAgICAgICAgc2V0dGVyLmNhbGwodGhpcywgdmFsdWUpO1xuICAgICAqICAgICAgICAgICAvLyBjdXN0b20gYWN0aW9uLlxuICAgICAqICAgICAgICAgfSxcbiAgICAgKiAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgKiAgICAgICAgIGVudW1lcmFibGU6IHRydWVcbiAgICAgKiAgICAgICB9XG4gICAgICogICAgIH1cbiAgICAgKiAgIH1cbiAgICAgKlxuICAgICAqIEBub2NvbGxhcHNlXG4gICAgICovXG4gICAgc3RhdGljIGdldFByb3BlcnR5RGVzY3JpcHRvcihuYW1lLCBrZXksIF9vcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tYW55IG5vIHN5bWJvbCBpbiBpbmRleFxuICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzW2tleV07XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgb2xkVmFsdWUgPSB0aGlzW25hbWVdO1xuICAgICAgICAgICAgICAgIHRoaXNba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlcXVlc3RVcGRhdGUobmFtZSwgb2xkVmFsdWUpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWVcbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgcHJvcGVydHkgb3B0aW9ucyBhc3NvY2lhdGVkIHdpdGggdGhlIGdpdmVuIHByb3BlcnR5LlxuICAgICAqIFRoZXNlIG9wdGlvbnMgYXJlIGRlZmluZWQgd2l0aCBhIFByb3BlcnR5RGVjbGFyYXRpb24gdmlhIHRoZSBgcHJvcGVydGllc2BcbiAgICAgKiBvYmplY3Qgb3IgdGhlIGBAcHJvcGVydHlgIGRlY29yYXRvciBhbmQgYXJlIHJlZ2lzdGVyZWQgaW5cbiAgICAgKiBgY3JlYXRlUHJvcGVydHkoLi4uKWAuXG4gICAgICpcbiAgICAgKiBOb3RlLCB0aGlzIG1ldGhvZCBzaG91bGQgYmUgY29uc2lkZXJlZCBcImZpbmFsXCIgYW5kIG5vdCBvdmVycmlkZGVuLiBUb1xuICAgICAqIGN1c3RvbWl6ZSB0aGUgb3B0aW9ucyBmb3IgYSBnaXZlbiBwcm9wZXJ0eSwgb3ZlcnJpZGUgYGNyZWF0ZVByb3BlcnR5YC5cbiAgICAgKlxuICAgICAqIEBub2NvbGxhcHNlXG4gICAgICogQGZpbmFsXG4gICAgICovXG4gICAgc3RhdGljIGdldFByb3BlcnR5T3B0aW9ucyhuYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jbGFzc1Byb3BlcnRpZXMgJiYgdGhpcy5fY2xhc3NQcm9wZXJ0aWVzLmdldChuYW1lKSB8fFxuICAgICAgICAgICAgZGVmYXVsdFByb3BlcnR5RGVjbGFyYXRpb247XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgcHJvcGVydHkgYWNjZXNzb3JzIGZvciByZWdpc3RlcmVkIHByb3BlcnRpZXMgYW5kIGVuc3VyZXNcbiAgICAgKiBhbnkgc3VwZXJjbGFzc2VzIGFyZSBhbHNvIGZpbmFsaXplZC5cbiAgICAgKiBAbm9jb2xsYXBzZVxuICAgICAqL1xuICAgIHN0YXRpYyBmaW5hbGl6ZSgpIHtcbiAgICAgICAgLy8gZmluYWxpemUgYW55IHN1cGVyY2xhc3Nlc1xuICAgICAgICBjb25zdCBzdXBlckN0b3IgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YodGhpcyk7XG4gICAgICAgIGlmICghc3VwZXJDdG9yLmhhc093blByb3BlcnR5KGZpbmFsaXplZCkpIHtcbiAgICAgICAgICAgIHN1cGVyQ3Rvci5maW5hbGl6ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXNbZmluYWxpemVkXSA9IHRydWU7XG4gICAgICAgIHRoaXMuX2Vuc3VyZUNsYXNzUHJvcGVydGllcygpO1xuICAgICAgICAvLyBpbml0aWFsaXplIE1hcCBwb3B1bGF0ZWQgaW4gb2JzZXJ2ZWRBdHRyaWJ1dGVzXG4gICAgICAgIHRoaXMuX2F0dHJpYnV0ZVRvUHJvcGVydHlNYXAgPSBuZXcgTWFwKCk7XG4gICAgICAgIC8vIG1ha2UgYW55IHByb3BlcnRpZXNcbiAgICAgICAgLy8gTm90ZSwgb25seSBwcm9jZXNzIFwib3duXCIgcHJvcGVydGllcyBzaW5jZSB0aGlzIGVsZW1lbnQgd2lsbCBpbmhlcml0XG4gICAgICAgIC8vIGFueSBwcm9wZXJ0aWVzIGRlZmluZWQgb24gdGhlIHN1cGVyQ2xhc3MsIGFuZCBmaW5hbGl6YXRpb24gZW5zdXJlc1xuICAgICAgICAvLyB0aGUgZW50aXJlIHByb3RvdHlwZSBjaGFpbiBpcyBmaW5hbGl6ZWQuXG4gICAgICAgIGlmICh0aGlzLmhhc093blByb3BlcnR5KEpTQ29tcGlsZXJfcmVuYW1lUHJvcGVydHkoJ3Byb3BlcnRpZXMnLCB0aGlzKSkpIHtcbiAgICAgICAgICAgIGNvbnN0IHByb3BzID0gdGhpcy5wcm9wZXJ0aWVzO1xuICAgICAgICAgICAgLy8gc3VwcG9ydCBzeW1ib2xzIGluIHByb3BlcnRpZXMgKElFMTEgZG9lcyBub3Qgc3VwcG9ydCB0aGlzKVxuICAgICAgICAgICAgY29uc3QgcHJvcEtleXMgPSBbXG4gICAgICAgICAgICAgICAgLi4uT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMocHJvcHMpLFxuICAgICAgICAgICAgICAgIC4uLih0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gJ2Z1bmN0aW9uJykgP1xuICAgICAgICAgICAgICAgICAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHByb3BzKSA6XG4gICAgICAgICAgICAgICAgICAgIFtdXG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAgLy8gVGhpcyBmb3Ivb2YgaXMgb2sgYmVjYXVzZSBwcm9wS2V5cyBpcyBhbiBhcnJheVxuICAgICAgICAgICAgZm9yIChjb25zdCBwIG9mIHByb3BLZXlzKSB7XG4gICAgICAgICAgICAgICAgLy8gbm90ZSwgdXNlIG9mIGBhbnlgIGlzIGR1ZSB0byBUeXBlU3JpcHQgbGFjayBvZiBzdXBwb3J0IGZvciBzeW1ib2wgaW5cbiAgICAgICAgICAgICAgICAvLyBpbmRleCB0eXBlc1xuICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1hbnkgbm8gc3ltYm9sIGluIGluZGV4XG4gICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVQcm9wZXJ0eShwLCBwcm9wc1twXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgcHJvcGVydHkgbmFtZSBmb3IgdGhlIGdpdmVuIGF0dHJpYnV0ZSBgbmFtZWAuXG4gICAgICogQG5vY29sbGFwc2VcbiAgICAgKi9cbiAgICBzdGF0aWMgX2F0dHJpYnV0ZU5hbWVGb3JQcm9wZXJ0eShuYW1lLCBvcHRpb25zKSB7XG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZSA9IG9wdGlvbnMuYXR0cmlidXRlO1xuICAgICAgICByZXR1cm4gYXR0cmlidXRlID09PSBmYWxzZSA/XG4gICAgICAgICAgICB1bmRlZmluZWQgOlxuICAgICAgICAgICAgKHR5cGVvZiBhdHRyaWJ1dGUgPT09ICdzdHJpbmcnID9cbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGUgOlxuICAgICAgICAgICAgICAgICh0eXBlb2YgbmFtZSA9PT0gJ3N0cmluZycgPyBuYW1lLnRvTG93ZXJDYXNlKCkgOiB1bmRlZmluZWQpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIGEgcHJvcGVydHkgc2hvdWxkIHJlcXVlc3QgYW4gdXBkYXRlLlxuICAgICAqIENhbGxlZCB3aGVuIGEgcHJvcGVydHkgdmFsdWUgaXMgc2V0IGFuZCB1c2VzIHRoZSBgaGFzQ2hhbmdlZGBcbiAgICAgKiBvcHRpb24gZm9yIHRoZSBwcm9wZXJ0eSBpZiBwcmVzZW50IG9yIGEgc3RyaWN0IGlkZW50aXR5IGNoZWNrLlxuICAgICAqIEBub2NvbGxhcHNlXG4gICAgICovXG4gICAgc3RhdGljIF92YWx1ZUhhc0NoYW5nZWQodmFsdWUsIG9sZCwgaGFzQ2hhbmdlZCA9IG5vdEVxdWFsKSB7XG4gICAgICAgIHJldHVybiBoYXNDaGFuZ2VkKHZhbHVlLCBvbGQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBwcm9wZXJ0eSB2YWx1ZSBmb3IgdGhlIGdpdmVuIGF0dHJpYnV0ZSB2YWx1ZS5cbiAgICAgKiBDYWxsZWQgdmlhIHRoZSBgYXR0cmlidXRlQ2hhbmdlZENhbGxiYWNrYCBhbmQgdXNlcyB0aGUgcHJvcGVydHknc1xuICAgICAqIGBjb252ZXJ0ZXJgIG9yIGBjb252ZXJ0ZXIuZnJvbUF0dHJpYnV0ZWAgcHJvcGVydHkgb3B0aW9uLlxuICAgICAqIEBub2NvbGxhcHNlXG4gICAgICovXG4gICAgc3RhdGljIF9wcm9wZXJ0eVZhbHVlRnJvbUF0dHJpYnV0ZSh2YWx1ZSwgb3B0aW9ucykge1xuICAgICAgICBjb25zdCB0eXBlID0gb3B0aW9ucy50eXBlO1xuICAgICAgICBjb25zdCBjb252ZXJ0ZXIgPSBvcHRpb25zLmNvbnZlcnRlciB8fCBkZWZhdWx0Q29udmVydGVyO1xuICAgICAgICBjb25zdCBmcm9tQXR0cmlidXRlID0gKHR5cGVvZiBjb252ZXJ0ZXIgPT09ICdmdW5jdGlvbicgPyBjb252ZXJ0ZXIgOiBjb252ZXJ0ZXIuZnJvbUF0dHJpYnV0ZSk7XG4gICAgICAgIHJldHVybiBmcm9tQXR0cmlidXRlID8gZnJvbUF0dHJpYnV0ZSh2YWx1ZSwgdHlwZSkgOiB2YWx1ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgYXR0cmlidXRlIHZhbHVlIGZvciB0aGUgZ2l2ZW4gcHJvcGVydHkgdmFsdWUuIElmIHRoaXNcbiAgICAgKiByZXR1cm5zIHVuZGVmaW5lZCwgdGhlIHByb3BlcnR5IHdpbGwgKm5vdCogYmUgcmVmbGVjdGVkIHRvIGFuIGF0dHJpYnV0ZS5cbiAgICAgKiBJZiB0aGlzIHJldHVybnMgbnVsbCwgdGhlIGF0dHJpYnV0ZSB3aWxsIGJlIHJlbW92ZWQsIG90aGVyd2lzZSB0aGVcbiAgICAgKiBhdHRyaWJ1dGUgd2lsbCBiZSBzZXQgdG8gdGhlIHZhbHVlLlxuICAgICAqIFRoaXMgdXNlcyB0aGUgcHJvcGVydHkncyBgcmVmbGVjdGAgYW5kIGB0eXBlLnRvQXR0cmlidXRlYCBwcm9wZXJ0eSBvcHRpb25zLlxuICAgICAqIEBub2NvbGxhcHNlXG4gICAgICovXG4gICAgc3RhdGljIF9wcm9wZXJ0eVZhbHVlVG9BdHRyaWJ1dGUodmFsdWUsIG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMucmVmbGVjdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdHlwZSA9IG9wdGlvbnMudHlwZTtcbiAgICAgICAgY29uc3QgY29udmVydGVyID0gb3B0aW9ucy5jb252ZXJ0ZXI7XG4gICAgICAgIGNvbnN0IHRvQXR0cmlidXRlID0gY29udmVydGVyICYmIGNvbnZlcnRlci50b0F0dHJpYnV0ZSB8fFxuICAgICAgICAgICAgZGVmYXVsdENvbnZlcnRlci50b0F0dHJpYnV0ZTtcbiAgICAgICAgcmV0dXJuIHRvQXR0cmlidXRlKHZhbHVlLCB0eXBlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGVyZm9ybXMgZWxlbWVudCBpbml0aWFsaXphdGlvbi4gQnkgZGVmYXVsdCBjYXB0dXJlcyBhbnkgcHJlLXNldCB2YWx1ZXMgZm9yXG4gICAgICogcmVnaXN0ZXJlZCBwcm9wZXJ0aWVzLlxuICAgICAqL1xuICAgIGluaXRpYWxpemUoKSB7XG4gICAgICAgIHRoaXMuX3NhdmVJbnN0YW5jZVByb3BlcnRpZXMoKTtcbiAgICAgICAgLy8gZW5zdXJlcyBmaXJzdCB1cGRhdGUgd2lsbCBiZSBjYXVnaHQgYnkgYW4gZWFybHkgYWNjZXNzIG9mXG4gICAgICAgIC8vIGB1cGRhdGVDb21wbGV0ZWBcbiAgICAgICAgdGhpcy5fcmVxdWVzdFVwZGF0ZSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGaXhlcyBhbnkgcHJvcGVydGllcyBzZXQgb24gdGhlIGluc3RhbmNlIGJlZm9yZSB1cGdyYWRlIHRpbWUuXG4gICAgICogT3RoZXJ3aXNlIHRoZXNlIHdvdWxkIHNoYWRvdyB0aGUgYWNjZXNzb3IgYW5kIGJyZWFrIHRoZXNlIHByb3BlcnRpZXMuXG4gICAgICogVGhlIHByb3BlcnRpZXMgYXJlIHN0b3JlZCBpbiBhIE1hcCB3aGljaCBpcyBwbGF5ZWQgYmFjayBhZnRlciB0aGVcbiAgICAgKiBjb25zdHJ1Y3RvciBydW5zLiBOb3RlLCBvbiB2ZXJ5IG9sZCB2ZXJzaW9ucyBvZiBTYWZhcmkgKDw9OSkgb3IgQ2hyb21lXG4gICAgICogKDw9NDEpLCBwcm9wZXJ0aWVzIGNyZWF0ZWQgZm9yIG5hdGl2ZSBwbGF0Zm9ybSBwcm9wZXJ0aWVzIGxpa2UgKGBpZGAgb3JcbiAgICAgKiBgbmFtZWApIG1heSBub3QgaGF2ZSBkZWZhdWx0IHZhbHVlcyBzZXQgaW4gdGhlIGVsZW1lbnQgY29uc3RydWN0b3IuIE9uXG4gICAgICogdGhlc2UgYnJvd3NlcnMgbmF0aXZlIHByb3BlcnRpZXMgYXBwZWFyIG9uIGluc3RhbmNlcyBhbmQgdGhlcmVmb3JlIHRoZWlyXG4gICAgICogZGVmYXVsdCB2YWx1ZSB3aWxsIG92ZXJ3cml0ZSBhbnkgZWxlbWVudCBkZWZhdWx0IChlLmcuIGlmIHRoZSBlbGVtZW50IHNldHNcbiAgICAgKiB0aGlzLmlkID0gJ2lkJyBpbiB0aGUgY29uc3RydWN0b3IsIHRoZSAnaWQnIHdpbGwgYmVjb21lICcnIHNpbmNlIHRoaXMgaXNcbiAgICAgKiB0aGUgbmF0aXZlIHBsYXRmb3JtIGRlZmF1bHQpLlxuICAgICAqL1xuICAgIF9zYXZlSW5zdGFuY2VQcm9wZXJ0aWVzKCkge1xuICAgICAgICAvLyBVc2UgZm9yRWFjaCBzbyB0aGlzIHdvcmtzIGV2ZW4gaWYgZm9yL29mIGxvb3BzIGFyZSBjb21waWxlZCB0byBmb3IgbG9vcHNcbiAgICAgICAgLy8gZXhwZWN0aW5nIGFycmF5c1xuICAgICAgICB0aGlzLmNvbnN0cnVjdG9yXG4gICAgICAgICAgICAuX2NsYXNzUHJvcGVydGllcy5mb3JFYWNoKChfdiwgcCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuaGFzT3duUHJvcGVydHkocCkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXNbcF07XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXNbcF07XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9pbnN0YW5jZVByb3BlcnRpZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faW5zdGFuY2VQcm9wZXJ0aWVzID0gbmV3IE1hcCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl9pbnN0YW5jZVByb3BlcnRpZXMuc2V0KHAsIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFwcGxpZXMgcHJldmlvdXNseSBzYXZlZCBpbnN0YW5jZSBwcm9wZXJ0aWVzLlxuICAgICAqL1xuICAgIF9hcHBseUluc3RhbmNlUHJvcGVydGllcygpIHtcbiAgICAgICAgLy8gVXNlIGZvckVhY2ggc28gdGhpcyB3b3JrcyBldmVuIGlmIGZvci9vZiBsb29wcyBhcmUgY29tcGlsZWQgdG8gZm9yIGxvb3BzXG4gICAgICAgIC8vIGV4cGVjdGluZyBhcnJheXNcbiAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWFueVxuICAgICAgICB0aGlzLl9pbnN0YW5jZVByb3BlcnRpZXMuZm9yRWFjaCgodiwgcCkgPT4gdGhpc1twXSA9IHYpO1xuICAgICAgICB0aGlzLl9pbnN0YW5jZVByb3BlcnRpZXMgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGNvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgICAgICAvLyBFbnN1cmUgZmlyc3QgY29ubmVjdGlvbiBjb21wbGV0ZXMgYW4gdXBkYXRlLiBVcGRhdGVzIGNhbm5vdCBjb21wbGV0ZVxuICAgICAgICAvLyBiZWZvcmUgY29ubmVjdGlvbi5cbiAgICAgICAgdGhpcy5lbmFibGVVcGRhdGluZygpO1xuICAgIH1cbiAgICBlbmFibGVVcGRhdGluZygpIHtcbiAgICAgICAgaWYgKHRoaXMuX2VuYWJsZVVwZGF0aW5nUmVzb2x2ZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5fZW5hYmxlVXBkYXRpbmdSZXNvbHZlcigpO1xuICAgICAgICAgICAgdGhpcy5fZW5hYmxlVXBkYXRpbmdSZXNvbHZlciA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBBbGxvd3MgZm9yIGBzdXBlci5kaXNjb25uZWN0ZWRDYWxsYmFjaygpYCBpbiBleHRlbnNpb25zIHdoaWxlXG4gICAgICogcmVzZXJ2aW5nIHRoZSBwb3NzaWJpbGl0eSBvZiBtYWtpbmcgbm9uLWJyZWFraW5nIGZlYXR1cmUgYWRkaXRpb25zXG4gICAgICogd2hlbiBkaXNjb25uZWN0aW5nIGF0IHNvbWUgcG9pbnQgaW4gdGhlIGZ1dHVyZS5cbiAgICAgKi9cbiAgICBkaXNjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3luY2hyb25pemVzIHByb3BlcnR5IHZhbHVlcyB3aGVuIGF0dHJpYnV0ZXMgY2hhbmdlLlxuICAgICAqL1xuICAgIGF0dHJpYnV0ZUNoYW5nZWRDYWxsYmFjayhuYW1lLCBvbGQsIHZhbHVlKSB7XG4gICAgICAgIGlmIChvbGQgIT09IHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLl9hdHRyaWJ1dGVUb1Byb3BlcnR5KG5hbWUsIHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfcHJvcGVydHlUb0F0dHJpYnV0ZShuYW1lLCB2YWx1ZSwgb3B0aW9ucyA9IGRlZmF1bHRQcm9wZXJ0eURlY2xhcmF0aW9uKSB7XG4gICAgICAgIGNvbnN0IGN0b3IgPSB0aGlzLmNvbnN0cnVjdG9yO1xuICAgICAgICBjb25zdCBhdHRyID0gY3Rvci5fYXR0cmlidXRlTmFtZUZvclByb3BlcnR5KG5hbWUsIG9wdGlvbnMpO1xuICAgICAgICBpZiAoYXR0ciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBjb25zdCBhdHRyVmFsdWUgPSBjdG9yLl9wcm9wZXJ0eVZhbHVlVG9BdHRyaWJ1dGUodmFsdWUsIG9wdGlvbnMpO1xuICAgICAgICAgICAgLy8gYW4gdW5kZWZpbmVkIHZhbHVlIGRvZXMgbm90IGNoYW5nZSB0aGUgYXR0cmlidXRlLlxuICAgICAgICAgICAgaWYgKGF0dHJWYWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gVHJhY2sgaWYgdGhlIHByb3BlcnR5IGlzIGJlaW5nIHJlZmxlY3RlZCB0byBhdm9pZFxuICAgICAgICAgICAgLy8gc2V0dGluZyB0aGUgcHJvcGVydHkgYWdhaW4gdmlhIGBhdHRyaWJ1dGVDaGFuZ2VkQ2FsbGJhY2tgLiBOb3RlOlxuICAgICAgICAgICAgLy8gMS4gdGhpcyB0YWtlcyBhZHZhbnRhZ2Ugb2YgdGhlIGZhY3QgdGhhdCB0aGUgY2FsbGJhY2sgaXMgc3luY2hyb25vdXMuXG4gICAgICAgICAgICAvLyAyLiB3aWxsIGJlaGF2ZSBpbmNvcnJlY3RseSBpZiBtdWx0aXBsZSBhdHRyaWJ1dGVzIGFyZSBpbiB0aGUgcmVhY3Rpb25cbiAgICAgICAgICAgIC8vIHN0YWNrIGF0IHRpbWUgb2YgY2FsbGluZy4gSG93ZXZlciwgc2luY2Ugd2UgcHJvY2VzcyBhdHRyaWJ1dGVzXG4gICAgICAgICAgICAvLyBpbiBgdXBkYXRlYCB0aGlzIHNob3VsZCBub3QgYmUgcG9zc2libGUgKG9yIGFuIGV4dHJlbWUgY29ybmVyIGNhc2VcbiAgICAgICAgICAgIC8vIHRoYXQgd2UnZCBsaWtlIHRvIGRpc2NvdmVyKS5cbiAgICAgICAgICAgIC8vIG1hcmsgc3RhdGUgcmVmbGVjdGluZ1xuICAgICAgICAgICAgdGhpcy5fdXBkYXRlU3RhdGUgPSB0aGlzLl91cGRhdGVTdGF0ZSB8IFNUQVRFX0lTX1JFRkxFQ1RJTkdfVE9fQVRUUklCVVRFO1xuICAgICAgICAgICAgaWYgKGF0dHJWYWx1ZSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVBdHRyaWJ1dGUoYXR0cik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldEF0dHJpYnV0ZShhdHRyLCBhdHRyVmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gbWFyayBzdGF0ZSBub3QgcmVmbGVjdGluZ1xuICAgICAgICAgICAgdGhpcy5fdXBkYXRlU3RhdGUgPSB0aGlzLl91cGRhdGVTdGF0ZSAmIH5TVEFURV9JU19SRUZMRUNUSU5HX1RPX0FUVFJJQlVURTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfYXR0cmlidXRlVG9Qcm9wZXJ0eShuYW1lLCB2YWx1ZSkge1xuICAgICAgICAvLyBVc2UgdHJhY2tpbmcgaW5mbyB0byBhdm9pZCBkZXNlcmlhbGl6aW5nIGF0dHJpYnV0ZSB2YWx1ZSBpZiBpdCB3YXNcbiAgICAgICAgLy8ganVzdCBzZXQgZnJvbSBhIHByb3BlcnR5IHNldHRlci5cbiAgICAgICAgaWYgKHRoaXMuX3VwZGF0ZVN0YXRlICYgU1RBVEVfSVNfUkVGTEVDVElOR19UT19BVFRSSUJVVEUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjdG9yID0gdGhpcy5jb25zdHJ1Y3RvcjtcbiAgICAgICAgLy8gTm90ZSwgaGludCB0aGlzIGFzIGFuIGBBdHRyaWJ1dGVNYXBgIHNvIGNsb3N1cmUgY2xlYXJseSB1bmRlcnN0YW5kc1xuICAgICAgICAvLyB0aGUgdHlwZTsgaXQgaGFzIGlzc3VlcyB3aXRoIHRyYWNraW5nIHR5cGVzIHRocm91Z2ggc3RhdGljc1xuICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tdW5uZWNlc3NhcnktdHlwZS1hc3NlcnRpb25cbiAgICAgICAgY29uc3QgcHJvcE5hbWUgPSBjdG9yLl9hdHRyaWJ1dGVUb1Byb3BlcnR5TWFwLmdldChuYW1lKTtcbiAgICAgICAgaWYgKHByb3BOYW1lICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IG9wdGlvbnMgPSBjdG9yLmdldFByb3BlcnR5T3B0aW9ucyhwcm9wTmFtZSk7XG4gICAgICAgICAgICAvLyBtYXJrIHN0YXRlIHJlZmxlY3RpbmdcbiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVN0YXRlID0gdGhpcy5fdXBkYXRlU3RhdGUgfCBTVEFURV9JU19SRUZMRUNUSU5HX1RPX1BST1BFUlRZO1xuICAgICAgICAgICAgdGhpc1twcm9wTmFtZV0gPVxuICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1hbnlcbiAgICAgICAgICAgICAgICBjdG9yLl9wcm9wZXJ0eVZhbHVlRnJvbUF0dHJpYnV0ZSh2YWx1ZSwgb3B0aW9ucyk7XG4gICAgICAgICAgICAvLyBtYXJrIHN0YXRlIG5vdCByZWZsZWN0aW5nXG4gICAgICAgICAgICB0aGlzLl91cGRhdGVTdGF0ZSA9IHRoaXMuX3VwZGF0ZVN0YXRlICYgflNUQVRFX0lTX1JFRkxFQ1RJTkdfVE9fUFJPUEVSVFk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhpcyBwcml2YXRlIHZlcnNpb24gb2YgYHJlcXVlc3RVcGRhdGVgIGRvZXMgbm90IGFjY2VzcyBvciByZXR1cm4gdGhlXG4gICAgICogYHVwZGF0ZUNvbXBsZXRlYCBwcm9taXNlLiBUaGlzIHByb21pc2UgY2FuIGJlIG92ZXJyaWRkZW4gYW5kIGlzIHRoZXJlZm9yZVxuICAgICAqIG5vdCBmcmVlIHRvIGFjY2Vzcy5cbiAgICAgKi9cbiAgICBfcmVxdWVzdFVwZGF0ZShuYW1lLCBvbGRWYWx1ZSkge1xuICAgICAgICBsZXQgc2hvdWxkUmVxdWVzdFVwZGF0ZSA9IHRydWU7XG4gICAgICAgIC8vIElmIHdlIGhhdmUgYSBwcm9wZXJ0eSBrZXksIHBlcmZvcm0gcHJvcGVydHkgdXBkYXRlIHN0ZXBzLlxuICAgICAgICBpZiAobmFtZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBjb25zdCBjdG9yID0gdGhpcy5jb25zdHJ1Y3RvcjtcbiAgICAgICAgICAgIGNvbnN0IG9wdGlvbnMgPSBjdG9yLmdldFByb3BlcnR5T3B0aW9ucyhuYW1lKTtcbiAgICAgICAgICAgIGlmIChjdG9yLl92YWx1ZUhhc0NoYW5nZWQodGhpc1tuYW1lXSwgb2xkVmFsdWUsIG9wdGlvbnMuaGFzQ2hhbmdlZCkpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2NoYW5nZWRQcm9wZXJ0aWVzLmhhcyhuYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jaGFuZ2VkUHJvcGVydGllcy5zZXQobmFtZSwgb2xkVmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBBZGQgdG8gcmVmbGVjdGluZyBwcm9wZXJ0aWVzIHNldC5cbiAgICAgICAgICAgICAgICAvLyBOb3RlLCBpdCdzIGltcG9ydGFudCB0aGF0IGV2ZXJ5IGNoYW5nZSBoYXMgYSBjaGFuY2UgdG8gYWRkIHRoZVxuICAgICAgICAgICAgICAgIC8vIHByb3BlcnR5IHRvIGBfcmVmbGVjdGluZ1Byb3BlcnRpZXNgLiBUaGlzIGVuc3VyZXMgc2V0dGluZ1xuICAgICAgICAgICAgICAgIC8vIGF0dHJpYnV0ZSArIHByb3BlcnR5IHJlZmxlY3RzIGNvcnJlY3RseS5cbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5yZWZsZWN0ID09PSB0cnVlICYmXG4gICAgICAgICAgICAgICAgICAgICEodGhpcy5fdXBkYXRlU3RhdGUgJiBTVEFURV9JU19SRUZMRUNUSU5HX1RPX1BST1BFUlRZKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fcmVmbGVjdGluZ1Byb3BlcnRpZXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVmbGVjdGluZ1Byb3BlcnRpZXMgPSBuZXcgTWFwKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVmbGVjdGluZ1Byb3BlcnRpZXMuc2V0KG5hbWUsIG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIEFib3J0IHRoZSByZXF1ZXN0IGlmIHRoZSBwcm9wZXJ0eSBzaG91bGQgbm90IGJlIGNvbnNpZGVyZWQgY2hhbmdlZC5cbiAgICAgICAgICAgICAgICBzaG91bGRSZXF1ZXN0VXBkYXRlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLl9oYXNSZXF1ZXN0ZWRVcGRhdGUgJiYgc2hvdWxkUmVxdWVzdFVwZGF0ZSkge1xuICAgICAgICAgICAgdGhpcy5fdXBkYXRlUHJvbWlzZSA9IHRoaXMuX2VucXVldWVVcGRhdGUoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXF1ZXN0cyBhbiB1cGRhdGUgd2hpY2ggaXMgcHJvY2Vzc2VkIGFzeW5jaHJvbm91c2x5LiBUaGlzIHNob3VsZFxuICAgICAqIGJlIGNhbGxlZCB3aGVuIGFuIGVsZW1lbnQgc2hvdWxkIHVwZGF0ZSBiYXNlZCBvbiBzb21lIHN0YXRlIG5vdCB0cmlnZ2VyZWRcbiAgICAgKiBieSBzZXR0aW5nIGEgcHJvcGVydHkuIEluIHRoaXMgY2FzZSwgcGFzcyBubyBhcmd1bWVudHMuIEl0IHNob3VsZCBhbHNvIGJlXG4gICAgICogY2FsbGVkIHdoZW4gbWFudWFsbHkgaW1wbGVtZW50aW5nIGEgcHJvcGVydHkgc2V0dGVyLiBJbiB0aGlzIGNhc2UsIHBhc3MgdGhlXG4gICAgICogcHJvcGVydHkgYG5hbWVgIGFuZCBgb2xkVmFsdWVgIHRvIGVuc3VyZSB0aGF0IGFueSBjb25maWd1cmVkIHByb3BlcnR5XG4gICAgICogb3B0aW9ucyBhcmUgaG9ub3JlZC4gUmV0dXJucyB0aGUgYHVwZGF0ZUNvbXBsZXRlYCBQcm9taXNlIHdoaWNoIGlzIHJlc29sdmVkXG4gICAgICogd2hlbiB0aGUgdXBkYXRlIGNvbXBsZXRlcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBuYW1lIHtQcm9wZXJ0eUtleX0gKG9wdGlvbmFsKSBuYW1lIG9mIHJlcXVlc3RpbmcgcHJvcGVydHlcbiAgICAgKiBAcGFyYW0gb2xkVmFsdWUge2FueX0gKG9wdGlvbmFsKSBvbGQgdmFsdWUgb2YgcmVxdWVzdGluZyBwcm9wZXJ0eVxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlfSBBIFByb21pc2UgdGhhdCBpcyByZXNvbHZlZCB3aGVuIHRoZSB1cGRhdGUgY29tcGxldGVzLlxuICAgICAqL1xuICAgIHJlcXVlc3RVcGRhdGUobmFtZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgdGhpcy5fcmVxdWVzdFVwZGF0ZShuYW1lLCBvbGRWYWx1ZSk7XG4gICAgICAgIHJldHVybiB0aGlzLnVwZGF0ZUNvbXBsZXRlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIHVwIHRoZSBlbGVtZW50IHRvIGFzeW5jaHJvbm91c2x5IHVwZGF0ZS5cbiAgICAgKi9cbiAgICBhc3luYyBfZW5xdWV1ZVVwZGF0ZSgpIHtcbiAgICAgICAgdGhpcy5fdXBkYXRlU3RhdGUgPSB0aGlzLl91cGRhdGVTdGF0ZSB8IFNUQVRFX1VQREFURV9SRVFVRVNURUQ7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBFbnN1cmUgYW55IHByZXZpb3VzIHVwZGF0ZSBoYXMgcmVzb2x2ZWQgYmVmb3JlIHVwZGF0aW5nLlxuICAgICAgICAgICAgLy8gVGhpcyBgYXdhaXRgIGFsc28gZW5zdXJlcyB0aGF0IHByb3BlcnR5IGNoYW5nZXMgYXJlIGJhdGNoZWQuXG4gICAgICAgICAgICBhd2FpdCB0aGlzLl91cGRhdGVQcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAvLyBJZ25vcmUgYW55IHByZXZpb3VzIGVycm9ycy4gV2Ugb25seSBjYXJlIHRoYXQgdGhlIHByZXZpb3VzIGN5Y2xlIGlzXG4gICAgICAgICAgICAvLyBkb25lLiBBbnkgZXJyb3Igc2hvdWxkIGhhdmUgYmVlbiBoYW5kbGVkIGluIHRoZSBwcmV2aW91cyB1cGRhdGUuXG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5wZXJmb3JtVXBkYXRlKCk7XG4gICAgICAgIC8vIElmIGBwZXJmb3JtVXBkYXRlYCByZXR1cm5zIGEgUHJvbWlzZSwgd2UgYXdhaXQgaXQuIFRoaXMgaXMgZG9uZSB0b1xuICAgICAgICAvLyBlbmFibGUgY29vcmRpbmF0aW5nIHVwZGF0ZXMgd2l0aCBhIHNjaGVkdWxlci4gTm90ZSwgdGhlIHJlc3VsdCBpc1xuICAgICAgICAvLyBjaGVja2VkIHRvIGF2b2lkIGRlbGF5aW5nIGFuIGFkZGl0aW9uYWwgbWljcm90YXNrIHVubGVzcyB3ZSBuZWVkIHRvLlxuICAgICAgICBpZiAocmVzdWx0ICE9IG51bGwpIHtcbiAgICAgICAgICAgIGF3YWl0IHJlc3VsdDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gIXRoaXMuX2hhc1JlcXVlc3RlZFVwZGF0ZTtcbiAgICB9XG4gICAgZ2V0IF9oYXNSZXF1ZXN0ZWRVcGRhdGUoKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5fdXBkYXRlU3RhdGUgJiBTVEFURV9VUERBVEVfUkVRVUVTVEVEKTtcbiAgICB9XG4gICAgZ2V0IGhhc1VwZGF0ZWQoKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5fdXBkYXRlU3RhdGUgJiBTVEFURV9IQVNfVVBEQVRFRCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBlcmZvcm1zIGFuIGVsZW1lbnQgdXBkYXRlLiBOb3RlLCBpZiBhbiBleGNlcHRpb24gaXMgdGhyb3duIGR1cmluZyB0aGVcbiAgICAgKiB1cGRhdGUsIGBmaXJzdFVwZGF0ZWRgIGFuZCBgdXBkYXRlZGAgd2lsbCBub3QgYmUgY2FsbGVkLlxuICAgICAqXG4gICAgICogWW91IGNhbiBvdmVycmlkZSB0aGlzIG1ldGhvZCB0byBjaGFuZ2UgdGhlIHRpbWluZyBvZiB1cGRhdGVzLiBJZiB0aGlzXG4gICAgICogbWV0aG9kIGlzIG92ZXJyaWRkZW4sIGBzdXBlci5wZXJmb3JtVXBkYXRlKClgIG11c3QgYmUgY2FsbGVkLlxuICAgICAqXG4gICAgICogRm9yIGluc3RhbmNlLCB0byBzY2hlZHVsZSB1cGRhdGVzIHRvIG9jY3VyIGp1c3QgYmVmb3JlIHRoZSBuZXh0IGZyYW1lOlxuICAgICAqXG4gICAgICogYGBgXG4gICAgICogcHJvdGVjdGVkIGFzeW5jIHBlcmZvcm1VcGRhdGUoKTogUHJvbWlzZTx1bmtub3duPiB7XG4gICAgICogICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHJlc29sdmUoKSkpO1xuICAgICAqICAgc3VwZXIucGVyZm9ybVVwZGF0ZSgpO1xuICAgICAqIH1cbiAgICAgKiBgYGBcbiAgICAgKi9cbiAgICBwZXJmb3JtVXBkYXRlKCkge1xuICAgICAgICAvLyBNaXhpbiBpbnN0YW5jZSBwcm9wZXJ0aWVzIG9uY2UsIGlmIHRoZXkgZXhpc3QuXG4gICAgICAgIGlmICh0aGlzLl9pbnN0YW5jZVByb3BlcnRpZXMpIHtcbiAgICAgICAgICAgIHRoaXMuX2FwcGx5SW5zdGFuY2VQcm9wZXJ0aWVzKCk7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHNob3VsZFVwZGF0ZSA9IGZhbHNlO1xuICAgICAgICBjb25zdCBjaGFuZ2VkUHJvcGVydGllcyA9IHRoaXMuX2NoYW5nZWRQcm9wZXJ0aWVzO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgc2hvdWxkVXBkYXRlID0gdGhpcy5zaG91bGRVcGRhdGUoY2hhbmdlZFByb3BlcnRpZXMpO1xuICAgICAgICAgICAgaWYgKHNob3VsZFVwZGF0ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlKGNoYW5nZWRQcm9wZXJ0aWVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX21hcmtVcGRhdGVkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIC8vIFByZXZlbnQgYGZpcnN0VXBkYXRlZGAgYW5kIGB1cGRhdGVkYCBmcm9tIHJ1bm5pbmcgd2hlbiB0aGVyZSdzIGFuXG4gICAgICAgICAgICAvLyB1cGRhdGUgZXhjZXB0aW9uLlxuICAgICAgICAgICAgc2hvdWxkVXBkYXRlID0gZmFsc2U7XG4gICAgICAgICAgICAvLyBFbnN1cmUgZWxlbWVudCBjYW4gYWNjZXB0IGFkZGl0aW9uYWwgdXBkYXRlcyBhZnRlciBhbiBleGNlcHRpb24uXG4gICAgICAgICAgICB0aGlzLl9tYXJrVXBkYXRlZCgpO1xuICAgICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2hvdWxkVXBkYXRlKSB7XG4gICAgICAgICAgICBpZiAoISh0aGlzLl91cGRhdGVTdGF0ZSAmIFNUQVRFX0hBU19VUERBVEVEKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVN0YXRlID0gdGhpcy5fdXBkYXRlU3RhdGUgfCBTVEFURV9IQVNfVVBEQVRFRDtcbiAgICAgICAgICAgICAgICB0aGlzLmZpcnN0VXBkYXRlZChjaGFuZ2VkUHJvcGVydGllcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZWQoY2hhbmdlZFByb3BlcnRpZXMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9tYXJrVXBkYXRlZCgpIHtcbiAgICAgICAgdGhpcy5fY2hhbmdlZFByb3BlcnRpZXMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuX3VwZGF0ZVN0YXRlID0gdGhpcy5fdXBkYXRlU3RhdGUgJiB+U1RBVEVfVVBEQVRFX1JFUVVFU1RFRDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIFByb21pc2UgdGhhdCByZXNvbHZlcyB3aGVuIHRoZSBlbGVtZW50IGhhcyBjb21wbGV0ZWQgdXBkYXRpbmcuXG4gICAgICogVGhlIFByb21pc2UgdmFsdWUgaXMgYSBib29sZWFuIHRoYXQgaXMgYHRydWVgIGlmIHRoZSBlbGVtZW50IGNvbXBsZXRlZCB0aGVcbiAgICAgKiB1cGRhdGUgd2l0aG91dCB0cmlnZ2VyaW5nIGFub3RoZXIgdXBkYXRlLiBUaGUgUHJvbWlzZSByZXN1bHQgaXMgYGZhbHNlYCBpZlxuICAgICAqIGEgcHJvcGVydHkgd2FzIHNldCBpbnNpZGUgYHVwZGF0ZWQoKWAuIElmIHRoZSBQcm9taXNlIGlzIHJlamVjdGVkLCBhblxuICAgICAqIGV4Y2VwdGlvbiB3YXMgdGhyb3duIGR1cmluZyB0aGUgdXBkYXRlLlxuICAgICAqXG4gICAgICogVG8gYXdhaXQgYWRkaXRpb25hbCBhc3luY2hyb25vdXMgd29yaywgb3ZlcnJpZGUgdGhlIGBfZ2V0VXBkYXRlQ29tcGxldGVgXG4gICAgICogbWV0aG9kLiBGb3IgZXhhbXBsZSwgaXQgaXMgc29tZXRpbWVzIHVzZWZ1bCB0byBhd2FpdCBhIHJlbmRlcmVkIGVsZW1lbnRcbiAgICAgKiBiZWZvcmUgZnVsZmlsbGluZyB0aGlzIFByb21pc2UuIFRvIGRvIHRoaXMsIGZpcnN0IGF3YWl0XG4gICAgICogYHN1cGVyLl9nZXRVcGRhdGVDb21wbGV0ZSgpYCwgdGhlbiBhbnkgc3Vic2VxdWVudCBzdGF0ZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlfSBUaGUgUHJvbWlzZSByZXR1cm5zIGEgYm9vbGVhbiB0aGF0IGluZGljYXRlcyBpZiB0aGVcbiAgICAgKiB1cGRhdGUgcmVzb2x2ZWQgd2l0aG91dCB0cmlnZ2VyaW5nIGFub3RoZXIgdXBkYXRlLlxuICAgICAqL1xuICAgIGdldCB1cGRhdGVDb21wbGV0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dldFVwZGF0ZUNvbXBsZXRlKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE92ZXJyaWRlIHBvaW50IGZvciB0aGUgYHVwZGF0ZUNvbXBsZXRlYCBwcm9taXNlLlxuICAgICAqXG4gICAgICogSXQgaXMgbm90IHNhZmUgdG8gb3ZlcnJpZGUgdGhlIGB1cGRhdGVDb21wbGV0ZWAgZ2V0dGVyIGRpcmVjdGx5IGR1ZSB0byBhXG4gICAgICogbGltaXRhdGlvbiBpbiBUeXBlU2NyaXB0IHdoaWNoIG1lYW5zIGl0IGlzIG5vdCBwb3NzaWJsZSB0byBjYWxsIGFcbiAgICAgKiBzdXBlcmNsYXNzIGdldHRlciAoZS5nLiBgc3VwZXIudXBkYXRlQ29tcGxldGUudGhlbiguLi4pYCkgd2hlbiB0aGUgdGFyZ2V0XG4gICAgICogbGFuZ3VhZ2UgaXMgRVM1IChodHRwczovL2dpdGh1Yi5jb20vbWljcm9zb2Z0L1R5cGVTY3JpcHQvaXNzdWVzLzMzOCkuXG4gICAgICogVGhpcyBtZXRob2Qgc2hvdWxkIGJlIG92ZXJyaWRkZW4gaW5zdGVhZC4gRm9yIGV4YW1wbGU6XG4gICAgICpcbiAgICAgKiAgIGNsYXNzIE15RWxlbWVudCBleHRlbmRzIExpdEVsZW1lbnQge1xuICAgICAqICAgICBhc3luYyBfZ2V0VXBkYXRlQ29tcGxldGUoKSB7XG4gICAgICogICAgICAgYXdhaXQgc3VwZXIuX2dldFVwZGF0ZUNvbXBsZXRlKCk7XG4gICAgICogICAgICAgYXdhaXQgdGhpcy5fbXlDaGlsZC51cGRhdGVDb21wbGV0ZTtcbiAgICAgKiAgICAgfVxuICAgICAqICAgfVxuICAgICAqL1xuICAgIF9nZXRVcGRhdGVDb21wbGV0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3VwZGF0ZVByb21pc2U7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbnRyb2xzIHdoZXRoZXIgb3Igbm90IGB1cGRhdGVgIHNob3VsZCBiZSBjYWxsZWQgd2hlbiB0aGUgZWxlbWVudCByZXF1ZXN0c1xuICAgICAqIGFuIHVwZGF0ZS4gQnkgZGVmYXVsdCwgdGhpcyBtZXRob2QgYWx3YXlzIHJldHVybnMgYHRydWVgLCBidXQgdGhpcyBjYW4gYmVcbiAgICAgKiBjdXN0b21pemVkIHRvIGNvbnRyb2wgd2hlbiB0byB1cGRhdGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gX2NoYW5nZWRQcm9wZXJ0aWVzIE1hcCBvZiBjaGFuZ2VkIHByb3BlcnRpZXMgd2l0aCBvbGQgdmFsdWVzXG4gICAgICovXG4gICAgc2hvdWxkVXBkYXRlKF9jaGFuZ2VkUHJvcGVydGllcykge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVXBkYXRlcyB0aGUgZWxlbWVudC4gVGhpcyBtZXRob2QgcmVmbGVjdHMgcHJvcGVydHkgdmFsdWVzIHRvIGF0dHJpYnV0ZXMuXG4gICAgICogSXQgY2FuIGJlIG92ZXJyaWRkZW4gdG8gcmVuZGVyIGFuZCBrZWVwIHVwZGF0ZWQgZWxlbWVudCBET00uXG4gICAgICogU2V0dGluZyBwcm9wZXJ0aWVzIGluc2lkZSB0aGlzIG1ldGhvZCB3aWxsICpub3QqIHRyaWdnZXJcbiAgICAgKiBhbm90aGVyIHVwZGF0ZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBfY2hhbmdlZFByb3BlcnRpZXMgTWFwIG9mIGNoYW5nZWQgcHJvcGVydGllcyB3aXRoIG9sZCB2YWx1ZXNcbiAgICAgKi9cbiAgICB1cGRhdGUoX2NoYW5nZWRQcm9wZXJ0aWVzKSB7XG4gICAgICAgIGlmICh0aGlzLl9yZWZsZWN0aW5nUHJvcGVydGllcyAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICB0aGlzLl9yZWZsZWN0aW5nUHJvcGVydGllcy5zaXplID4gMCkge1xuICAgICAgICAgICAgLy8gVXNlIGZvckVhY2ggc28gdGhpcyB3b3JrcyBldmVuIGlmIGZvci9vZiBsb29wcyBhcmUgY29tcGlsZWQgdG8gZm9yXG4gICAgICAgICAgICAvLyBsb29wcyBleHBlY3RpbmcgYXJyYXlzXG4gICAgICAgICAgICB0aGlzLl9yZWZsZWN0aW5nUHJvcGVydGllcy5mb3JFYWNoKCh2LCBrKSA9PiB0aGlzLl9wcm9wZXJ0eVRvQXR0cmlidXRlKGssIHRoaXNba10sIHYpKTtcbiAgICAgICAgICAgIHRoaXMuX3JlZmxlY3RpbmdQcm9wZXJ0aWVzID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX21hcmtVcGRhdGVkKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEludm9rZWQgd2hlbmV2ZXIgdGhlIGVsZW1lbnQgaXMgdXBkYXRlZC4gSW1wbGVtZW50IHRvIHBlcmZvcm1cbiAgICAgKiBwb3N0LXVwZGF0aW5nIHRhc2tzIHZpYSBET00gQVBJcywgZm9yIGV4YW1wbGUsIGZvY3VzaW5nIGFuIGVsZW1lbnQuXG4gICAgICpcbiAgICAgKiBTZXR0aW5nIHByb3BlcnRpZXMgaW5zaWRlIHRoaXMgbWV0aG9kIHdpbGwgdHJpZ2dlciB0aGUgZWxlbWVudCB0byB1cGRhdGVcbiAgICAgKiBhZ2FpbiBhZnRlciB0aGlzIHVwZGF0ZSBjeWNsZSBjb21wbGV0ZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gX2NoYW5nZWRQcm9wZXJ0aWVzIE1hcCBvZiBjaGFuZ2VkIHByb3BlcnRpZXMgd2l0aCBvbGQgdmFsdWVzXG4gICAgICovXG4gICAgdXBkYXRlZChfY2hhbmdlZFByb3BlcnRpZXMpIHtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW52b2tlZCB3aGVuIHRoZSBlbGVtZW50IGlzIGZpcnN0IHVwZGF0ZWQuIEltcGxlbWVudCB0byBwZXJmb3JtIG9uZSB0aW1lXG4gICAgICogd29yayBvbiB0aGUgZWxlbWVudCBhZnRlciB1cGRhdGUuXG4gICAgICpcbiAgICAgKiBTZXR0aW5nIHByb3BlcnRpZXMgaW5zaWRlIHRoaXMgbWV0aG9kIHdpbGwgdHJpZ2dlciB0aGUgZWxlbWVudCB0byB1cGRhdGVcbiAgICAgKiBhZ2FpbiBhZnRlciB0aGlzIHVwZGF0ZSBjeWNsZSBjb21wbGV0ZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gX2NoYW5nZWRQcm9wZXJ0aWVzIE1hcCBvZiBjaGFuZ2VkIHByb3BlcnRpZXMgd2l0aCBvbGQgdmFsdWVzXG4gICAgICovXG4gICAgZmlyc3RVcGRhdGVkKF9jaGFuZ2VkUHJvcGVydGllcykge1xuICAgIH1cbn1cbl9hID0gZmluYWxpemVkO1xuLyoqXG4gKiBNYXJrcyBjbGFzcyBhcyBoYXZpbmcgZmluaXNoZWQgY3JlYXRpbmcgcHJvcGVydGllcy5cbiAqL1xuVXBkYXRpbmdFbGVtZW50W19hXSA9IHRydWU7XG4vLyMgc291cmNlTWFwcGluZ1VSTD11cGRhdGluZy1lbGVtZW50LmpzLm1hcCIsIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAoYykgMjAxNyBUaGUgUG9seW1lciBQcm9qZWN0IEF1dGhvcnMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiBUaGlzIGNvZGUgbWF5IG9ubHkgYmUgdXNlZCB1bmRlciB0aGUgQlNEIHN0eWxlIGxpY2Vuc2UgZm91bmQgYXRcbiAqIGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9MSUNFTlNFLnR4dFxuICogVGhlIGNvbXBsZXRlIHNldCBvZiBhdXRob3JzIG1heSBiZSBmb3VuZCBhdFxuICogaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0FVVEhPUlMudHh0XG4gKiBUaGUgY29tcGxldGUgc2V0IG9mIGNvbnRyaWJ1dG9ycyBtYXkgYmUgZm91bmQgYXRcbiAqIGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9DT05UUklCVVRPUlMudHh0XG4gKiBDb2RlIGRpc3RyaWJ1dGVkIGJ5IEdvb2dsZSBhcyBwYXJ0IG9mIHRoZSBwb2x5bWVyIHByb2plY3QgaXMgYWxzb1xuICogc3ViamVjdCB0byBhbiBhZGRpdGlvbmFsIElQIHJpZ2h0cyBncmFudCBmb3VuZCBhdFxuICogaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL1BBVEVOVFMudHh0XG4gKi9cbmNvbnN0IGxlZ2FjeUN1c3RvbUVsZW1lbnQgPSAodGFnTmFtZSwgY2xhenopID0+IHtcbiAgICB3aW5kb3cuY3VzdG9tRWxlbWVudHMuZGVmaW5lKHRhZ05hbWUsIGNsYXp6KTtcbiAgICAvLyBDYXN0IGFzIGFueSBiZWNhdXNlIFRTIGRvZXNuJ3QgcmVjb2duaXplIHRoZSByZXR1cm4gdHlwZSBhcyBiZWluZyBhXG4gICAgLy8gc3VidHlwZSBvZiB0aGUgZGVjb3JhdGVkIGNsYXNzIHdoZW4gY2xhenogaXMgdHlwZWQgYXNcbiAgICAvLyBgQ29uc3RydWN0b3I8SFRNTEVsZW1lbnQ+YCBmb3Igc29tZSByZWFzb24uXG4gICAgLy8gYENvbnN0cnVjdG9yPEhUTUxFbGVtZW50PmAgaXMgaGVscGZ1bCB0byBtYWtlIHN1cmUgdGhlIGRlY29yYXRvciBpc1xuICAgIC8vIGFwcGxpZWQgdG8gZWxlbWVudHMgaG93ZXZlci5cbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tYW55XG4gICAgcmV0dXJuIGNsYXp6O1xufTtcbmNvbnN0IHN0YW5kYXJkQ3VzdG9tRWxlbWVudCA9ICh0YWdOYW1lLCBkZXNjcmlwdG9yKSA9PiB7XG4gICAgY29uc3QgeyBraW5kLCBlbGVtZW50cyB9ID0gZGVzY3JpcHRvcjtcbiAgICByZXR1cm4ge1xuICAgICAgICBraW5kLFxuICAgICAgICBlbGVtZW50cyxcbiAgICAgICAgLy8gVGhpcyBjYWxsYmFjayBpcyBjYWxsZWQgb25jZSB0aGUgY2xhc3MgaXMgb3RoZXJ3aXNlIGZ1bGx5IGRlZmluZWRcbiAgICAgICAgZmluaXNoZXIoY2xhenopIHtcbiAgICAgICAgICAgIHdpbmRvdy5jdXN0b21FbGVtZW50cy5kZWZpbmUodGFnTmFtZSwgY2xhenopO1xuICAgICAgICB9XG4gICAgfTtcbn07XG4vKipcbiAqIENsYXNzIGRlY29yYXRvciBmYWN0b3J5IHRoYXQgZGVmaW5lcyB0aGUgZGVjb3JhdGVkIGNsYXNzIGFzIGEgY3VzdG9tIGVsZW1lbnQuXG4gKlxuICogYGBgXG4gKiBAY3VzdG9tRWxlbWVudCgnbXktZWxlbWVudCcpXG4gKiBjbGFzcyBNeUVsZW1lbnQge1xuICogICByZW5kZXIoKSB7XG4gKiAgICAgcmV0dXJuIGh0bWxgYDtcbiAqICAgfVxuICogfVxuICogYGBgXG4gKlxuICogQHBhcmFtIHRhZ05hbWUgVGhlIG5hbWUgb2YgdGhlIGN1c3RvbSBlbGVtZW50IHRvIGRlZmluZS5cbiAqL1xuZXhwb3J0IGNvbnN0IGN1c3RvbUVsZW1lbnQgPSAodGFnTmFtZSkgPT4gKGNsYXNzT3JEZXNjcmlwdG9yKSA9PiAodHlwZW9mIGNsYXNzT3JEZXNjcmlwdG9yID09PSAnZnVuY3Rpb24nKSA/XG4gICAgbGVnYWN5Q3VzdG9tRWxlbWVudCh0YWdOYW1lLCBjbGFzc09yRGVzY3JpcHRvcikgOlxuICAgIHN0YW5kYXJkQ3VzdG9tRWxlbWVudCh0YWdOYW1lLCBjbGFzc09yRGVzY3JpcHRvcik7XG5jb25zdCBzdGFuZGFyZFByb3BlcnR5ID0gKG9wdGlvbnMsIGVsZW1lbnQpID0+IHtcbiAgICAvLyBXaGVuIGRlY29yYXRpbmcgYW4gYWNjZXNzb3IsIHBhc3MgaXQgdGhyb3VnaCBhbmQgYWRkIHByb3BlcnR5IG1ldGFkYXRhLlxuICAgIC8vIE5vdGUsIHRoZSBgaGFzT3duUHJvcGVydHlgIGNoZWNrIGluIGBjcmVhdGVQcm9wZXJ0eWAgZW5zdXJlcyB3ZSBkb24ndFxuICAgIC8vIHN0b21wIG92ZXIgdGhlIHVzZXIncyBhY2Nlc3Nvci5cbiAgICBpZiAoZWxlbWVudC5raW5kID09PSAnbWV0aG9kJyAmJiBlbGVtZW50LmRlc2NyaXB0b3IgJiZcbiAgICAgICAgISgndmFsdWUnIGluIGVsZW1lbnQuZGVzY3JpcHRvcikpIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgZWxlbWVudCksIHsgZmluaXNoZXIoY2xhenopIHtcbiAgICAgICAgICAgICAgICBjbGF6ei5jcmVhdGVQcm9wZXJ0eShlbGVtZW50LmtleSwgb3B0aW9ucyk7XG4gICAgICAgICAgICB9IH0pO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgLy8gY3JlYXRlUHJvcGVydHkoKSB0YWtlcyBjYXJlIG9mIGRlZmluaW5nIHRoZSBwcm9wZXJ0eSwgYnV0IHdlIHN0aWxsXG4gICAgICAgIC8vIG11c3QgcmV0dXJuIHNvbWUga2luZCBvZiBkZXNjcmlwdG9yLCBzbyByZXR1cm4gYSBkZXNjcmlwdG9yIGZvciBhblxuICAgICAgICAvLyB1bnVzZWQgcHJvdG90eXBlIGZpZWxkLiBUaGUgZmluaXNoZXIgY2FsbHMgY3JlYXRlUHJvcGVydHkoKS5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGtpbmQ6ICdmaWVsZCcsXG4gICAgICAgICAgICBrZXk6IFN5bWJvbCgpLFxuICAgICAgICAgICAgcGxhY2VtZW50OiAnb3duJyxcbiAgICAgICAgICAgIGRlc2NyaXB0b3I6IHt9LFxuICAgICAgICAgICAgLy8gV2hlbiBAYmFiZWwvcGx1Z2luLXByb3Bvc2FsLWRlY29yYXRvcnMgaW1wbGVtZW50cyBpbml0aWFsaXplcnMsXG4gICAgICAgICAgICAvLyBkbyB0aGlzIGluc3RlYWQgb2YgdGhlIGluaXRpYWxpemVyIGJlbG93LiBTZWU6XG4gICAgICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vYmFiZWwvYmFiZWwvaXNzdWVzLzkyNjAgZXh0cmFzOiBbXG4gICAgICAgICAgICAvLyAgIHtcbiAgICAgICAgICAgIC8vICAgICBraW5kOiAnaW5pdGlhbGl6ZXInLFxuICAgICAgICAgICAgLy8gICAgIHBsYWNlbWVudDogJ293bicsXG4gICAgICAgICAgICAvLyAgICAgaW5pdGlhbGl6ZXI6IGRlc2NyaXB0b3IuaW5pdGlhbGl6ZXIsXG4gICAgICAgICAgICAvLyAgIH1cbiAgICAgICAgICAgIC8vIF0sXG4gICAgICAgICAgICBpbml0aWFsaXplcigpIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGVsZW1lbnQuaW5pdGlhbGl6ZXIgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1tlbGVtZW50LmtleV0gPSBlbGVtZW50LmluaXRpYWxpemVyLmNhbGwodGhpcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGZpbmlzaGVyKGNsYXp6KSB7XG4gICAgICAgICAgICAgICAgY2xhenouY3JlYXRlUHJvcGVydHkoZWxlbWVudC5rZXksIG9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cbn07XG5jb25zdCBsZWdhY3lQcm9wZXJ0eSA9IChvcHRpb25zLCBwcm90bywgbmFtZSkgPT4ge1xuICAgIHByb3RvLmNvbnN0cnVjdG9yXG4gICAgICAgIC5jcmVhdGVQcm9wZXJ0eShuYW1lLCBvcHRpb25zKTtcbn07XG4vKipcbiAqIEEgcHJvcGVydHkgZGVjb3JhdG9yIHdoaWNoIGNyZWF0ZXMgYSBMaXRFbGVtZW50IHByb3BlcnR5IHdoaWNoIHJlZmxlY3RzIGFcbiAqIGNvcnJlc3BvbmRpbmcgYXR0cmlidXRlIHZhbHVlLiBBIGBQcm9wZXJ0eURlY2xhcmF0aW9uYCBtYXkgb3B0aW9uYWxseSBiZVxuICogc3VwcGxpZWQgdG8gY29uZmlndXJlIHByb3BlcnR5IGZlYXR1cmVzLlxuICpcbiAqIFRoaXMgZGVjb3JhdG9yIHNob3VsZCBvbmx5IGJlIHVzZWQgZm9yIHB1YmxpYyBmaWVsZHMuIFByaXZhdGUgb3IgcHJvdGVjdGVkXG4gKiBmaWVsZHMgc2hvdWxkIHVzZSB0aGUgaW50ZXJuYWxQcm9wZXJ0eSBkZWNvcmF0b3IuXG4gKlxuICogQGV4YW1wbGVcbiAqXG4gKiAgICAgY2xhc3MgTXlFbGVtZW50IHtcbiAqICAgICAgIEBwcm9wZXJ0eSh7IHR5cGU6IEJvb2xlYW4gfSlcbiAqICAgICAgIGNsaWNrZWQgPSBmYWxzZTtcbiAqICAgICB9XG4gKlxuICogQEV4cG9ydERlY29yYXRlZEl0ZW1zXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwcm9wZXJ0eShvcHRpb25zKSB7XG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWFueSBkZWNvcmF0b3JcbiAgICByZXR1cm4gKHByb3RvT3JEZXNjcmlwdG9yLCBuYW1lKSA9PiAobmFtZSAhPT0gdW5kZWZpbmVkKSA/XG4gICAgICAgIGxlZ2FjeVByb3BlcnR5KG9wdGlvbnMsIHByb3RvT3JEZXNjcmlwdG9yLCBuYW1lKSA6XG4gICAgICAgIHN0YW5kYXJkUHJvcGVydHkob3B0aW9ucywgcHJvdG9PckRlc2NyaXB0b3IpO1xufVxuLyoqXG4gKiBEZWNsYXJlcyBhIHByaXZhdGUgb3IgcHJvdGVjdGVkIHByb3BlcnR5IHRoYXQgc3RpbGwgdHJpZ2dlcnMgdXBkYXRlcyB0byB0aGVcbiAqIGVsZW1lbnQgd2hlbiBpdCBjaGFuZ2VzLlxuICpcbiAqIFByb3BlcnRpZXMgZGVjbGFyZWQgdGhpcyB3YXkgbXVzdCBub3QgYmUgdXNlZCBmcm9tIEhUTUwgb3IgSFRNTCB0ZW1wbGF0aW5nXG4gKiBzeXN0ZW1zLCB0aGV5J3JlIHNvbGVseSBmb3IgcHJvcGVydGllcyBpbnRlcm5hbCB0byB0aGUgZWxlbWVudC4gVGhlc2VcbiAqIHByb3BlcnRpZXMgbWF5IGJlIHJlbmFtZWQgYnkgb3B0aW1pemF0aW9uIHRvb2xzIGxpa2UgY2xvc3VyZSBjb21waWxlci5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGludGVybmFsUHJvcGVydHkob3B0aW9ucykge1xuICAgIHJldHVybiBwcm9wZXJ0eSh7IGF0dHJpYnV0ZTogZmFsc2UsIGhhc0NoYW5nZWQ6IG9wdGlvbnMgPT09IG51bGwgfHwgb3B0aW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogb3B0aW9ucy5oYXNDaGFuZ2VkIH0pO1xufVxuLyoqXG4gKiBBIHByb3BlcnR5IGRlY29yYXRvciB0aGF0IGNvbnZlcnRzIGEgY2xhc3MgcHJvcGVydHkgaW50byBhIGdldHRlciB0aGF0XG4gKiBleGVjdXRlcyBhIHF1ZXJ5U2VsZWN0b3Igb24gdGhlIGVsZW1lbnQncyByZW5kZXJSb290LlxuICpcbiAqIEBwYXJhbSBzZWxlY3RvciBBIERPTVN0cmluZyBjb250YWluaW5nIG9uZSBvciBtb3JlIHNlbGVjdG9ycyB0byBtYXRjaC5cbiAqXG4gKiBTZWU6IGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9Eb2N1bWVudC9xdWVyeVNlbGVjdG9yXG4gKlxuICogQGV4YW1wbGVcbiAqXG4gKiAgICAgY2xhc3MgTXlFbGVtZW50IHtcbiAqICAgICAgIEBxdWVyeSgnI2ZpcnN0JylcbiAqICAgICAgIGZpcnN0O1xuICpcbiAqICAgICAgIHJlbmRlcigpIHtcbiAqICAgICAgICAgcmV0dXJuIGh0bWxgXG4gKiAgICAgICAgICAgPGRpdiBpZD1cImZpcnN0XCI+PC9kaXY+XG4gKiAgICAgICAgICAgPGRpdiBpZD1cInNlY29uZFwiPjwvZGl2PlxuICogICAgICAgICBgO1xuICogICAgICAgfVxuICogICAgIH1cbiAqXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBxdWVyeShzZWxlY3Rvcikge1xuICAgIHJldHVybiAocHJvdG9PckRlc2NyaXB0b3IsIFxuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1hbnkgZGVjb3JhdG9yXG4gICAgbmFtZSkgPT4ge1xuICAgICAgICBjb25zdCBkZXNjcmlwdG9yID0ge1xuICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbmRlclJvb3QucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIChuYW1lICE9PSB1bmRlZmluZWQpID9cbiAgICAgICAgICAgIGxlZ2FjeVF1ZXJ5KGRlc2NyaXB0b3IsIHByb3RvT3JEZXNjcmlwdG9yLCBuYW1lKSA6XG4gICAgICAgICAgICBzdGFuZGFyZFF1ZXJ5KGRlc2NyaXB0b3IsIHByb3RvT3JEZXNjcmlwdG9yKTtcbiAgICB9O1xufVxuLy8gTm90ZSwgaW4gdGhlIGZ1dHVyZSwgd2UgbWF5IGV4dGVuZCB0aGlzIGRlY29yYXRvciB0byBzdXBwb3J0IHRoZSB1c2UgY2FzZVxuLy8gd2hlcmUgdGhlIHF1ZXJpZWQgZWxlbWVudCBtYXkgbmVlZCB0byBkbyB3b3JrIHRvIGJlY29tZSByZWFkeSB0byBpbnRlcmFjdFxuLy8gd2l0aCAoZS5nLiBsb2FkIHNvbWUgaW1wbGVtZW50YXRpb24gY29kZSkuIElmIHNvLCB3ZSBtaWdodCBlbGVjdCB0b1xuLy8gYWRkIGEgc2Vjb25kIGFyZ3VtZW50IGRlZmluaW5nIGEgZnVuY3Rpb24gdGhhdCBjYW4gYmUgcnVuIHRvIG1ha2UgdGhlXG4vLyBxdWVyaWVkIGVsZW1lbnQgbG9hZGVkL3VwZGF0ZWQvcmVhZHkuXG4vKipcbiAqIEEgcHJvcGVydHkgZGVjb3JhdG9yIHRoYXQgY29udmVydHMgYSBjbGFzcyBwcm9wZXJ0eSBpbnRvIGEgZ2V0dGVyIHRoYXRcbiAqIHJldHVybnMgYSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3VsdCBvZiBhIHF1ZXJ5U2VsZWN0b3Igb24gdGhlXG4gKiBlbGVtZW50J3MgcmVuZGVyUm9vdCBkb25lIGFmdGVyIHRoZSBlbGVtZW50J3MgYHVwZGF0ZUNvbXBsZXRlYCBwcm9taXNlXG4gKiByZXNvbHZlcy4gV2hlbiB0aGUgcXVlcmllZCBwcm9wZXJ0eSBtYXkgY2hhbmdlIHdpdGggZWxlbWVudCBzdGF0ZSwgdGhpc1xuICogZGVjb3JhdG9yIGNhbiBiZSB1c2VkIGluc3RlYWQgb2YgcmVxdWlyaW5nIHVzZXJzIHRvIGF3YWl0IHRoZVxuICogYHVwZGF0ZUNvbXBsZXRlYCBiZWZvcmUgYWNjZXNzaW5nIHRoZSBwcm9wZXJ0eS5cbiAqXG4gKiBAcGFyYW0gc2VsZWN0b3IgQSBET01TdHJpbmcgY29udGFpbmluZyBvbmUgb3IgbW9yZSBzZWxlY3RvcnMgdG8gbWF0Y2guXG4gKlxuICogU2VlOiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvRG9jdW1lbnQvcXVlcnlTZWxlY3RvclxuICpcbiAqIEBleGFtcGxlXG4gKlxuICogICAgIGNsYXNzIE15RWxlbWVudCB7XG4gKiAgICAgICBAcXVlcnlBc3luYygnI2ZpcnN0JylcbiAqICAgICAgIGZpcnN0O1xuICpcbiAqICAgICAgIHJlbmRlcigpIHtcbiAqICAgICAgICAgcmV0dXJuIGh0bWxgXG4gKiAgICAgICAgICAgPGRpdiBpZD1cImZpcnN0XCI+PC9kaXY+XG4gKiAgICAgICAgICAgPGRpdiBpZD1cInNlY29uZFwiPjwvZGl2PlxuICogICAgICAgICBgO1xuICogICAgICAgfVxuICogICAgIH1cbiAqXG4gKiAgICAgLy8gZXh0ZXJuYWwgdXNhZ2VcbiAqICAgICBhc3luYyBkb1NvbWV0aGluZ1dpdGhGaXJzdCgpIHtcbiAqICAgICAgKGF3YWl0IGFNeUVsZW1lbnQuZmlyc3QpLmRvU29tZXRoaW5nKCk7XG4gKiAgICAgfVxuICovXG5leHBvcnQgZnVuY3Rpb24gcXVlcnlBc3luYyhzZWxlY3Rvcikge1xuICAgIHJldHVybiAocHJvdG9PckRlc2NyaXB0b3IsIFxuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1hbnkgZGVjb3JhdG9yXG4gICAgbmFtZSkgPT4ge1xuICAgICAgICBjb25zdCBkZXNjcmlwdG9yID0ge1xuICAgICAgICAgICAgYXN5bmMgZ2V0KCkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMudXBkYXRlQ29tcGxldGU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVuZGVyUm9vdC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gKG5hbWUgIT09IHVuZGVmaW5lZCkgP1xuICAgICAgICAgICAgbGVnYWN5UXVlcnkoZGVzY3JpcHRvciwgcHJvdG9PckRlc2NyaXB0b3IsIG5hbWUpIDpcbiAgICAgICAgICAgIHN0YW5kYXJkUXVlcnkoZGVzY3JpcHRvciwgcHJvdG9PckRlc2NyaXB0b3IpO1xuICAgIH07XG59XG4vKipcbiAqIEEgcHJvcGVydHkgZGVjb3JhdG9yIHRoYXQgY29udmVydHMgYSBjbGFzcyBwcm9wZXJ0eSBpbnRvIGEgZ2V0dGVyXG4gKiB0aGF0IGV4ZWN1dGVzIGEgcXVlcnlTZWxlY3RvckFsbCBvbiB0aGUgZWxlbWVudCdzIHJlbmRlclJvb3QuXG4gKlxuICogQHBhcmFtIHNlbGVjdG9yIEEgRE9NU3RyaW5nIGNvbnRhaW5pbmcgb25lIG9yIG1vcmUgc2VsZWN0b3JzIHRvIG1hdGNoLlxuICpcbiAqIFNlZTpcbiAqIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9Eb2N1bWVudC9xdWVyeVNlbGVjdG9yQWxsXG4gKlxuICogQGV4YW1wbGVcbiAqXG4gKiAgICAgY2xhc3MgTXlFbGVtZW50IHtcbiAqICAgICAgIEBxdWVyeUFsbCgnZGl2JylcbiAqICAgICAgIGRpdnM7XG4gKlxuICogICAgICAgcmVuZGVyKCkge1xuICogICAgICAgICByZXR1cm4gaHRtbGBcbiAqICAgICAgICAgICA8ZGl2IGlkPVwiZmlyc3RcIj48L2Rpdj5cbiAqICAgICAgICAgICA8ZGl2IGlkPVwic2Vjb25kXCI+PC9kaXY+XG4gKiAgICAgICAgIGA7XG4gKiAgICAgICB9XG4gKiAgICAgfVxuICovXG5leHBvcnQgZnVuY3Rpb24gcXVlcnlBbGwoc2VsZWN0b3IpIHtcbiAgICByZXR1cm4gKHByb3RvT3JEZXNjcmlwdG9yLCBcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tYW55IGRlY29yYXRvclxuICAgIG5hbWUpID0+IHtcbiAgICAgICAgY29uc3QgZGVzY3JpcHRvciA9IHtcbiAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJSb290LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiAobmFtZSAhPT0gdW5kZWZpbmVkKSA/XG4gICAgICAgICAgICBsZWdhY3lRdWVyeShkZXNjcmlwdG9yLCBwcm90b09yRGVzY3JpcHRvciwgbmFtZSkgOlxuICAgICAgICAgICAgc3RhbmRhcmRRdWVyeShkZXNjcmlwdG9yLCBwcm90b09yRGVzY3JpcHRvcik7XG4gICAgfTtcbn1cbmNvbnN0IGxlZ2FjeVF1ZXJ5ID0gKGRlc2NyaXB0b3IsIHByb3RvLCBuYW1lKSA9PiB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHByb3RvLCBuYW1lLCBkZXNjcmlwdG9yKTtcbn07XG5jb25zdCBzdGFuZGFyZFF1ZXJ5ID0gKGRlc2NyaXB0b3IsIGVsZW1lbnQpID0+ICh7XG4gICAga2luZDogJ21ldGhvZCcsXG4gICAgcGxhY2VtZW50OiAncHJvdG90eXBlJyxcbiAgICBrZXk6IGVsZW1lbnQua2V5LFxuICAgIGRlc2NyaXB0b3IsXG59KTtcbmNvbnN0IHN0YW5kYXJkRXZlbnRPcHRpb25zID0gKG9wdGlvbnMsIGVsZW1lbnQpID0+IHtcbiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBlbGVtZW50KSwgeyBmaW5pc2hlcihjbGF6eikge1xuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihjbGF6ei5wcm90b3R5cGVbZWxlbWVudC5rZXldLCBvcHRpb25zKTtcbiAgICAgICAgfSB9KTtcbn07XG5jb25zdCBsZWdhY3lFdmVudE9wdGlvbnMgPSBcbi8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1hbnkgbGVnYWN5IGRlY29yYXRvclxuKG9wdGlvbnMsIHByb3RvLCBuYW1lKSA9PiB7XG4gICAgT2JqZWN0LmFzc2lnbihwcm90b1tuYW1lXSwgb3B0aW9ucyk7XG59O1xuLyoqXG4gKiBBZGRzIGV2ZW50IGxpc3RlbmVyIG9wdGlvbnMgdG8gYSBtZXRob2QgdXNlZCBhcyBhbiBldmVudCBsaXN0ZW5lciBpbiBhXG4gKiBsaXQtaHRtbCB0ZW1wbGF0ZS5cbiAqXG4gKiBAcGFyYW0gb3B0aW9ucyBBbiBvYmplY3QgdGhhdCBzcGVjaWZpZXMgZXZlbnQgbGlzdGVuZXIgb3B0aW9ucyBhcyBhY2NlcHRlZCBieVxuICogYEV2ZW50VGFyZ2V0I2FkZEV2ZW50TGlzdGVuZXJgIGFuZCBgRXZlbnRUYXJnZXQjcmVtb3ZlRXZlbnRMaXN0ZW5lcmAuXG4gKlxuICogQ3VycmVudCBicm93c2VycyBzdXBwb3J0IHRoZSBgY2FwdHVyZWAsIGBwYXNzaXZlYCwgYW5kIGBvbmNlYCBvcHRpb25zLiBTZWU6XG4gKiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvRXZlbnRUYXJnZXQvYWRkRXZlbnRMaXN0ZW5lciNQYXJhbWV0ZXJzXG4gKlxuICogQGV4YW1wbGVcbiAqXG4gKiAgICAgY2xhc3MgTXlFbGVtZW50IHtcbiAqICAgICAgIGNsaWNrZWQgPSBmYWxzZTtcbiAqXG4gKiAgICAgICByZW5kZXIoKSB7XG4gKiAgICAgICAgIHJldHVybiBodG1sYFxuICogICAgICAgICAgIDxkaXYgQGNsaWNrPSR7dGhpcy5fb25DbGlja31gPlxuICogICAgICAgICAgICAgPGJ1dHRvbj48L2J1dHRvbj5cbiAqICAgICAgICAgICA8L2Rpdj5cbiAqICAgICAgICAgYDtcbiAqICAgICAgIH1cbiAqXG4gKiAgICAgICBAZXZlbnRPcHRpb25zKHtjYXB0dXJlOiB0cnVlfSlcbiAqICAgICAgIF9vbkNsaWNrKGUpIHtcbiAqICAgICAgICAgdGhpcy5jbGlja2VkID0gdHJ1ZTtcbiAqICAgICAgIH1cbiAqICAgICB9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBldmVudE9wdGlvbnMob3B0aW9ucykge1xuICAgIC8vIFJldHVybiB2YWx1ZSB0eXBlZCBhcyBhbnkgdG8gcHJldmVudCBUeXBlU2NyaXB0IGZyb20gY29tcGxhaW5pbmcgdGhhdFxuICAgIC8vIHN0YW5kYXJkIGRlY29yYXRvciBmdW5jdGlvbiBzaWduYXR1cmUgZG9lcyBub3QgbWF0Y2ggVHlwZVNjcmlwdCBkZWNvcmF0b3JcbiAgICAvLyBzaWduYXR1cmVcbiAgICAvLyBUT0RPKGtzY2hhYWYpOiB1bmNsZWFyIHdoeSBpdCB3YXMgb25seSBmYWlsaW5nIG9uIHRoaXMgZGVjb3JhdG9yIGFuZCBub3RcbiAgICAvLyB0aGUgb3RoZXJzXG4gICAgcmV0dXJuICgocHJvdG9PckRlc2NyaXB0b3IsIG5hbWUpID0+IChuYW1lICE9PSB1bmRlZmluZWQpID9cbiAgICAgICAgbGVnYWN5RXZlbnRPcHRpb25zKG9wdGlvbnMsIHByb3RvT3JEZXNjcmlwdG9yLCBuYW1lKSA6XG4gICAgICAgIHN0YW5kYXJkRXZlbnRPcHRpb25zKG9wdGlvbnMsIHByb3RvT3JEZXNjcmlwdG9yKSk7XG59XG4vKipcbiAqIEEgcHJvcGVydHkgZGVjb3JhdG9yIHRoYXQgY29udmVydHMgYSBjbGFzcyBwcm9wZXJ0eSBpbnRvIGEgZ2V0dGVyIHRoYXRcbiAqIHJldHVybnMgdGhlIGBhc3NpZ25lZE5vZGVzYCBvZiB0aGUgZ2l2ZW4gbmFtZWQgYHNsb3RgLiBOb3RlLCB0aGUgdHlwZSBvZlxuICogdGhpcyBwcm9wZXJ0eSBzaG91bGQgYmUgYW5ub3RhdGVkIGFzIGBOb2RlTGlzdE9mPEhUTUxFbGVtZW50PmAuXG4gKlxuICovXG5leHBvcnQgZnVuY3Rpb24gcXVlcnlBc3NpZ25lZE5vZGVzKHNsb3ROYW1lID0gJycsIGZsYXR0ZW4gPSBmYWxzZSkge1xuICAgIHJldHVybiAocHJvdG9PckRlc2NyaXB0b3IsIFxuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1hbnkgZGVjb3JhdG9yXG4gICAgbmFtZSkgPT4ge1xuICAgICAgICBjb25zdCBkZXNjcmlwdG9yID0ge1xuICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdG9yID0gYHNsb3Qke3Nsb3ROYW1lID8gYFtuYW1lPSR7c2xvdE5hbWV9XWAgOiAnJ31gO1xuICAgICAgICAgICAgICAgIGNvbnN0IHNsb3QgPSB0aGlzLnJlbmRlclJvb3QucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNsb3QgJiYgc2xvdC5hc3NpZ25lZE5vZGVzKHsgZmxhdHRlbiB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gKG5hbWUgIT09IHVuZGVmaW5lZCkgP1xuICAgICAgICAgICAgbGVnYWN5UXVlcnkoZGVzY3JpcHRvciwgcHJvdG9PckRlc2NyaXB0b3IsIG5hbWUpIDpcbiAgICAgICAgICAgIHN0YW5kYXJkUXVlcnkoZGVzY3JpcHRvciwgcHJvdG9PckRlc2NyaXB0b3IpO1xuICAgIH07XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kZWNvcmF0b3JzLmpzLm1hcCIsIi8qKlxuQGxpY2Vuc2VcbkNvcHlyaWdodCAoYykgMjAxOSBUaGUgUG9seW1lciBQcm9qZWN0IEF1dGhvcnMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG5UaGlzIGNvZGUgbWF5IG9ubHkgYmUgdXNlZCB1bmRlciB0aGUgQlNEIHN0eWxlIGxpY2Vuc2UgZm91bmQgYXRcbmh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9MSUNFTlNFLnR4dCBUaGUgY29tcGxldGUgc2V0IG9mIGF1dGhvcnMgbWF5IGJlIGZvdW5kIGF0XG5odHRwOi8vcG9seW1lci5naXRodWIuaW8vQVVUSE9SUy50eHQgVGhlIGNvbXBsZXRlIHNldCBvZiBjb250cmlidXRvcnMgbWF5IGJlXG5mb3VuZCBhdCBodHRwOi8vcG9seW1lci5naXRodWIuaW8vQ09OVFJJQlVUT1JTLnR4dCBDb2RlIGRpc3RyaWJ1dGVkIGJ5IEdvb2dsZSBhc1xucGFydCBvZiB0aGUgcG9seW1lciBwcm9qZWN0IGlzIGFsc28gc3ViamVjdCB0byBhbiBhZGRpdGlvbmFsIElQIHJpZ2h0cyBncmFudFxuZm91bmQgYXQgaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL1BBVEVOVFMudHh0XG4qL1xuZXhwb3J0IGNvbnN0IHN1cHBvcnRzQWRvcHRpbmdTdHlsZVNoZWV0cyA9ICgnYWRvcHRlZFN0eWxlU2hlZXRzJyBpbiBEb2N1bWVudC5wcm90b3R5cGUpICYmXG4gICAgKCdyZXBsYWNlJyBpbiBDU1NTdHlsZVNoZWV0LnByb3RvdHlwZSk7XG5jb25zdCBjb25zdHJ1Y3Rpb25Ub2tlbiA9IFN5bWJvbCgpO1xuZXhwb3J0IGNsYXNzIENTU1Jlc3VsdCB7XG4gICAgY29uc3RydWN0b3IoY3NzVGV4dCwgc2FmZVRva2VuKSB7XG4gICAgICAgIGlmIChzYWZlVG9rZW4gIT09IGNvbnN0cnVjdGlvblRva2VuKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NTU1Jlc3VsdCBpcyBub3QgY29uc3RydWN0YWJsZS4gVXNlIGB1bnNhZmVDU1NgIG9yIGBjc3NgIGluc3RlYWQuJyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jc3NUZXh0ID0gY3NzVGV4dDtcbiAgICB9XG4gICAgLy8gTm90ZSwgdGhpcyBpcyBhIGdldHRlciBzbyB0aGF0IGl0J3MgbGF6eS4gSW4gcHJhY3RpY2UsIHRoaXMgbWVhbnNcbiAgICAvLyBzdHlsZXNoZWV0cyBhcmUgbm90IGNyZWF0ZWQgdW50aWwgdGhlIGZpcnN0IGVsZW1lbnQgaW5zdGFuY2UgaXMgbWFkZS5cbiAgICBnZXQgc3R5bGVTaGVldCgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3N0eWxlU2hlZXQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgLy8gTm90ZSwgaWYgYGFkb3B0ZWRTdHlsZVNoZWV0c2AgaXMgc3VwcG9ydGVkIHRoZW4gd2UgYXNzdW1lIENTU1N0eWxlU2hlZXRcbiAgICAgICAgICAgIC8vIGlzIGNvbnN0cnVjdGFibGUuXG4gICAgICAgICAgICBpZiAoc3VwcG9ydHNBZG9wdGluZ1N0eWxlU2hlZXRzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3R5bGVTaGVldCA9IG5ldyBDU1NTdHlsZVNoZWV0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3R5bGVTaGVldC5yZXBsYWNlU3luYyh0aGlzLmNzc1RleHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3R5bGVTaGVldCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX3N0eWxlU2hlZXQ7XG4gICAgfVxuICAgIHRvU3RyaW5nKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jc3NUZXh0O1xuICAgIH1cbn1cbi8qKlxuICogV3JhcCBhIHZhbHVlIGZvciBpbnRlcnBvbGF0aW9uIGluIGEgY3NzIHRhZ2dlZCB0ZW1wbGF0ZSBsaXRlcmFsLlxuICpcbiAqIFRoaXMgaXMgdW5zYWZlIGJlY2F1c2UgdW50cnVzdGVkIENTUyB0ZXh0IGNhbiBiZSB1c2VkIHRvIHBob25lIGhvbWVcbiAqIG9yIGV4ZmlsdHJhdGUgZGF0YSB0byBhbiBhdHRhY2tlciBjb250cm9sbGVkIHNpdGUuIFRha2UgY2FyZSB0byBvbmx5IHVzZVxuICogdGhpcyB3aXRoIHRydXN0ZWQgaW5wdXQuXG4gKi9cbmV4cG9ydCBjb25zdCB1bnNhZmVDU1MgPSAodmFsdWUpID0+IHtcbiAgICByZXR1cm4gbmV3IENTU1Jlc3VsdChTdHJpbmcodmFsdWUpLCBjb25zdHJ1Y3Rpb25Ub2tlbik7XG59O1xuY29uc3QgdGV4dEZyb21DU1NSZXN1bHQgPSAodmFsdWUpID0+IHtcbiAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBDU1NSZXN1bHQpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlLmNzc1RleHQ7XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBWYWx1ZSBwYXNzZWQgdG8gJ2NzcycgZnVuY3Rpb24gbXVzdCBiZSBhICdjc3MnIGZ1bmN0aW9uIHJlc3VsdDogJHt2YWx1ZX0uIFVzZSAndW5zYWZlQ1NTJyB0byBwYXNzIG5vbi1saXRlcmFsIHZhbHVlcywgYnV0XG4gICAgICAgICAgICB0YWtlIGNhcmUgdG8gZW5zdXJlIHBhZ2Ugc2VjdXJpdHkuYCk7XG4gICAgfVxufTtcbi8qKlxuICogVGVtcGxhdGUgdGFnIHdoaWNoIHdoaWNoIGNhbiBiZSB1c2VkIHdpdGggTGl0RWxlbWVudCdzIGBzdHlsZWAgcHJvcGVydHkgdG9cbiAqIHNldCBlbGVtZW50IHN0eWxlcy4gRm9yIHNlY3VyaXR5IHJlYXNvbnMsIG9ubHkgbGl0ZXJhbCBzdHJpbmcgdmFsdWVzIG1heSBiZVxuICogdXNlZC4gVG8gaW5jb3Jwb3JhdGUgbm9uLWxpdGVyYWwgdmFsdWVzIGB1bnNhZmVDU1NgIG1heSBiZSB1c2VkIGluc2lkZSBhXG4gKiB0ZW1wbGF0ZSBzdHJpbmcgcGFydC5cbiAqL1xuZXhwb3J0IGNvbnN0IGNzcyA9IChzdHJpbmdzLCAuLi52YWx1ZXMpID0+IHtcbiAgICBjb25zdCBjc3NUZXh0ID0gdmFsdWVzLnJlZHVjZSgoYWNjLCB2LCBpZHgpID0+IGFjYyArIHRleHRGcm9tQ1NTUmVzdWx0KHYpICsgc3RyaW5nc1tpZHggKyAxXSwgc3RyaW5nc1swXSk7XG4gICAgcmV0dXJuIG5ldyBDU1NSZXN1bHQoY3NzVGV4dCwgY29uc3RydWN0aW9uVG9rZW4pO1xufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNzcy10YWcuanMubWFwIiwiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IChjKSAyMDE3IFRoZSBQb2x5bWVyIFByb2plY3QgQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqIFRoaXMgY29kZSBtYXkgb25seSBiZSB1c2VkIHVuZGVyIHRoZSBCU0Qgc3R5bGUgbGljZW5zZSBmb3VuZCBhdFxuICogaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0xJQ0VOU0UudHh0XG4gKiBUaGUgY29tcGxldGUgc2V0IG9mIGF1dGhvcnMgbWF5IGJlIGZvdW5kIGF0XG4gKiBodHRwOi8vcG9seW1lci5naXRodWIuaW8vQVVUSE9SUy50eHRcbiAqIFRoZSBjb21wbGV0ZSBzZXQgb2YgY29udHJpYnV0b3JzIG1heSBiZSBmb3VuZCBhdFxuICogaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0NPTlRSSUJVVE9SUy50eHRcbiAqIENvZGUgZGlzdHJpYnV0ZWQgYnkgR29vZ2xlIGFzIHBhcnQgb2YgdGhlIHBvbHltZXIgcHJvamVjdCBpcyBhbHNvXG4gKiBzdWJqZWN0IHRvIGFuIGFkZGl0aW9uYWwgSVAgcmlnaHRzIGdyYW50IGZvdW5kIGF0XG4gKiBodHRwOi8vcG9seW1lci5naXRodWIuaW8vUEFURU5UUy50eHRcbiAqL1xuaW1wb3J0IHsgcmVuZGVyIH0gZnJvbSAnbGl0LWh0bWwvbGliL3NoYWR5LXJlbmRlci5qcyc7XG5pbXBvcnQgeyBVcGRhdGluZ0VsZW1lbnQgfSBmcm9tICcuL2xpYi91cGRhdGluZy1lbGVtZW50LmpzJztcbmV4cG9ydCAqIGZyb20gJy4vbGliL3VwZGF0aW5nLWVsZW1lbnQuanMnO1xuZXhwb3J0ICogZnJvbSAnLi9saWIvZGVjb3JhdG9ycy5qcyc7XG5leHBvcnQgeyBodG1sLCBzdmcsIFRlbXBsYXRlUmVzdWx0LCBTVkdUZW1wbGF0ZVJlc3VsdCB9IGZyb20gJ2xpdC1odG1sL2xpdC1odG1sLmpzJztcbmltcG9ydCB7IHN1cHBvcnRzQWRvcHRpbmdTdHlsZVNoZWV0cyB9IGZyb20gJy4vbGliL2Nzcy10YWcuanMnO1xuZXhwb3J0ICogZnJvbSAnLi9saWIvY3NzLXRhZy5qcyc7XG4vLyBJTVBPUlRBTlQ6IGRvIG5vdCBjaGFuZ2UgdGhlIHByb3BlcnR5IG5hbWUgb3IgdGhlIGFzc2lnbm1lbnQgZXhwcmVzc2lvbi5cbi8vIFRoaXMgbGluZSB3aWxsIGJlIHVzZWQgaW4gcmVnZXhlcyB0byBzZWFyY2ggZm9yIExpdEVsZW1lbnQgdXNhZ2UuXG4vLyBUT0RPKGp1c3RpbmZhZ25hbmkpOiBpbmplY3QgdmVyc2lvbiBudW1iZXIgYXQgYnVpbGQgdGltZVxuKHdpbmRvd1snbGl0RWxlbWVudFZlcnNpb25zJ10gfHwgKHdpbmRvd1snbGl0RWxlbWVudFZlcnNpb25zJ10gPSBbXSkpXG4gICAgLnB1c2goJzIuMy4xJyk7XG4vKipcbiAqIFNlbnRpbmFsIHZhbHVlIHVzZWQgdG8gYXZvaWQgY2FsbGluZyBsaXQtaHRtbCdzIHJlbmRlciBmdW5jdGlvbiB3aGVuXG4gKiBzdWJjbGFzc2VzIGRvIG5vdCBpbXBsZW1lbnQgYHJlbmRlcmBcbiAqL1xuY29uc3QgcmVuZGVyTm90SW1wbGVtZW50ZWQgPSB7fTtcbmV4cG9ydCBjbGFzcyBMaXRFbGVtZW50IGV4dGVuZHMgVXBkYXRpbmdFbGVtZW50IHtcbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGFycmF5IG9mIHN0eWxlcyB0byBhcHBseSB0byB0aGUgZWxlbWVudC5cbiAgICAgKiBPdmVycmlkZSB0aGlzIG1ldGhvZCB0byBpbnRlZ3JhdGUgaW50byBhIHN0eWxlIG1hbmFnZW1lbnQgc3lzdGVtLlxuICAgICAqXG4gICAgICogQG5vY29sbGFwc2VcbiAgICAgKi9cbiAgICBzdGF0aWMgZ2V0U3R5bGVzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zdHlsZXM7XG4gICAgfVxuICAgIC8qKiBAbm9jb2xsYXBzZSAqL1xuICAgIHN0YXRpYyBfZ2V0VW5pcXVlU3R5bGVzKCkge1xuICAgICAgICAvLyBPbmx5IGdhdGhlciBzdHlsZXMgb25jZSBwZXIgY2xhc3NcbiAgICAgICAgaWYgKHRoaXMuaGFzT3duUHJvcGVydHkoSlNDb21waWxlcl9yZW5hbWVQcm9wZXJ0eSgnX3N0eWxlcycsIHRoaXMpKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vIFRha2UgY2FyZSBub3QgdG8gY2FsbCBgdGhpcy5nZXRTdHlsZXMoKWAgbXVsdGlwbGUgdGltZXMgc2luY2UgdGhpc1xuICAgICAgICAvLyBnZW5lcmF0ZXMgbmV3IENTU1Jlc3VsdHMgZWFjaCB0aW1lLlxuICAgICAgICAvLyBUT0RPKHNvcnZlbGwpOiBTaW5jZSB3ZSBkbyBub3QgY2FjaGUgQ1NTUmVzdWx0cyBieSBpbnB1dCwgYW55XG4gICAgICAgIC8vIHNoYXJlZCBzdHlsZXMgd2lsbCBnZW5lcmF0ZSBuZXcgc3R5bGVzaGVldCBvYmplY3RzLCB3aGljaCBpcyB3YXN0ZWZ1bC5cbiAgICAgICAgLy8gVGhpcyBzaG91bGQgYmUgYWRkcmVzc2VkIHdoZW4gYSBicm93c2VyIHNoaXBzIGNvbnN0cnVjdGFibGVcbiAgICAgICAgLy8gc3R5bGVzaGVldHMuXG4gICAgICAgIGNvbnN0IHVzZXJTdHlsZXMgPSB0aGlzLmdldFN0eWxlcygpO1xuICAgICAgICBpZiAodXNlclN0eWxlcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLl9zdHlsZXMgPSBbXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChBcnJheS5pc0FycmF5KHVzZXJTdHlsZXMpKSB7XG4gICAgICAgICAgICAvLyBEZS1kdXBsaWNhdGUgc3R5bGVzIHByZXNlcnZpbmcgdGhlIF9sYXN0XyBpbnN0YW5jZSBpbiB0aGUgc2V0LlxuICAgICAgICAgICAgLy8gVGhpcyBpcyBhIHBlcmZvcm1hbmNlIG9wdGltaXphdGlvbiB0byBhdm9pZCBkdXBsaWNhdGVkIHN0eWxlcyB0aGF0IGNhblxuICAgICAgICAgICAgLy8gb2NjdXIgZXNwZWNpYWxseSB3aGVuIGNvbXBvc2luZyB2aWEgc3ViY2xhc3NpbmcuXG4gICAgICAgICAgICAvLyBUaGUgbGFzdCBpdGVtIGlzIGtlcHQgdG8gdHJ5IHRvIHByZXNlcnZlIHRoZSBjYXNjYWRlIG9yZGVyIHdpdGggdGhlXG4gICAgICAgICAgICAvLyBhc3N1bXB0aW9uIHRoYXQgaXQncyBtb3N0IGltcG9ydGFudCB0aGF0IGxhc3QgYWRkZWQgc3R5bGVzIG92ZXJyaWRlXG4gICAgICAgICAgICAvLyBwcmV2aW91cyBzdHlsZXMuXG4gICAgICAgICAgICBjb25zdCBhZGRTdHlsZXMgPSAoc3R5bGVzLCBzZXQpID0+IHN0eWxlcy5yZWR1Y2VSaWdodCgoc2V0LCBzKSA9PiBcbiAgICAgICAgICAgIC8vIE5vdGU6IE9uIElFIHNldC5hZGQoKSBkb2VzIG5vdCByZXR1cm4gdGhlIHNldFxuICAgICAgICAgICAgQXJyYXkuaXNBcnJheShzKSA/IGFkZFN0eWxlcyhzLCBzZXQpIDogKHNldC5hZGQocyksIHNldCksIHNldCk7XG4gICAgICAgICAgICAvLyBBcnJheS5mcm9tIGRvZXMgbm90IHdvcmsgb24gU2V0IGluIElFLCBvdGhlcndpc2UgcmV0dXJuXG4gICAgICAgICAgICAvLyBBcnJheS5mcm9tKGFkZFN0eWxlcyh1c2VyU3R5bGVzLCBuZXcgU2V0PENTU1Jlc3VsdD4oKSkpLnJldmVyc2UoKVxuICAgICAgICAgICAgY29uc3Qgc2V0ID0gYWRkU3R5bGVzKHVzZXJTdHlsZXMsIG5ldyBTZXQoKSk7XG4gICAgICAgICAgICBjb25zdCBzdHlsZXMgPSBbXTtcbiAgICAgICAgICAgIHNldC5mb3JFYWNoKCh2KSA9PiBzdHlsZXMudW5zaGlmdCh2KSk7XG4gICAgICAgICAgICB0aGlzLl9zdHlsZXMgPSBzdHlsZXM7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9zdHlsZXMgPSBbdXNlclN0eWxlc107XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUGVyZm9ybXMgZWxlbWVudCBpbml0aWFsaXphdGlvbi4gQnkgZGVmYXVsdCB0aGlzIGNhbGxzIGBjcmVhdGVSZW5kZXJSb290YFxuICAgICAqIHRvIGNyZWF0ZSB0aGUgZWxlbWVudCBgcmVuZGVyUm9vdGAgbm9kZSBhbmQgY2FwdHVyZXMgYW55IHByZS1zZXQgdmFsdWVzIGZvclxuICAgICAqIHJlZ2lzdGVyZWQgcHJvcGVydGllcy5cbiAgICAgKi9cbiAgICBpbml0aWFsaXplKCkge1xuICAgICAgICBzdXBlci5pbml0aWFsaXplKCk7XG4gICAgICAgIHRoaXMuY29uc3RydWN0b3IuX2dldFVuaXF1ZVN0eWxlcygpO1xuICAgICAgICB0aGlzLnJlbmRlclJvb3QgPVxuICAgICAgICAgICAgdGhpcy5jcmVhdGVSZW5kZXJSb290KCk7XG4gICAgICAgIC8vIE5vdGUsIGlmIHJlbmRlclJvb3QgaXMgbm90IGEgc2hhZG93Um9vdCwgc3R5bGVzIHdvdWxkL2NvdWxkIGFwcGx5IHRvIHRoZVxuICAgICAgICAvLyBlbGVtZW50J3MgZ2V0Um9vdE5vZGUoKS4gV2hpbGUgdGhpcyBjb3VsZCBiZSBkb25lLCB3ZSdyZSBjaG9vc2luZyBub3QgdG9cbiAgICAgICAgLy8gc3VwcG9ydCB0aGlzIG5vdyBzaW5jZSBpdCB3b3VsZCByZXF1aXJlIGRpZmZlcmVudCBsb2dpYyBhcm91bmQgZGUtZHVwaW5nLlxuICAgICAgICBpZiAod2luZG93LlNoYWRvd1Jvb3QgJiYgdGhpcy5yZW5kZXJSb290IGluc3RhbmNlb2Ygd2luZG93LlNoYWRvd1Jvb3QpIHtcbiAgICAgICAgICAgIHRoaXMuYWRvcHRTdHlsZXMoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBub2RlIGludG8gd2hpY2ggdGhlIGVsZW1lbnQgc2hvdWxkIHJlbmRlciBhbmQgYnkgZGVmYXVsdFxuICAgICAqIGNyZWF0ZXMgYW5kIHJldHVybnMgYW4gb3BlbiBzaGFkb3dSb290LiBJbXBsZW1lbnQgdG8gY3VzdG9taXplIHdoZXJlIHRoZVxuICAgICAqIGVsZW1lbnQncyBET00gaXMgcmVuZGVyZWQuIEZvciBleGFtcGxlLCB0byByZW5kZXIgaW50byB0aGUgZWxlbWVudCdzXG4gICAgICogY2hpbGROb2RlcywgcmV0dXJuIGB0aGlzYC5cbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudHxEb2N1bWVudEZyYWdtZW50fSBSZXR1cm5zIGEgbm9kZSBpbnRvIHdoaWNoIHRvIHJlbmRlci5cbiAgICAgKi9cbiAgICBjcmVhdGVSZW5kZXJSb290KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hdHRhY2hTaGFkb3coeyBtb2RlOiAnb3BlbicgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFwcGxpZXMgc3R5bGluZyB0byB0aGUgZWxlbWVudCBzaGFkb3dSb290IHVzaW5nIHRoZSBgc3RhdGljIGdldCBzdHlsZXNgXG4gICAgICogcHJvcGVydHkuIFN0eWxpbmcgd2lsbCBhcHBseSB1c2luZyBgc2hhZG93Um9vdC5hZG9wdGVkU3R5bGVTaGVldHNgIHdoZXJlXG4gICAgICogYXZhaWxhYmxlIGFuZCB3aWxsIGZhbGxiYWNrIG90aGVyd2lzZS4gV2hlbiBTaGFkb3cgRE9NIGlzIHBvbHlmaWxsZWQsXG4gICAgICogU2hhZHlDU1Mgc2NvcGVzIHN0eWxlcyBhbmQgYWRkcyB0aGVtIHRvIHRoZSBkb2N1bWVudC4gV2hlbiBTaGFkb3cgRE9NXG4gICAgICogaXMgYXZhaWxhYmxlIGJ1dCBgYWRvcHRlZFN0eWxlU2hlZXRzYCBpcyBub3QsIHN0eWxlcyBhcmUgYXBwZW5kZWQgdG8gdGhlXG4gICAgICogZW5kIG9mIHRoZSBgc2hhZG93Um9vdGAgdG8gW21pbWljIHNwZWNcbiAgICAgKiBiZWhhdmlvcl0oaHR0cHM6Ly93aWNnLmdpdGh1Yi5pby9jb25zdHJ1Y3Qtc3R5bGVzaGVldHMvI3VzaW5nLWNvbnN0cnVjdGVkLXN0eWxlc2hlZXRzKS5cbiAgICAgKi9cbiAgICBhZG9wdFN0eWxlcygpIHtcbiAgICAgICAgY29uc3Qgc3R5bGVzID0gdGhpcy5jb25zdHJ1Y3Rvci5fc3R5bGVzO1xuICAgICAgICBpZiAoc3R5bGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vIFRoZXJlIGFyZSB0aHJlZSBzZXBhcmF0ZSBjYXNlcyBoZXJlIGJhc2VkIG9uIFNoYWRvdyBET00gc3VwcG9ydC5cbiAgICAgICAgLy8gKDEpIHNoYWRvd1Jvb3QgcG9seWZpbGxlZDogdXNlIFNoYWR5Q1NTXG4gICAgICAgIC8vICgyKSBzaGFkb3dSb290LmFkb3B0ZWRTdHlsZVNoZWV0cyBhdmFpbGFibGU6IHVzZSBpdC5cbiAgICAgICAgLy8gKDMpIHNoYWRvd1Jvb3QuYWRvcHRlZFN0eWxlU2hlZXRzIHBvbHlmaWxsZWQ6IGFwcGVuZCBzdHlsZXMgYWZ0ZXJcbiAgICAgICAgLy8gcmVuZGVyaW5nXG4gICAgICAgIGlmICh3aW5kb3cuU2hhZHlDU1MgIT09IHVuZGVmaW5lZCAmJiAhd2luZG93LlNoYWR5Q1NTLm5hdGl2ZVNoYWRvdykge1xuICAgICAgICAgICAgd2luZG93LlNoYWR5Q1NTLlNjb3BpbmdTaGltLnByZXBhcmVBZG9wdGVkQ3NzVGV4dChzdHlsZXMubWFwKChzKSA9PiBzLmNzc1RleHQpLCB0aGlzLmxvY2FsTmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc3VwcG9ydHNBZG9wdGluZ1N0eWxlU2hlZXRzKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlclJvb3QuYWRvcHRlZFN0eWxlU2hlZXRzID1cbiAgICAgICAgICAgICAgICBzdHlsZXMubWFwKChzKSA9PiBzLnN0eWxlU2hlZXQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gVGhpcyBtdXN0IGJlIGRvbmUgYWZ0ZXIgcmVuZGVyaW5nIHNvIHRoZSBhY3R1YWwgc3R5bGUgaW5zZXJ0aW9uIGlzIGRvbmVcbiAgICAgICAgICAgIC8vIGluIGB1cGRhdGVgLlxuICAgICAgICAgICAgdGhpcy5fbmVlZHNTaGltQWRvcHRlZFN0eWxlU2hlZXRzID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICAgICAgc3VwZXIuY29ubmVjdGVkQ2FsbGJhY2soKTtcbiAgICAgICAgLy8gTm90ZSwgZmlyc3QgdXBkYXRlL3JlbmRlciBoYW5kbGVzIHN0eWxlRWxlbWVudCBzbyB3ZSBvbmx5IGNhbGwgdGhpcyBpZlxuICAgICAgICAvLyBjb25uZWN0ZWQgYWZ0ZXIgZmlyc3QgdXBkYXRlLlxuICAgICAgICBpZiAodGhpcy5oYXNVcGRhdGVkICYmIHdpbmRvdy5TaGFkeUNTUyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB3aW5kb3cuU2hhZHlDU1Muc3R5bGVFbGVtZW50KHRoaXMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgdGhlIGVsZW1lbnQuIFRoaXMgbWV0aG9kIHJlZmxlY3RzIHByb3BlcnR5IHZhbHVlcyB0byBhdHRyaWJ1dGVzXG4gICAgICogYW5kIGNhbGxzIGByZW5kZXJgIHRvIHJlbmRlciBET00gdmlhIGxpdC1odG1sLiBTZXR0aW5nIHByb3BlcnRpZXMgaW5zaWRlXG4gICAgICogdGhpcyBtZXRob2Qgd2lsbCAqbm90KiB0cmlnZ2VyIGFub3RoZXIgdXBkYXRlLlxuICAgICAqIEBwYXJhbSBfY2hhbmdlZFByb3BlcnRpZXMgTWFwIG9mIGNoYW5nZWQgcHJvcGVydGllcyB3aXRoIG9sZCB2YWx1ZXNcbiAgICAgKi9cbiAgICB1cGRhdGUoY2hhbmdlZFByb3BlcnRpZXMpIHtcbiAgICAgICAgLy8gU2V0dGluZyBwcm9wZXJ0aWVzIGluIGByZW5kZXJgIHNob3VsZCBub3QgdHJpZ2dlciBhbiB1cGRhdGUuIFNpbmNlXG4gICAgICAgIC8vIHVwZGF0ZXMgYXJlIGFsbG93ZWQgYWZ0ZXIgc3VwZXIudXBkYXRlLCBpdCdzIGltcG9ydGFudCB0byBjYWxsIGByZW5kZXJgXG4gICAgICAgIC8vIGJlZm9yZSB0aGF0LlxuICAgICAgICBjb25zdCB0ZW1wbGF0ZVJlc3VsdCA9IHRoaXMucmVuZGVyKCk7XG4gICAgICAgIHN1cGVyLnVwZGF0ZShjaGFuZ2VkUHJvcGVydGllcyk7XG4gICAgICAgIC8vIElmIHJlbmRlciBpcyBub3QgaW1wbGVtZW50ZWQgYnkgdGhlIGNvbXBvbmVudCwgZG9uJ3QgY2FsbCBsaXQtaHRtbCByZW5kZXJcbiAgICAgICAgaWYgKHRlbXBsYXRlUmVzdWx0ICE9PSByZW5kZXJOb3RJbXBsZW1lbnRlZCkge1xuICAgICAgICAgICAgdGhpcy5jb25zdHJ1Y3RvclxuICAgICAgICAgICAgICAgIC5yZW5kZXIodGVtcGxhdGVSZXN1bHQsIHRoaXMucmVuZGVyUm9vdCwgeyBzY29wZU5hbWU6IHRoaXMubG9jYWxOYW1lLCBldmVudENvbnRleHQ6IHRoaXMgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gV2hlbiBuYXRpdmUgU2hhZG93IERPTSBpcyB1c2VkIGJ1dCBhZG9wdGVkU3R5bGVzIGFyZSBub3Qgc3VwcG9ydGVkLFxuICAgICAgICAvLyBpbnNlcnQgc3R5bGluZyBhZnRlciByZW5kZXJpbmcgdG8gZW5zdXJlIGFkb3B0ZWRTdHlsZXMgaGF2ZSBoaWdoZXN0XG4gICAgICAgIC8vIHByaW9yaXR5LlxuICAgICAgICBpZiAodGhpcy5fbmVlZHNTaGltQWRvcHRlZFN0eWxlU2hlZXRzKSB7XG4gICAgICAgICAgICB0aGlzLl9uZWVkc1NoaW1BZG9wdGVkU3R5bGVTaGVldHMgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuY29uc3RydWN0b3IuX3N0eWxlcy5mb3JFYWNoKChzKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpO1xuICAgICAgICAgICAgICAgIHN0eWxlLnRleHRDb250ZW50ID0gcy5jc3NUZXh0O1xuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyUm9vdC5hcHBlbmRDaGlsZChzdHlsZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbnZva2VkIG9uIGVhY2ggdXBkYXRlIHRvIHBlcmZvcm0gcmVuZGVyaW5nIHRhc2tzLiBUaGlzIG1ldGhvZCBtYXkgcmV0dXJuXG4gICAgICogYW55IHZhbHVlIHJlbmRlcmFibGUgYnkgbGl0LWh0bWwncyBOb2RlUGFydCAtIHR5cGljYWxseSBhIFRlbXBsYXRlUmVzdWx0LlxuICAgICAqIFNldHRpbmcgcHJvcGVydGllcyBpbnNpZGUgdGhpcyBtZXRob2Qgd2lsbCAqbm90KiB0cmlnZ2VyIHRoZSBlbGVtZW50IHRvXG4gICAgICogdXBkYXRlLlxuICAgICAqL1xuICAgIHJlbmRlcigpIHtcbiAgICAgICAgcmV0dXJuIHJlbmRlck5vdEltcGxlbWVudGVkO1xuICAgIH1cbn1cbi8qKlxuICogRW5zdXJlIHRoaXMgY2xhc3MgaXMgbWFya2VkIGFzIGBmaW5hbGl6ZWRgIGFzIGFuIG9wdGltaXphdGlvbiBlbnN1cmluZ1xuICogaXQgd2lsbCBub3QgbmVlZGxlc3NseSB0cnkgdG8gYGZpbmFsaXplYC5cbiAqXG4gKiBOb3RlIHRoaXMgcHJvcGVydHkgbmFtZSBpcyBhIHN0cmluZyB0byBwcmV2ZW50IGJyZWFraW5nIENsb3N1cmUgSlMgQ29tcGlsZXJcbiAqIG9wdGltaXphdGlvbnMuIFNlZSB1cGRhdGluZy1lbGVtZW50LnRzIGZvciBtb3JlIGluZm9ybWF0aW9uLlxuICovXG5MaXRFbGVtZW50WydmaW5hbGl6ZWQnXSA9IHRydWU7XG4vKipcbiAqIFJlbmRlciBtZXRob2QgdXNlZCB0byByZW5kZXIgdGhlIHZhbHVlIHRvIHRoZSBlbGVtZW50J3MgRE9NLlxuICogQHBhcmFtIHJlc3VsdCBUaGUgdmFsdWUgdG8gcmVuZGVyLlxuICogQHBhcmFtIGNvbnRhaW5lciBOb2RlIGludG8gd2hpY2ggdG8gcmVuZGVyLlxuICogQHBhcmFtIG9wdGlvbnMgRWxlbWVudCBuYW1lLlxuICogQG5vY29sbGFwc2VcbiAqL1xuTGl0RWxlbWVudC5yZW5kZXIgPSByZW5kZXI7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1saXQtZWxlbWVudC5qcy5tYXAiLCJpbnRlcmZhY2UgUGFpciB7XG4gIHJvdzogbnVtYmVyO1xuICBjb2w6IG51bWJlcjtcbn1cblxuY29uc3QgU1FVQVJFX1NJWkUgPSA1MDtcblxuZnVuY3Rpb24gZXF1YWxzKGE6IFBhaXIsIGI6IFBhaXIpOiBib29sZWFuIHtcbiAgcmV0dXJuIGEucm93ID09PSBiLnJvdyAmJiBhLmNvbCA9PT0gYi5jb2w7XG59XG5cbmZ1bmN0aW9uIGRlZHVwKGw6IFBhaXJbXSk6IFBhaXJbXSB7XG4gIGNvbnN0IG06IHtba2V5OiBzdHJpbmddOiBib29sZWFufSA9IHt9O1xuICBmb3IgKGNvbnN0IHAgb2YgbCkge1xuICAgIG1bcC5yb3cgKyAnLCcgKyBwLmNvbF0gPSB0cnVlO1xuICB9XG4gIHJldHVybiBPYmplY3Qua2V5cyhtKS5tYXAoKHMpID0+ICh7XG4gICAgcm93OiBwYXJzZUludChzLnNwbGl0KCcsJylbMF0pLFxuICAgIGNvbDogcGFyc2VJbnQocy5zcGxpdCgnLCcpWzFdKSxcbiAgfSkpO1xufVxuXG5mdW5jdGlvbiBoYXNoKHA6IFBhaXIpOiBzdHJpbmcge1xuICByZXR1cm4gcC5yb3cgKyAnLCcgKyBwLmNvbDtcbn1cblxuZnVuY3Rpb24gdW5oYXNoKHM6IHN0cmluZyk6IFBhaXIge1xuICByZXR1cm4ge3JvdzogcGFyc2VJbnQocy5zcGxpdCgnLCcpWzBdKSwgY29sOiBwYXJzZUludChzLnNwbGl0KCcsJylbMV0pfTtcbn1cblxuY29uc3QgTm90SW1wbGVtZW50ZWRFcnJvciA9IEVycm9yKCdub3QgaW1wbGVtZW50ZWQnKTtcbmNvbnN0IFBBV05fSE9NRV9SQU5LID0gMTtcblxuZW51bSBDb2xvciB7XG4gIFdISVRFID0gJ3doaXRlJyxcbiAgQkxBQ0sgPSAnYmxhY2snLFxufVxuXG5lbnVtIE1vdmVUeXBlIHtcbiAgTU9WRSA9ICdtb3ZlJyxcbiAgQ0FTVExFID0gJ2Nhc3RsZScsXG4gIEVOUEFTU0FOVCA9ICdlbnBhc3NhbnQnLFxufVxuXG5leHBvcnQge1xuICBTUVVBUkVfU0laRSxcbiAgUGFpcixcbiAgZXF1YWxzLFxuICBkZWR1cCxcbiAgaGFzaCxcbiAgdW5oYXNoLFxuICBOb3RJbXBsZW1lbnRlZEVycm9yLFxuICBQQVdOX0hPTUVfUkFOSyxcbiAgQ29sb3IsXG4gIE1vdmVUeXBlLFxufTtcbiIsIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAoYykgMjAxOSBUaGUgUG9seW1lciBQcm9qZWN0IEF1dGhvcnMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiBUaGlzIGNvZGUgbWF5IG9ubHkgYmUgdXNlZCB1bmRlciB0aGUgQlNEIHN0eWxlIGxpY2Vuc2UgZm91bmQgYXRcbiAqIGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9MSUNFTlNFLnR4dFxuICogVGhlIGNvbXBsZXRlIHNldCBvZiBhdXRob3JzIG1heSBiZSBmb3VuZCBhdFxuICogaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0FVVEhPUlMudHh0XG4gKiBUaGUgY29tcGxldGUgc2V0IG9mIGNvbnRyaWJ1dG9ycyBtYXkgYmUgZm91bmQgYXRcbiAqIGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9DT05UUklCVVRPUlMudHh0XG4gKiBDb2RlIGRpc3RyaWJ1dGVkIGJ5IEdvb2dsZSBhcyBwYXJ0IG9mIHRoZSBwb2x5bWVyIHByb2plY3QgaXMgYWxzb1xuICogc3ViamVjdCB0byBhbiBhZGRpdGlvbmFsIElQIHJpZ2h0cyBncmFudCBmb3VuZCBhdFxuICogaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL1BBVEVOVFMudHh0XG4gKi9cblxuaW1wb3J0IHtMaXRFbGVtZW50LCBodG1sLCBjdXN0b21FbGVtZW50LCBwcm9wZXJ0eSwgY3NzfSBmcm9tICdsaXQtZWxlbWVudCc7XG5pbXBvcnQge1BpZWNlfSBmcm9tICcuLi9jaGVzcy9waWVjZSc7XG5cbi8qKlxuICogQW4gZXhhbXBsZSBlbGVtZW50LlxuICpcbiAqIEBzbG90IC0gVGhpcyBlbGVtZW50IGhhcyBhIHNsb3RcbiAqIEBjc3NwYXJ0IGJ1dHRvbiAtIFRoZSBidXR0b25cbiAqL1xuQGN1c3RvbUVsZW1lbnQoJ215LXBpZWNlJylcbmV4cG9ydCBjbGFzcyBNeVBpZWNlIGV4dGVuZHMgTGl0RWxlbWVudCB7XG4gIHN0YXRpYyBzdHlsZXMgPSBjc3NgXG4gICAgLnBpZWNlIHtcbiAgICAgIGhlaWdodDogMTAwJTtcbiAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICAgICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKCcvZGlzdC9pbWcvX2R0LnBuZycpO1xuICAgICAgYmFja2dyb3VuZC1zaXplOiBjb3ZlcjtcbiAgICB9XG4gIGA7XG5cbiAgLyoqXG4gICAqIFRoZSBuYW1lIHRvIHNheSBcIkhlbGxvXCIgdG8uXG4gICAqL1xuICBAcHJvcGVydHkoe3R5cGU6IE9iamVjdH0pXG4gIHBpZWNlOiBQaWVjZTtcblxuICByZW5kZXIoKSB7XG4gICAgcmV0dXJuIGh0bWxgXG4gICAgICA8ZGl2XG4gICAgICAgIGNsYXNzPVwicGllY2VcIlxuICAgICAgICBzdHlsZT1cImJhY2tncm91bmQtaW1hZ2U6dXJsKC9kaXN0L2ltZy8ke3RoaXMucGllY2UuaW1nfSlcIlxuICAgICAgPjwvZGl2PlxuICAgIGA7XG4gIH1cbn1cblxuZGVjbGFyZSBnbG9iYWwge1xuICBpbnRlcmZhY2UgSFRNTEVsZW1lbnRUYWdOYW1lTWFwIHtcbiAgICAnbXktcGllY2UnOiBNeVBpZWNlO1xuICB9XG59XG4iLCJpbXBvcnQge0xpdEVsZW1lbnQsIGh0bWwsIGN1c3RvbUVsZW1lbnQsIHByb3BlcnR5LCBjc3N9IGZyb20gJ2xpdC1lbGVtZW50JztcbmltcG9ydCB7UGllY2V9IGZyb20gJy4uL2NoZXNzL3BpZWNlJztcbmltcG9ydCBTcXVhcmUgZnJvbSAnLi4vY2hlc3Mvc3F1YXJlJztcbmltcG9ydCBCb2FyZFN0YXRlIGZyb20gJy4uL2NoZXNzL3N0YXRlJztcbmltcG9ydCB7U1FVQVJFX1NJWkUsIENvbG9yfSBmcm9tICcuLi9jaGVzcy9jb25zdCc7XG5pbXBvcnQge3N0eWxlTWFwfSBmcm9tICdsaXQtaHRtbC9kaXJlY3RpdmVzL3N0eWxlLW1hcCc7XG5pbXBvcnQgJy4vbXktcGllY2UnO1xuXG4vKipcbiAqIEFuIGV4YW1wbGUgZWxlbWVudC5cbiAqXG4gKiBAc2xvdCAtIFRoaXMgZWxlbWVudCBoYXMgYSBzbG90XG4gKiBAY3NzcGFydCBidXR0b24gLSBUaGUgYnV0dG9uXG4gKi9cbkBjdXN0b21FbGVtZW50KCdteS1zcXVhcmUnKVxuZXhwb3J0IGNsYXNzIE15U3F1YXJlIGV4dGVuZHMgTGl0RWxlbWVudCB7XG4gIHN0YXRpYyBzdHlsZXMgPSBjc3NgXG4gICAgOmhvc3Qge1xuICAgICAgaGVpZ2h0OiAke1NRVUFSRV9TSVpFfXB4O1xuICAgICAgd2lkdGg6ICR7U1FVQVJFX1NJWkV9cHg7XG4gICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gICAgfVxuXG4gICAgLnNxdWFyZSB7XG4gICAgICBoZWlnaHQ6ICcxMDAlJztcbiAgICAgIHdpZHRoOiAnMTAwJSc7XG4gICAgICBkaXNwbGF5OiAnaW5saW5lLWJsb2NrJztcbiAgICB9XG4gIGA7XG5cbiAgLy8gcHVibGljXG4gIEBwcm9wZXJ0eSh7dHlwZTogT2JqZWN0fSkgc3F1YXJlOiBTcXVhcmU7XG4gIEBwcm9wZXJ0eSh7dHlwZTogT2JqZWN0fSkgcGllY2U/OiBQaWVjZTtcbiAgQHByb3BlcnR5KHt0eXBlOiBTdHJpbmd9KSBjb2xvcj86IENvbG9yO1xuICBAcHJvcGVydHkoe3R5cGU6IEJvb2xlYW59KSBzZWxlY3RlZCA9IGZhbHNlO1xuICBAcHJvcGVydHkoe3R5cGU6IEJvb2xlYW59KSBwb3NzaWJsZSA9IGZhbHNlO1xuXG4gIHJlbmRlcigpIHtcbiAgICAvLyB0aGlzLnN0eWxlLnNldFByb3BlcnR5KCd0cmFuc2Zvcm0nLCB0aGlzLmNvbG9yID09PSBDb2xvci5CTEFDSyA/ICdyb3RhdGUoMTgwZGVnKScgOiAnJyk7XG4gICAgcmV0dXJuIGh0bWxgXG4gICAgICA8ZGl2XG4gICAgICAgIGNsYXNzPVwic3F1YXJlXCJcbiAgICAgICAgQGNsaWNrPSR7dGhpcy5fb25DbGlja31cbiAgICAgICAgc3R5bGU9XCJcbiAgICAgICAgaGVpZ2h0OjEwMCU7d2lkdGg6MTAwJTtiYWNrZ3JvdW5kLWNvbG9yOiR7dGhpcy5zZWxlY3RlZFxuICAgICAgICAgID8gJ3JnYmEoMCwgMCwgMjU1LCAwLjMpJ1xuICAgICAgICAgIDogdGhpcy5wb3NzaWJsZVxuICAgICAgICAgID8gJ3JnYmEoMCwgMjU1LCAwLCAwLjMpJ1xuICAgICAgICAgIDogJyd9O3RyYW5zZm9ybToke3RoaXMuY29sb3IgPT09IENvbG9yLkJMQUNLID8gJ3JvdGF0ZSgxODBkZWcpJyA6ICcnfTtcbiAgICAgIFwiXG4gICAgICA+XG4gICAgICAgICR7dGhpcy5waWVjZSAmJiBodG1sYDxteS1waWVjZSAucGllY2U9JHt0aGlzLnBpZWNlfT48L215LXBpZWNlPmB9XG4gICAgICA8L2Rpdj5cbiAgICBgO1xuICB9XG5cbiAgcHJpdmF0ZSBfb25DbGljaygpIHtcbiAgICB0aGlzLmRpc3BhdGNoRXZlbnQoXG4gICAgICBuZXcgQ3VzdG9tRXZlbnQoJ3NxdWFyZS1jbGlja2VkJywge1xuICAgICAgICBidWJibGVzOiB0cnVlLFxuICAgICAgICBjb21wb3NlZDogdHJ1ZSxcbiAgICAgICAgZGV0YWlsOiB0aGlzLnNxdWFyZSxcbiAgICAgIH0pXG4gICAgKTtcbiAgfVxufVxuXG5kZWNsYXJlIGdsb2JhbCB7XG4gIGludGVyZmFjZSBIVE1MRWxlbWVudFRhZ05hbWVNYXAge1xuICAgICdteS1zcXVhcmUnOiBNeVNxdWFyZTtcbiAgfVxufVxuIiwiXG5pbXBvcnQgeyBQaWVjZSB9IGZyb20gJy4vcGllY2UnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTcXVhcmUge1xuICBwaWVjZT86IFBpZWNlO1xuXG4gIGNvbnN0cnVjdG9yKHB1YmxpYyByb3c6IG51bWJlciwgcHVibGljIGNvbDogbnVtYmVyKSB7fVxuXG4gIGdldCBvY2N1cGFudCgpOiBQaWVjZSB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMucGllY2U7XG4gIH1cblxuICB0b1N0cmluZygpOiBzdHJpbmcge1xuICAgIGlmICh0aGlzLm9jY3VwYW50KSB7XG4gICAgICByZXR1cm4gYFske3RoaXMub2NjdXBhbnQudG9TdHJpbmcoKX1dYDtcbiAgICB9XG4gICAgcmV0dXJuICdbIF0nO1xuICB9XG5cbiAgcmVuZGVyKCk6IEhUTUxFbGVtZW50IHtcbiAgICBjb25zdCByZXN1bHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICByZXN1bHQuc2V0QXR0cmlidXRlKCdjbGFzcycsICdzcXVhcmUnKTtcbiAgICAvLyByZXN1bHQuc3R5bGUuaGVpZ2h0ID0gYCR7U1FVQVJFX1NJWkV9cHhgO1xuICAgIC8vIHJlc3VsdC5zdHlsZS53aWR0aCA9IGAke1NRVUFSRV9TSVpFfXB4YDtcbiAgICBpZiAodGhpcy5vY2N1cGFudCkge1xuICAgICAgcmVzdWx0LmFwcGVuZENoaWxkKHRoaXMub2NjdXBhbnQucmVuZGVyKCkpO1xuICAgIH1cbiAgICByZXN1bHQub25jbGljayA9IChlKSA9PiB7XG4gICAgICByZXN1bHQuZGlzcGF0Y2hFdmVudChcbiAgICAgICAgbmV3IEN1c3RvbUV2ZW50KCdzcXVhcmUtY2xpY2tlZCcsIHtcbiAgICAgICAgICBkZXRhaWw6IHRoaXMsXG4gICAgICAgIH0pXG4gICAgICApO1xuICAgIH07XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIGVtcHR5KCkge1xuICAgIHRoaXMucGllY2UgPSB1bmRlZmluZWQ7XG4gIH1cblxuICBwbGFjZShwaWVjZTogUGllY2UpIHtcbiAgICB0aGlzLnBpZWNlID0gcGllY2U7XG4gIH1cbn0iLCJpbXBvcnQgU3F1YXJlIGZyb20gJy4vc3F1YXJlJztcbmltcG9ydCB7UGllY2V9IGZyb20gJy4vcGllY2UnO1xuaW1wb3J0IHtoYXNofSBmcm9tICcuL2NvbnN0JztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQm9hcmRTdGF0ZSB7XG4gIHJhbmtzOiBudW1iZXIgPSA4O1xuICBmaWxlczogbnVtYmVyID0gODtcbiAgc3F1YXJlczogU3F1YXJlW11bXTtcblxuICBjb25zdHJ1Y3RvcihzcXVhcmVzOiBTcXVhcmVbXVtdKSB7XG4gICAgdGhpcy5yYW5rcyA9IHNxdWFyZXMubGVuZ3RoO1xuICAgIHRoaXMuZmlsZXMgPSBzcXVhcmVzWzBdLmxlbmd0aDtcbiAgICBjb25zdCBuZXdTcXVhcmVzID0gW107XG4gICAgZm9yIChjb25zdCByb3cgb2Ygc3F1YXJlcykge1xuICAgICAgY29uc3QgbmV3Um93ID0gW107XG4gICAgICBmb3IgKGNvbnN0IHNxdWFyZSBvZiByb3cpIHtcbiAgICAgICAgY29uc3QgbmV3U3F1YXJlID0gbmV3IFNxdWFyZShzcXVhcmUucm93LCBzcXVhcmUuY29sKTtcbiAgICAgICAgbmV3Um93LnB1c2gobmV3U3F1YXJlKTtcbiAgICAgICAgaWYgKHNxdWFyZS5vY2N1cGFudCkge1xuICAgICAgICAgIG5ld1NxdWFyZS5wbGFjZShzcXVhcmUub2NjdXBhbnQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBuZXdTcXVhcmVzLnB1c2gobmV3Um93KTtcbiAgICB9XG4gICAgdGhpcy5zcXVhcmVzID0gbmV3U3F1YXJlcztcbiAgfVxuICBcbiAgcGxhY2UocGllY2U6IFBpZWNlLCByb3c6IG51bWJlciwgY29sOiBudW1iZXIpOiBCb2FyZFN0YXRlIHtcbiAgICBjb25zdCBzcXVhcmUgPSB0aGlzLmdldFNxdWFyZShyb3csIGNvbCk7XG4gICAgaWYgKCFzcXVhcmUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignc3F1YXJlIG91dCBvZiBib3VuZHMnICsgcm93ICsgJywnICsgY29sKTtcbiAgICB9XG4gICAgc3F1YXJlLnBsYWNlKHBpZWNlKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGVtcHR5KHJvdzogbnVtYmVyLCBjb2w6IG51bWJlcik6IEJvYXJkU3RhdGUge1xuICAgIGNvbnN0IHNxdWFyZSA9IHRoaXMuZ2V0U3F1YXJlKHJvdywgY29sKTtcbiAgICBpZiAoIXNxdWFyZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdzcXVhcmUgb3V0IG9mIGJvdW5kcycgKyByb3cgKyAnLCcgKyBjb2wpO1xuICAgIH1cbiAgICBzcXVhcmUuZW1wdHkoKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGdldFNxdWFyZShyb3c6IG51bWJlciwgY29sOiBudW1iZXIpOiBTcXVhcmUgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLnNxdWFyZXNbcm93XT8uW2NvbF07XG4gIH1cblxuICB0b1N0cmluZygpOiBzdHJpbmcge1xuICAgIGxldCByZXN1bHQgPSAnJztcbiAgICBmb3IgKGNvbnN0IHJvdyBvZiB0aGlzLnNxdWFyZXMpIHtcbiAgICAgIGZvciAoY29uc3Qgc3F1YXJlIG9mIHJvdykge1xuICAgICAgICByZXN1bHQgKz0gc3F1YXJlLnRvU3RyaW5nKCk7XG4gICAgICB9XG4gICAgICByZXN1bHQgKz0gJzxicj4nO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG59XG4iLCJpbXBvcnQge1xuICBQYWlyLFxuICBlcXVhbHMsXG4gIGRlZHVwLFxuICBoYXNoLFxuICB1bmhhc2gsXG4gIE5vdEltcGxlbWVudGVkRXJyb3IsXG4gIFBBV05fSE9NRV9SQU5LLFxuICBDb2xvcixcbiAgTW92ZVR5cGUsXG59IGZyb20gJy4vY29uc3QnO1xuaW1wb3J0IE1vdmUgZnJvbSAnLi9tb3ZlJztcbmltcG9ydCBCb2FyZFN0YXRlIGZyb20gJy4vc3RhdGUnO1xuXG4vLyBDbGFzc2VzXG5cbmV4cG9ydCBjbGFzcyBQaWVjZSB7XG4gIG5hbWU6IHN0cmluZztcbiAgaXNSb3lhbDogYm9vbGVhbjtcbiAgY29uc3RydWN0b3IocHVibGljIGNvbG9yOiBDb2xvcikge1xuICAgIC8vIHRoaXMuc3F1YXJlcyA9IHRoaXMuZ2FtZT8uc3RhdGUuc3F1YXJlcztcbiAgfVxuICBsZWdhbE1vdmVzKFxuICAgIHJvdzogbnVtYmVyLFxuICAgIGNvbDogbnVtYmVyLFxuICAgIHN0YXRlOiBCb2FyZFN0YXRlLFxuICAgIG1vdmVIaXN0b3J5OiBNb3ZlW11cbiAgKTogTW92ZVtdIHtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgdG9TdHJpbmcoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5uYW1lOyAvLyBncmFwaGljIGhlcmUgbGF0ZXIgb3IgdW5pY29kZVxuICB9XG5cbiAgZ2V0IGltZygpOiBzdHJpbmcge1xuICAgIC8vIG92ZXJyaWRlXG4gICAgcmV0dXJuIHRoaXMuY29sb3IgPT09IENvbG9yLldISVRFID8gJ19sdC5wbmcnIDogJ19kdC5wbmcnO1xuICB9XG5cbiAgcmVuZGVyKCk6IEhUTUxFbGVtZW50IHtcbiAgICBjb25zdCByZXN1bHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICByZXN1bHQuc2V0QXR0cmlidXRlKCdjbGFzcycsICdwaWVjZScpO1xuICAgIHJlc3VsdC5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgdXJsKC9kaXN0L2ltZy8ke3RoaXMuaW1nfSlgO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cbn1cblxuY2xhc3MgTGVhcGVyIGV4dGVuZHMgUGllY2Uge1xuICBtb3ZlczogUGFpcltdO1xuICBsZWdhbE1vdmVzKHJvdzogbnVtYmVyLCBjb2w6IG51bWJlciwgc3RhdGU6IEJvYXJkU3RhdGUpOiBNb3ZlW10ge1xuICAgIGxldCB0YXJnZXRzID0gdGhpcy5tb3Zlc1xuICAgICAgLmZsYXRNYXAoKG1vdmUpID0+XG4gICAgICAgIFstMSwgMV1cbiAgICAgICAgICAubWFwKChzaWduKSA9PiBtb3ZlLnJvdyAqIHNpZ24pXG4gICAgICAgICAgLmZsYXRNYXAoKGZpcnN0KSA9PlxuICAgICAgICAgICAgWy0xLCAxXS5mbGF0TWFwKChzaWduKSA9PiBbXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByb3c6IGZpcnN0LFxuICAgICAgICAgICAgICAgIGNvbDogbW92ZS5jb2wgKiBzaWduLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcm93OiBtb3ZlLmNvbCAqIHNpZ24sXG4gICAgICAgICAgICAgICAgY29sOiBmaXJzdCxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF0pXG4gICAgICAgICAgKVxuICAgICAgKVxuICAgICAgLm1hcCgocmVsYXRpdmUpID0+ICh7cm93OiByb3cgKyByZWxhdGl2ZS5yb3csIGNvbDogY29sICsgcmVsYXRpdmUuY29sfSkpO1xuXG4gICAgdGFyZ2V0cyA9IHRhcmdldHMuZmlsdGVyKFxuICAgICAgKHRhcmdldCkgPT5cbiAgICAgICAgIShcbiAgICAgICAgICB0YXJnZXQucm93IDwgMCB8fFxuICAgICAgICAgIHRhcmdldC5jb2wgPCAwIHx8XG4gICAgICAgICAgdGFyZ2V0LnJvdyA+PSBzdGF0ZS5yYW5rcyB8fFxuICAgICAgICAgIHRhcmdldC5jb2wgPj0gc3RhdGUuZmlsZXNcbiAgICAgICAgKVxuICAgICk7XG4gICAgdGFyZ2V0cyA9IHRhcmdldHMuZmlsdGVyKCh0YXJnZXQpID0+IHtcbiAgICAgIGNvbnN0IG9jY3VwYW50ID0gc3RhdGUuZ2V0U3F1YXJlKHRhcmdldC5yb3csIHRhcmdldC5jb2wpPy5vY2N1cGFudDtcbiAgICAgIHJldHVybiAhb2NjdXBhbnQgfHwgb2NjdXBhbnQuY29sb3IgIT09IHRoaXMuY29sb3I7XG4gICAgfSk7XG4gICAgY29uc3QgbW92ZXM6IE1vdmVbXSA9IFtdO1xuICAgIGZvciAoY29uc3QgdGFyZ2V0IG9mIGRlZHVwKHRhcmdldHMpKSB7XG4gICAgICBjb25zdCBvY2N1cGFudCA9IHN0YXRlLmdldFNxdWFyZSh0YXJnZXQucm93LCB0YXJnZXQuY29sKT8ub2NjdXBhbnQ7XG4gICAgICBjb25zdCBpc0NhcHR1cmUgPSBvY2N1cGFudCAmJiBvY2N1cGFudC5jb2xvciAhPT0gdGhpcy5jb2xvcjtcblxuICAgICAgbW92ZXMucHVzaCh7XG4gICAgICAgIGJlZm9yZTogc3RhdGUsXG4gICAgICAgIGFmdGVyOiBuZXcgQm9hcmRTdGF0ZShzdGF0ZS5zcXVhcmVzKVxuICAgICAgICAgIC5wbGFjZSh0aGlzLCB0YXJnZXQucm93LCB0YXJnZXQuY29sKVxuICAgICAgICAgIC5lbXB0eShyb3csIGNvbCksXG4gICAgICAgIHBpZWNlOiB0aGlzLFxuICAgICAgICBzdGFydDoge3JvdywgY29sfSxcbiAgICAgICAgZW5kOiB0YXJnZXQsXG4gICAgICAgIGlzQ2FwdHVyZSxcbiAgICAgICAgY2FwdHVyZWQ6IG9jY3VwYW50ID8gW29jY3VwYW50XSA6IFtdLFxuICAgICAgICBjb2xvcjogdGhpcy5jb2xvcixcbiAgICAgICAgdHlwZTogTW92ZVR5cGUuTU9WRSxcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gbW92ZXM7XG4gIH1cbn1cblxuY2xhc3MgUmlkZXIgZXh0ZW5kcyBQaWVjZSB7XG4gIG1vdmVzOiBQYWlyW107XG4gIGxlZ2FsTW92ZXMocm93OiBudW1iZXIsIGNvbDogbnVtYmVyLCBzdGF0ZTogQm9hcmRTdGF0ZSk6IE1vdmVbXSB7XG4gICAgcmV0dXJuIGRlZHVwKFxuICAgICAgdGhpcy5tb3Zlcy5mbGF0TWFwKChtb3ZlKSA9PlxuICAgICAgICBbLTEsIDFdXG4gICAgICAgICAgLm1hcCgoc2lnbikgPT4gbW92ZS5yb3cgKiBzaWduKVxuICAgICAgICAgIC5mbGF0TWFwKChmaXJzdCkgPT5cbiAgICAgICAgICAgIFstMSwgMV0uZmxhdE1hcCgoc2lnbikgPT4gW1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcm93OiBmaXJzdCxcbiAgICAgICAgICAgICAgICBjb2w6IG1vdmUuY29sICogc2lnbixcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJvdzogbW92ZS5jb2wgKiBzaWduLFxuICAgICAgICAgICAgICAgIGNvbDogZmlyc3QsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBdKVxuICAgICAgICAgIClcbiAgICAgIClcbiAgICApLmZsYXRNYXAoKGRpcikgPT4gdGhpcy5yaWRlKHJvdywgY29sLCBkaXIucm93LCBkaXIuY29sLCBzdGF0ZSkpO1xuICB9XG5cbiAgcHJpdmF0ZSByaWRlKFxuICAgIHJvdzogbnVtYmVyLFxuICAgIGNvbDogbnVtYmVyLFxuICAgIHJvd0RpcjogbnVtYmVyLFxuICAgIGNvbERpcjogbnVtYmVyLFxuICAgIHN0YXRlOiBCb2FyZFN0YXRlXG4gICk6IE1vdmVbXSB7XG4gICAgLy8gcmlkZSBpbiBvbmUgZGlyZWN0aW9uIHVudGlsIHdlIGhpdCB0aGUgZWRnZSBvZiBib2FyZCBvciBhbm90aGVyIHBpZWNlXG4gICAgY29uc3QgbW92ZXM6IE1vdmVbXSA9IFtdO1xuICAgIGxldCBzcXVhcmUgPSBzdGF0ZS5nZXRTcXVhcmUocm93ICsgcm93RGlyLCBjb2wgKyBjb2xEaXIpO1xuXG4gICAgd2hpbGUgKHNxdWFyZSkge1xuICAgICAgaWYgKCFzcXVhcmUub2NjdXBhbnQgfHwgc3F1YXJlLm9jY3VwYW50LmNvbG9yICE9PSB0aGlzLmNvbG9yKSB7XG4gICAgICAgIGNvbnN0IGlzQ2FwdHVyZSA9XG4gICAgICAgICAgc3F1YXJlLm9jY3VwYW50ICYmIHNxdWFyZS5vY2N1cGFudC5jb2xvciAhPT0gdGhpcy5jb2xvcjtcbiAgICAgICAgbW92ZXMucHVzaCh7XG4gICAgICAgICAgYmVmb3JlOiBzdGF0ZSxcbiAgICAgICAgICBhZnRlcjogbmV3IEJvYXJkU3RhdGUoc3RhdGUuc3F1YXJlcylcbiAgICAgICAgICAgIC5wbGFjZSh0aGlzLCBzcXVhcmUucm93LCBzcXVhcmUuY29sKVxuICAgICAgICAgICAgLmVtcHR5KHJvdywgY29sKSxcbiAgICAgICAgICBwaWVjZTogdGhpcyxcbiAgICAgICAgICBzdGFydDoge3JvdywgY29sfSxcbiAgICAgICAgICBlbmQ6IHNxdWFyZSxcbiAgICAgICAgICBpc0NhcHR1cmUsXG4gICAgICAgICAgY2FwdHVyZWQ6IGlzQ2FwdHVyZSA/IFtzcXVhcmUub2NjdXBhbnRdIDogW10sXG4gICAgICAgICAgY29sb3I6IHRoaXMuY29sb3IsXG4gICAgICAgICAgdHlwZTogTW92ZVR5cGUuTU9WRSxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAoc3F1YXJlLm9jY3VwYW50KSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgc3F1YXJlID0gc3RhdGUuZ2V0U3F1YXJlKHNxdWFyZS5yb3cgKyByb3dEaXIsIHNxdWFyZS5jb2wgKyBjb2xEaXIpO1xuICAgIH1cbiAgICByZXR1cm4gbW92ZXM7XG4gIH1cbn1cblxuLy8gUGllY2VzXG5cbmV4cG9ydCBjbGFzcyBCaXNob3AgZXh0ZW5kcyBSaWRlciB7XG4gIG5hbWUgPSAnQic7XG4gIG1vdmVzID0gW3tyb3c6IDEsIGNvbDogMX1dO1xuXG4gIGdldCBpbWcoKTogc3RyaW5nIHtcbiAgICBpZiAodGhpcy5jb2xvciA9PT0gQ29sb3IuQkxBQ0spIHtcbiAgICAgIHJldHVybiAnYmR0LnBuZyc7XG4gICAgfSBlbHNlIGlmICh0aGlzLmNvbG9yID09PSBDb2xvci5XSElURSkge1xuICAgICAgcmV0dXJuICdibHQucG5nJztcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgJ25vIGltYWdlIGZvciBjb2xvcjogJyArIHRoaXMuY29sb3IgKyAnZm9yIHBpZWNlICcgKyB0aGlzLm5hbWVcbiAgICApO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBSb29rIGV4dGVuZHMgUmlkZXIge1xuICBuYW1lID0gJ1InO1xuICBtb3ZlcyA9IFt7cm93OiAxLCBjb2w6IDB9XTtcblxuICBnZXQgaW1nKCk6IHN0cmluZyB7XG4gICAgaWYgKHRoaXMuY29sb3IgPT09IENvbG9yLkJMQUNLKSB7XG4gICAgICByZXR1cm4gJ3JkdDQ1LnBuZyc7XG4gICAgfSBlbHNlIGlmICh0aGlzLmNvbG9yID09PSBDb2xvci5XSElURSkge1xuICAgICAgcmV0dXJuICdybHQ0NS5wbmcnO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAnbm8gaW1hZ2UgZm9yIGNvbG9yOiAnICsgdGhpcy5jb2xvciArICdmb3IgcGllY2UgJyArIHRoaXMubmFtZVxuICAgICk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIEtuaWdodCBleHRlbmRzIExlYXBlciB7XG4gIG5hbWUgPSAnTic7XG4gIG1vdmVzID0gW3tyb3c6IDEsIGNvbDogMn1dO1xuXG4gIGdldCBpbWcoKTogc3RyaW5nIHtcbiAgICBpZiAodGhpcy5jb2xvciA9PT0gQ29sb3IuQkxBQ0spIHtcbiAgICAgIHJldHVybiAnbmR0MjYucG5nJztcbiAgICB9IGVsc2UgaWYgKHRoaXMuY29sb3IgPT09IENvbG9yLldISVRFKSB7XG4gICAgICByZXR1cm4gJ25sdC5wbmcnO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAnbm8gaW1hZ2UgZm9yIGNvbG9yOiAnICsgdGhpcy5jb2xvciArICdmb3IgcGllY2UgJyArIHRoaXMubmFtZVxuICAgICk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFF1ZWVuIGV4dGVuZHMgUmlkZXIge1xuICBuYW1lID0gJ1EnO1xuICBtb3ZlcyA9IFtcbiAgICB7cm93OiAxLCBjb2w6IDF9LFxuICAgIHtyb3c6IDEsIGNvbDogMH0sXG4gIF07XG5cbiAgZ2V0IGltZygpOiBzdHJpbmcge1xuICAgIGlmICh0aGlzLmNvbG9yID09PSBDb2xvci5CTEFDSykge1xuICAgICAgcmV0dXJuICdxZHQ0NS5wbmcnO1xuICAgIH0gZWxzZSBpZiAodGhpcy5jb2xvciA9PT0gQ29sb3IuV0hJVEUpIHtcbiAgICAgIHJldHVybiAncWx0NDUucG5nJztcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgJ25vIGltYWdlIGZvciBjb2xvcjogJyArIHRoaXMuY29sb3IgKyAnZm9yIHBpZWNlICcgKyB0aGlzLm5hbWVcbiAgICApO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBLaW5nIGV4dGVuZHMgTGVhcGVyIHtcbiAgbmFtZSA9ICdLJztcbiAgbW92ZXMgPSBbXG4gICAge3JvdzogMSwgY29sOiAxfSxcbiAgICB7cm93OiAxLCBjb2w6IDB9LFxuICBdO1xuICBpc1JveWFsID0gdHJ1ZTtcblxuICBnZXQgaW1nKCk6IHN0cmluZyB7XG4gICAgaWYgKHRoaXMuY29sb3IgPT09IENvbG9yLkJMQUNLKSB7XG4gICAgICByZXR1cm4gJ2tkdDQ1LnBuZyc7XG4gICAgfSBlbHNlIGlmICh0aGlzLmNvbG9yID09PSBDb2xvci5XSElURSkge1xuICAgICAgcmV0dXJuICdrbHQucG5nJztcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgJ25vIGltYWdlIGZvciBjb2xvcjogJyArIHRoaXMuY29sb3IgKyAnZm9yIHBpZWNlICcgKyB0aGlzLm5hbWVcbiAgICApO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBQYXduIGV4dGVuZHMgUGllY2Uge1xuICBuYW1lID0gJ1AnO1xuICBsZWdhbE1vdmVzKFxuICAgIHJvdzogbnVtYmVyLFxuICAgIGNvbDogbnVtYmVyLFxuICAgIHN0YXRlOiBCb2FyZFN0YXRlLFxuICAgIG1vdmVIaXN0b3J5OiBNb3ZlW11cbiAgKTogTW92ZVtdIHtcbiAgICAvLyBub3JtYWwgbW92ZS4gMiBzdGVwLiBjYXB0dXJlLCBlbiBwYXNzYW50XG4gICAgY29uc3QgeURpciA9IHRoaXMuY29sb3IgPT09IENvbG9yLldISVRFID8gLTEgOiAxO1xuICAgIGxldCBtb3ZlVGFyZ2V0cyA9IFt7cm93OiByb3cgKyB5RGlyLCBjb2x9XTtcblxuICAgIC8vIDIgbW92ZVxuICAgIGlmIChcbiAgICAgIChyb3cgPT09IFBBV05fSE9NRV9SQU5LICYmIHRoaXMuY29sb3IgPT09IENvbG9yLkJMQUNLKSB8fFxuICAgICAgKHJvdyA9PT0gc3RhdGUucmFua3MgLSBQQVdOX0hPTUVfUkFOSyAtIDEgJiYgdGhpcy5jb2xvciA9PT0gQ29sb3IuV0hJVEUpXG4gICAgKSB7XG4gICAgICBtb3ZlVGFyZ2V0cy5wdXNoKHtyb3c6IHJvdyArIDIgKiB5RGlyLCBjb2x9KTtcbiAgICB9XG5cbiAgICBtb3ZlVGFyZ2V0cyA9IG1vdmVUYXJnZXRzLmZpbHRlcigodGFyZ2V0KSA9PiB7XG4gICAgICBjb25zdCBzcXVhcmUgPSBzdGF0ZS5nZXRTcXVhcmUodGFyZ2V0LnJvdywgdGFyZ2V0LmNvbCk7XG4gICAgICByZXR1cm4gIXNxdWFyZS5vY2N1cGFudDtcbiAgICB9KTtcblxuICAgIGxldCBjYXB0dXJlVGFyZ2V0cyA9IFtcbiAgICAgIHtyb3c6IHJvdyArIHlEaXIsIGNvbDogY29sIC0gMX0sXG4gICAgICB7cm93OiByb3cgKyB5RGlyLCBjb2w6IGNvbCArIDF9LFxuICAgIF07XG5cbiAgICBjYXB0dXJlVGFyZ2V0cyA9IGNhcHR1cmVUYXJnZXRzLmZpbHRlcigodGFyZ2V0KSA9PiB7XG4gICAgICBjb25zdCBvY2N1cGFudCA9IHN0YXRlLmdldFNxdWFyZSh0YXJnZXQucm93LCB0YXJnZXQuY29sKT8ub2NjdXBhbnQ7XG4gICAgICByZXR1cm4gb2NjdXBhbnQgJiYgb2NjdXBhbnQuY29sb3IgIT09IHRoaXMuY29sb3I7XG4gICAgfSk7XG5cbiAgICBjb25zdCBtb3ZlczogTW92ZVtdID0gW107XG4gICAgZm9yIChjb25zdCB0YXJnZXQgb2YgbW92ZVRhcmdldHMpIHtcbiAgICAgIG1vdmVzLnB1c2goe1xuICAgICAgICBiZWZvcmU6IHN0YXRlLFxuICAgICAgICBhZnRlcjogbmV3IEJvYXJkU3RhdGUoc3RhdGUuc3F1YXJlcylcbiAgICAgICAgICAucGxhY2UodGhpcywgdGFyZ2V0LnJvdywgdGFyZ2V0LmNvbClcbiAgICAgICAgICAuZW1wdHkocm93LCBjb2wpLFxuICAgICAgICBwaWVjZTogdGhpcyxcbiAgICAgICAgc3RhcnQ6IHtyb3csIGNvbH0sXG4gICAgICAgIGVuZDogdGFyZ2V0LFxuICAgICAgICBpc0NhcHR1cmU6IGZhbHNlLFxuICAgICAgICBjYXB0dXJlZDogW10sXG4gICAgICAgIGNvbG9yOiB0aGlzLmNvbG9yLFxuICAgICAgICB0eXBlOiBNb3ZlVHlwZS5NT1ZFLFxuICAgICAgfSk7XG4gICAgfVxuICAgIGZvciAoY29uc3QgdGFyZ2V0IG9mIGNhcHR1cmVUYXJnZXRzKSB7XG4gICAgICBtb3Zlcy5wdXNoKHtcbiAgICAgICAgYmVmb3JlOiBzdGF0ZSxcbiAgICAgICAgYWZ0ZXI6IG5ldyBCb2FyZFN0YXRlKHN0YXRlLnNxdWFyZXMpXG4gICAgICAgICAgLnBsYWNlKHRoaXMsIHRhcmdldC5yb3csIHRhcmdldC5jb2wpXG4gICAgICAgICAgLmVtcHR5KHJvdywgY29sKSxcbiAgICAgICAgcGllY2U6IHRoaXMsXG4gICAgICAgIHN0YXJ0OiB7cm93LCBjb2x9LFxuICAgICAgICBlbmQ6IHRhcmdldCxcbiAgICAgICAgaXNDYXB0dXJlOiB0cnVlLFxuICAgICAgICBjYXB0dXJlZDogW3N0YXRlLmdldFNxdWFyZSh0YXJnZXQucm93LCB0YXJnZXQuY29sKS5vY2N1cGFudF0sXG4gICAgICAgIGNvbG9yOiB0aGlzLmNvbG9yLFxuICAgICAgICB0eXBlOiBNb3ZlVHlwZS5NT1ZFLFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGVucGFzc2FudCA9IHRoaXMuZW5QYXNzYW50KHJvdywgY29sLCBzdGF0ZSwgbW92ZUhpc3RvcnkpO1xuICAgIGlmIChlbnBhc3NhbnQpIHtcbiAgICAgIG1vdmVzLnB1c2goZW5wYXNzYW50KTtcbiAgICB9XG4gICAgcmV0dXJuIG1vdmVzO1xuICB9XG5cbiAgcHJpdmF0ZSBlblBhc3NhbnQoXG4gICAgcm93OiBudW1iZXIsXG4gICAgY29sOiBudW1iZXIsXG4gICAgc3RhdGU6IEJvYXJkU3RhdGUsXG4gICAgbW92ZUhpc3Rvcnk6IE1vdmVbXVxuICApOiBNb3ZlIHwgdW5kZWZpbmVkIHtcbiAgICBjb25zdCB5RGlyID0gdGhpcy5jb2xvciA9PT0gQ29sb3IuV0hJVEUgPyAtMSA6IDE7XG4gICAgLy8gZW4gcGFzc2FudFxuICAgIGlmIChtb3ZlSGlzdG9yeS5sZW5ndGgpIHtcbiAgICAgIGNvbnN0IGxhc3RNb3ZlID0gbW92ZUhpc3RvcnlbbW92ZUhpc3RvcnkubGVuZ3RoIC0gMV07XG4gICAgICBpZiAoXG4gICAgICAgIGxhc3RNb3ZlLnBpZWNlIGluc3RhbmNlb2YgUGF3biAmJlxuICAgICAgICBsYXN0TW92ZS5waWVjZS5jb2xvciAhPT0gdGhpcy5jb2xvciAmJlxuICAgICAgICBNYXRoLmFicyhsYXN0TW92ZS5lbmQuY29sIC0gY29sKSA9PT0gMSAmJlxuICAgICAgICBNYXRoLmFicyhsYXN0TW92ZS5lbmQucm93IC0gbGFzdE1vdmUuc3RhcnQucm93KSA9PT0gMiAmJlxuICAgICAgICBsYXN0TW92ZS5lbmQucm93ID09PSByb3dcbiAgICAgICkge1xuICAgICAgICAvLyBuZWVkIHRvIGNvcHkgc3RhdGUgZm9yIGhpc3RvcnlcbiAgICAgICAgY29uc3QgYmVmb3JlID0gc3RhdGU7XG4gICAgICAgIGNvbnN0IHN0YXJ0ID0ge3JvdywgY29sfTtcbiAgICAgICAgY29uc3QgZW5kID0ge3Jvdzogcm93ICsgeURpciwgY29sOiBsYXN0TW92ZS5lbmQuY29sfTtcbiAgICAgICAgY29uc3QgaXNDYXB0dXJlID0gdHJ1ZTtcbiAgICAgICAgY29uc3QgY2FwdHVyZWQgPSBpc0NhcHR1cmUgPyBbbGFzdE1vdmUucGllY2VdIDogW107XG4gICAgICAgIGNvbnN0IGNvbG9yID0gdGhpcy5jb2xvcjtcbiAgICAgICAgY29uc3QgdHlwZSA9IE1vdmVUeXBlLkVOUEFTU0FOVDtcblxuICAgICAgICBjb25zdCBhZnRlciA9IG5ldyBCb2FyZFN0YXRlKHN0YXRlLnNxdWFyZXMpXG4gICAgICAgICAgLnBsYWNlKHRoaXMsIGVuZC5yb3csIGVuZC5jb2wpXG4gICAgICAgICAgLmVtcHR5KHJvdywgY29sKVxuICAgICAgICAgIC8vIGNhcHR1cmluZyB0aGUgcGF3blxuICAgICAgICAgIC5lbXB0eShsYXN0TW92ZS5lbmQucm93LCBsYXN0TW92ZS5lbmQuY29sKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBiZWZvcmUsXG4gICAgICAgICAgYWZ0ZXIsXG4gICAgICAgICAgcGllY2U6IHRoaXMsXG4gICAgICAgICAgc3RhcnQsXG4gICAgICAgICAgZW5kLFxuICAgICAgICAgIGlzQ2FwdHVyZSxcbiAgICAgICAgICBjYXB0dXJlZCxcbiAgICAgICAgICBjb2xvcixcbiAgICAgICAgICB0eXBlLFxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm47XG4gIH1cbiAgcHJvbW90ZSgpIHtcbiAgICAvLyBUT0RPXG4gIH1cbiAgZ2V0IGltZygpOiBzdHJpbmcge1xuICAgIGlmICh0aGlzLmNvbG9yID09PSBDb2xvci5CTEFDSykge1xuICAgICAgcmV0dXJuICdwZHQ0NS5wbmcnO1xuICAgIH0gZWxzZSBpZiAodGhpcy5jb2xvciA9PT0gQ29sb3IuV0hJVEUpIHtcbiAgICAgIHJldHVybiAncGx0NDUucG5nJztcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgJ25vIGltYWdlIGZvciBjb2xvcjogJyArIHRoaXMuY29sb3IgKyAnZm9yIHBpZWNlICcgKyB0aGlzLm5hbWVcbiAgICApO1xuICB9XG59XG5cbi8vIGludGVyZmFjZSBQbGFjZVBpZWNlcyB7XG4vLyAgIFtrZXk6IHN0cmluZ106IFBpZWNlO1xuLy8gfVxuXG4vLyBQbGF5Z3JvdW5kXG5cbi8vIGNvbnN0IFNRVUFSRV9TSVpFID0gNTA7IC8vcHhcbi8vIGxldCBTRUxFQ1RFRF9QSUVDRTogUGllY2UgfCB1bmRlZmluZWQ7XG5cbi8vIGNvbnN0IHN0ZFBvcyA9IHtcbi8vICAgJzAsMCc6IG5ldyBSb29rKENvbG9yLkJMQUNLKSxcbi8vICAgJzAsMSc6IG5ldyBLbmlnaHQoQ29sb3IuQkxBQ0spLFxuLy8gICAnMCwyJzogbmV3IEJpc2hvcChDb2xvci5CTEFDSyksXG4vLyAgICcwLDMnOiBuZXcgUXVlZW4oQ29sb3IuQkxBQ0spLFxuLy8gICAnMCw0JzogbmV3IEtpbmcoQ29sb3IuQkxBQ0spLFxuLy8gICAnMCw1JzogbmV3IEJpc2hvcChDb2xvci5CTEFDSyksXG4vLyAgICcwLDYnOiBuZXcgS25pZ2h0KENvbG9yLkJMQUNLKSxcbi8vICAgJzAsNyc6IG5ldyBSb29rKENvbG9yLkJMQUNLKSxcbi8vICAgJzEsMCc6IG5ldyBQYXduKENvbG9yLkJMQUNLKSxcbi8vICAgJzEsMSc6IG5ldyBQYXduKENvbG9yLkJMQUNLKSxcbi8vICAgJzEsMic6IG5ldyBQYXduKENvbG9yLkJMQUNLKSxcbi8vICAgJzEsMyc6IG5ldyBQYXduKENvbG9yLkJMQUNLKSxcbi8vICAgJzEsNCc6IG5ldyBQYXduKENvbG9yLkJMQUNLKSxcbi8vICAgJzEsNSc6IG5ldyBQYXduKENvbG9yLkJMQUNLKSxcbi8vICAgJzEsNic6IG5ldyBQYXduKENvbG9yLkJMQUNLKSxcbi8vICAgJzEsNyc6IG5ldyBQYXduKENvbG9yLkJMQUNLKSxcbi8vICAgJzYsMCc6IG5ldyBQYXduKENvbG9yLldISVRFKSxcbi8vICAgJzYsMSc6IG5ldyBQYXduKENvbG9yLldISVRFKSxcbi8vICAgJzYsMic6IG5ldyBQYXduKENvbG9yLldISVRFKSxcbi8vICAgJzYsMyc6IG5ldyBQYXduKENvbG9yLldISVRFKSxcbi8vICAgJzYsNCc6IG5ldyBQYXduKENvbG9yLldISVRFKSxcbi8vICAgJzYsNSc6IG5ldyBQYXduKENvbG9yLldISVRFKSxcbi8vICAgJzYsNic6IG5ldyBQYXduKENvbG9yLldISVRFKSxcbi8vICAgJzYsNyc6IG5ldyBQYXduKENvbG9yLldISVRFKSxcbi8vICAgJzcsMCc6IG5ldyBSb29rKENvbG9yLldISVRFKSxcbi8vICAgJzcsMSc6IG5ldyBLbmlnaHQoQ29sb3IuV0hJVEUpLFxuLy8gICAnNywyJzogbmV3IEJpc2hvcChDb2xvci5XSElURSksXG4vLyAgICc3LDMnOiBuZXcgUXVlZW4oQ29sb3IuV0hJVEUpLFxuLy8gICAnNyw0JzogbmV3IEtpbmcoQ29sb3IuV0hJVEUpLFxuLy8gICAnNyw1JzogbmV3IEJpc2hvcChDb2xvci5XSElURSksXG4vLyAgICc3LDYnOiBuZXcgS25pZ2h0KENvbG9yLldISVRFKSxcbi8vICAgJzcsNyc6IG5ldyBSb29rKENvbG9yLldISVRFKSxcbi8vIH07XG5cbi8vIGV4cG9ydCBjb25zdCBTVERfQk9BUkQgPSBCb2FyZFN0YXRlLmNyZWF0ZSg4LCA4LCBzdGRQb3MpO1xuLy8gZXhwb3J0IGNvbnN0IFNURF9HQU1FID0gbmV3IEdhbWUoQm9hcmRTdGF0ZS5jcmVhdGUoOCwgOCwgc3RkUG9zKSk7XG4iLCJpbXBvcnQgQm9hcmRTdGF0ZSBmcm9tICcuL3N0YXRlJztcbmltcG9ydCBNb3ZlIGZyb20gJy4vbW92ZSc7XG5pbXBvcnQge1BpZWNlLCBLaW5nLCBSb29rLCBQYXduLCBLbmlnaHQsIEJpc2hvcCwgUXVlZW59IGZyb20gJy4vcGllY2UnO1xuaW1wb3J0IFNxdWFyZSBmcm9tICcuL3NxdWFyZSc7XG5pbXBvcnQge1xuICBDb2xvcixcbiAgUGFpcixcbiAgTm90SW1wbGVtZW50ZWRFcnJvcixcbiAgTW92ZVR5cGUsXG4gIGVxdWFscyxcbn0gZnJvbSAnLi9jb25zdCc7XG5cbmZ1bmN0aW9uIGdlbmVyYXRlU3RhcnRTdGF0ZSgpOiBCb2FyZFN0YXRlIHtcbiAgY29uc3QgcGllY2VQb3NpdGlvbnMgPSB7XG4gICAgMDoge1xuICAgICAgMDogbmV3IFJvb2soQ29sb3IuQkxBQ0spLFxuICAgICAgMTogbmV3IEtuaWdodChDb2xvci5CTEFDSyksXG4gICAgICAyOiBuZXcgQmlzaG9wKENvbG9yLkJMQUNLKSxcbiAgICAgIDM6IG5ldyBRdWVlbihDb2xvci5CTEFDSyksXG4gICAgICA0OiBuZXcgS2luZyhDb2xvci5CTEFDSyksXG4gICAgICA1OiBuZXcgQmlzaG9wKENvbG9yLkJMQUNLKSxcbiAgICAgIDY6IG5ldyBLbmlnaHQoQ29sb3IuQkxBQ0spLFxuICAgICAgNzogbmV3IFJvb2soQ29sb3IuQkxBQ0spLFxuICAgIH0sXG4gICAgMToge30sXG4gICAgNjoge30sXG4gICAgNzoge1xuICAgICAgMDogbmV3IFJvb2soQ29sb3IuV0hJVEUpLFxuICAgICAgMTogbmV3IEtuaWdodChDb2xvci5XSElURSksXG4gICAgICAyOiBuZXcgQmlzaG9wKENvbG9yLldISVRFKSxcbiAgICAgIDM6IG5ldyBRdWVlbihDb2xvci5XSElURSksXG4gICAgICA0OiBuZXcgS2luZyhDb2xvci5XSElURSksXG4gICAgICA1OiBuZXcgQmlzaG9wKENvbG9yLldISVRFKSxcbiAgICAgIDY6IG5ldyBLbmlnaHQoQ29sb3IuV0hJVEUpLFxuICAgICAgNzogbmV3IFJvb2soQ29sb3IuV0hJVEUpLFxuICAgIH1cbiAgfVxuICBmb3IgKGxldCBjb2w9MDsgY29sIDwgODsgY29sKyspIHtcbiAgICBwaWVjZVBvc2l0aW9uc1sxXVtjb2xdID0gbmV3IFBhd24oQ29sb3IuQkxBQ0spO1xuICAgIHBpZWNlUG9zaXRpb25zWzZdW2NvbF0gPSBuZXcgUGF3bihDb2xvci5XSElURSk7XG4gIH1cbiAgY29uc3Qgc3F1YXJlczogU3F1YXJlW11bXSA9IFtdO1xuICBmb3IgKGxldCBpPTA7IGkgPCA4OyBpKyspIHtcbiAgICBjb25zdCByb3c6IFNxdWFyZVtdID0gW107XG4gICAgZm9yIChsZXQgaj0wOyBqIDwgODsgaisrKSB7XG4gICAgICBjb25zdCBzcXVhcmUgPSBuZXcgU3F1YXJlKGksIGopO1xuICAgICAgcm93LnB1c2goc3F1YXJlKTtcbiAgICAgIGlmIChwaWVjZVBvc2l0aW9uc1tpXT8uW2pdKSB7XG4gICAgICAgIHNxdWFyZS5wbGFjZShwaWVjZVBvc2l0aW9uc1tpXVtqXSk7XG4gICAgICB9XG4gICAgfVxuICAgIHNxdWFyZXMucHVzaChyb3cpO1xuICB9XG4gIHJldHVybiBuZXcgQm9hcmRTdGF0ZShzcXVhcmVzKTtcbn1cblxuZXhwb3J0IGNsYXNzIEdhbWUge1xuICBzdGF0ZTogQm9hcmRTdGF0ZTtcbiAgbW92ZUhpc3Rvcnk6IE1vdmVbXTtcbiAgc3RhdGVIaXN0b3J5OiBCb2FyZFN0YXRlW107XG5cbiAgLy8gUEFXTl9IT01FX1JBTksgPSAxO1xuXG4gIGNvbnN0cnVjdG9yKGluaXRpYWw/OiBCb2FyZFN0YXRlKSB7XG4gICAgdGhpcy5zdGF0ZSA9IGluaXRpYWwgPz8gZ2VuZXJhdGVTdGFydFN0YXRlKCk7XG4gICAgdGhpcy5tb3ZlSGlzdG9yeSA9IFtdO1xuICAgIHRoaXMuc3RhdGVIaXN0b3J5ID0gW107XG4gIH1cblxuICBnZXQgcnVsZXMoKTogc3RyaW5nIHtcbiAgICB0aHJvdyBOb3RJbXBsZW1lbnRlZEVycm9yO1xuICB9XG5cbiAgcGxhY2UocGllY2U6IFBpZWNlLCByb3c6IG51bWJlciwgY29sOiBudW1iZXIpIHtcbiAgICB0aGlzLnN0YXRlLnBsYWNlKHBpZWNlLCByb3csIGNvbCk7XG4gIH1cblxuICB3aW5Db25kaXRpb24oY29sb3I6IENvbG9yLCBzdGF0ZTogQm9hcmRTdGF0ZSk6IGJvb2xlYW4ge1xuICAgIHRocm93IE5vdEltcGxlbWVudGVkRXJyb3I7XG4gIH1cblxuICBtb3ZlKCkge1xuICAgIC8vIHN0YXRlLmF0dGVtcHRNb3ZlICh4MiBmb3IgZG91YmxlIGNoZXNzKVxuICAgIC8vIGNhcHR1cmVFZmZlY3RzXG4gICAgLy8gd2luQ29uZGl0aW9uXG4gIH1cblxuICAvLyBvdmVycmlkZSBpbiB2YXJpYW50c1xuICBhdHRlbXB0TW92ZShwaWVjZTogUGllY2UsIHJvdzogbnVtYmVyLCBjb2w6IG51bWJlciwgdGFyZ2V0OiBTcXVhcmUpIHtcbiAgICBpZiAocGllY2UgaW5zdGFuY2VvZiBLaW5nICYmIHJvdyA9PT0gdGFyZ2V0LnJvd1xuICAgICAgJiYgTWF0aC5hYnMoY29sIC0gdGFyZ2V0LmNvbCkgPT09IDIpIHtcbiAgICAgICAgdGhpcy5jYXN0bGUocGllY2UuY29sb3IsIHJvdywgY29sLCB0YXJnZXQuY29sIC0gY29sID4gMClcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIGNvbnN0IGxlZ2FsTW92ZXMgPSBwaWVjZVxuICAgICAgLmxlZ2FsTW92ZXMocm93LCBjb2wsIHRoaXMuc3RhdGUsIHRoaXMubW92ZUhpc3RvcnkpXG4gICAgICAuZmlsdGVyKChtb3ZlKSA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmlzTW92ZUxlZ2FsKG1vdmUpO1xuICAgICAgfSk7XG4gICAgY29uc3QgbGVnYWxNb3ZlID0gbGVnYWxNb3Zlcy5maW5kKChtb3ZlKSA9PiBlcXVhbHMobW92ZS5lbmQsIHRhcmdldCkpO1xuICAgIGlmICghbGVnYWxNb3ZlKSB7XG4gICAgICBjb25zb2xlLmxvZygnaW52YWxpZCBtb3ZlJywgcGllY2UubmFtZSwgdGFyZ2V0KTtcbiAgICAgIGNvbnNvbGUubG9nKCdsZWdhbCBtb3ZlcyBhcmUnLCBsZWdhbE1vdmVzKTtcbiAgICAgIHJldHVybjsgLy8gaW52YWxpZCBtb3ZlXG4gICAgfVxuICAgIGlmIChsZWdhbE1vdmUuaXNDYXB0dXJlKSB7XG4gICAgICB0aGlzLmNhcHR1cmVFZmZlY3RzKCk7XG4gICAgfVxuXG4gICAgdGhpcy5tb3ZlSGlzdG9yeS5wdXNoKGxlZ2FsTW92ZSk7XG4gICAgdGhpcy5zdGF0ZUhpc3RvcnkucHVzaChsZWdhbE1vdmUuYWZ0ZXIpO1xuICAgIHRoaXMuc3RhdGUgPSBsZWdhbE1vdmUuYWZ0ZXI7XG4gIH1cblxuICBjYXN0bGUoY29sb3I6IENvbG9yLCByb3c6IG51bWJlciwgY29sOiBudW1iZXIsIGtpbmdzaWRlOiBib29sZWFuKSB7XG4gICAgY29uc29sZS5sb2coJ2F0dGVtcHRpbmcgY2FzdGxlJyk7XG4gICAgbGV0IHRhcmdldDogUGFpcjtcbiAgICBsZXQgY29sczogbnVtYmVyW107XG4gICAgbGV0IHJvb2tTcXVhcmU6IFNxdWFyZTtcbiAgICAvLyBjaGVjayBoaXN0b3J5IGZvciBjYXN0bGluZyBvciByb29rL2tpbmcgbW92ZXNcbiAgICBpZiAodGhpcy5tb3ZlSGlzdG9yeS5zb21lKG1vdmUgPT4gbW92ZS5waWVjZSBpbnN0YW5jZW9mIEtpbmcpKSB7XG4gICAgICBjb25zb2xlLmxvZygna2luZyBtb3ZlZCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHJvb2tTcXVhcmVzID0gdGhpcy5zdGF0ZS5zcXVhcmVzLmZsYXQoKS5maWx0ZXIoc3F1YXJlID0+IHNxdWFyZS5vY2N1cGFudCAmJlxuICAgICAgc3F1YXJlLm9jY3VwYW50IGluc3RhbmNlb2YgUm9vayAmJiBzcXVhcmUub2NjdXBhbnQuY29sb3IgPT09IGNvbG9yKTtcbiAgICBpZiAoIXJvb2tTcXVhcmVzKSB7XG4gICAgICBjb25zb2xlLmxvZygnbm8gcm9va3MnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGtpbmdzaWRlKSB7XG4gICAgICB0YXJnZXQgPSB7XG4gICAgICAgIHJvdzogY29sb3IgPT09IENvbG9yLkJMQUNLID8gMCA6IHRoaXMuc3RhdGUucmFua3MgLSAxLFxuICAgICAgICBjb2w6IHRoaXMuc3RhdGUuZmlsZXMgLSAyLFxuICAgICAgfVxuICAgICAgY29scyA9IFtjb2xdO1xuICAgICAgZm9yIChsZXQgaSA9IGNvbCArIDE7IGkgPD0gdGFyZ2V0LmNvbDsgaSsrKSB7XG4gICAgICAgIGNvbHMucHVzaChpKTtcbiAgICAgIH1cbiAgICAgIHJvb2tTcXVhcmUgPSByb29rU3F1YXJlcy5zb3J0KHNxdWFyZSA9PiBzcXVhcmUuY29sKVtyb29rU3F1YXJlcy5sZW5ndGggLSAxXTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGFyZ2V0ID0ge1xuICAgICAgICByb3c6IGNvbG9yID09PSBDb2xvci5CTEFDSyA/IDAgOiB0aGlzLnN0YXRlLnJhbmtzIC0gMSxcbiAgICAgICAgY29sOiAyLFxuICAgICAgfVxuICAgICAgY29scyA9IFtjb2xdO1xuICAgICAgZm9yIChsZXQgaSA9IGNvbCAtIDE7IGkgPj0gdGFyZ2V0LmNvbDsgaS0tKSB7XG4gICAgICAgIGNvbHMucHVzaChpKTtcbiAgICAgIH1cbiAgICAgIHJvb2tTcXVhcmUgPSByb29rU3F1YXJlcy5zb3J0KHNxdWFyZSA9PiBzcXVhcmUuY29sKVswXTtcbiAgICB9XG4gICAgaWYgKHRoaXMubW92ZUhpc3Rvcnkuc29tZShtb3ZlID0+IG1vdmUucGllY2UgPT09IHJvb2tTcXVhcmUub2NjdXBhbnQpKSB7XG4gICAgICBjb25zb2xlLmxvZygncm9vayBtb3ZlZCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGlzQXR0YWNrZWQgPSBjb2xzLnNvbWUoXG4gICAgICB0cmF2ZWxDb2wgPT4gdGhpcy5pc0F0dGFja2VkU3F1YXJlKGNvbG9yLCB0aGlzLnN0YXRlLCByb3csIHRyYXZlbENvbCkgfHxcbiAgICAgIChcbiAgICAgICAgdGhpcy5zdGF0ZS5nZXRTcXVhcmUocm93LCB0cmF2ZWxDb2wpLm9jY3VwYW50XG4gICAgICAgICYmIHRoaXMuc3RhdGUuZ2V0U3F1YXJlKHJvdywgdHJhdmVsQ29sKS5vY2N1cGFudCAhPT0gcm9va1NxdWFyZS5vY2N1cGFudFxuICAgICAgICAmJiAhKHRoaXMuc3RhdGUuZ2V0U3F1YXJlKHJvdywgdHJhdmVsQ29sKS5vY2N1cGFudCBpbnN0YW5jZW9mIEtpbmcpKVxuICAgICk7XG4gICAgaWYgKGlzQXR0YWNrZWQpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdjYW5ub3QgY2FzdGxlLCBhdHRhY2tlZCBvbiB3YXknKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgYmVmb3JlID0gdGhpcy5zdGF0ZTtcbiAgICBjb25zdCBhZnRlciA9IG5ldyBCb2FyZFN0YXRlKHRoaXMuc3RhdGUuc3F1YXJlcylcbiAgICAgIC5lbXB0eShyb29rU3F1YXJlLnJvdywgcm9va1NxdWFyZS5jb2wpXG4gICAgICAuZW1wdHkocm93LCBjb2wpXG4gICAgICAucGxhY2UobmV3IEtpbmcoY29sb3IpLCB0YXJnZXQucm93LCB0YXJnZXQuY29sKVxuICAgICAgLnBsYWNlKG5ldyBSb29rKGNvbG9yKSwgdGFyZ2V0LnJvdywgdGFyZ2V0LmNvbCArIChraW5nc2lkZSA/IC0xIDogMSkpO1xuICAgIGNvbnN0IGlzQ2FwdHVyZSA9IGZhbHNlO1xuICAgIGNvbnN0IGNhcHR1cmVkID0gW107XG4gICAgY29uc3QgdHlwZSA9IE1vdmVUeXBlLkNBU1RMRTtcbiAgICB0aGlzLm1vdmVIaXN0b3J5LnB1c2goe1xuICAgICAgYmVmb3JlLFxuICAgICAgYWZ0ZXIsXG4gICAgICBpc0NhcHR1cmUsXG4gICAgICBjYXB0dXJlZCxcbiAgICAgIHR5cGUsXG4gICAgICBjb2xvcixcbiAgICB9KTtcbiAgICB0aGlzLnN0YXRlSGlzdG9yeS5wdXNoKGFmdGVyKTtcbiAgICB0aGlzLnN0YXRlID0gYWZ0ZXI7XG4gIH1cbiAgXG4gIC8vIFByaXZhdGVcblxuICBpc01vdmVMZWdhbChtb3ZlOiBNb3ZlKTogYm9vbGVhbiB7XG4gICAgaWYgKFxuICAgICAgbW92ZS5lbmQucm93IDwgMCB8fFxuICAgICAgbW92ZS5lbmQucm93ID49IHRoaXMuc3RhdGUucmFua3MgfHxcbiAgICAgIG1vdmUuZW5kLmNvbCA8IDAgfHxcbiAgICAgIG1vdmUuZW5kLmNvbCA+PSB0aGlzLnN0YXRlLmZpbGVzXG4gICAgKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmICh0aGlzLmlzSW5DaGVjayhtb3ZlLmNvbG9yLCBtb3ZlLmFmdGVyKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIGlzSW5DaGVjayhjb2xvcjogQ29sb3IsIHN0YXRlOiBCb2FyZFN0YXRlKTogYm9vbGVhbiB7XG4gICAgY29uc3Qgc3F1YXJlc1dpdGhFbmVteSA9IHN0YXRlLnNxdWFyZXNcbiAgICAgIC5mbGF0KClcbiAgICAgIC5maWx0ZXIoKHNxdWFyZSkgPT4gISFzcXVhcmUub2NjdXBhbnQgJiYgc3F1YXJlLm9jY3VwYW50LmNvbG9yICE9PSBjb2xvcik7XG4gICAgY29uc3QgZW5lbXlNb3ZlcyA9IHNxdWFyZXNXaXRoRW5lbXkuZmxhdE1hcCgoc3F1YXJlKSA9PlxuICAgICAgc3F1YXJlLm9jY3VwYW50IS5sZWdhbE1vdmVzKHNxdWFyZS5yb3csIHNxdWFyZS5jb2wsIHN0YXRlLCBbXSlcbiAgICApO1xuXG4gICAgcmV0dXJuIGVuZW15TW92ZXMuc29tZSgobW92ZSkgPT4gbW92ZS5jYXB0dXJlZC5zb21lKGNhcHR1cmVkID0+IGNhcHR1cmVkLmlzUm95YWwpKTtcbiAgfVxuXG4gIGlzQXR0YWNrZWRTcXVhcmUoY29sb3I6IENvbG9yLCBzdGF0ZTogQm9hcmRTdGF0ZSwgcm93OiBudW1iZXIsIGNvbDogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgLy8gcHV0IGEgZHVtbXkgb24gdGhlIHNxdWFyZSAobW9zdGx5IGZvciBwYXducylcbiAgICBjb25zdCBkdW1teSA9IG5ldyBQaWVjZShjb2xvcik7XG4gICAgY29uc3Qgc3RhdGVXaXRoRHVtbXkgPSBuZXcgQm9hcmRTdGF0ZShzdGF0ZS5zcXVhcmVzKS5wbGFjZShkdW1teSwgcm93LCBjb2wpO1xuICAgIGNvbnN0IHNxdWFyZXNXaXRoRW5lbXkgPSBzdGF0ZS5zcXVhcmVzXG4gICAgICAuZmxhdCgpXG4gICAgICAuZmlsdGVyKChzcXVhcmUpID0+ICEhc3F1YXJlLm9jY3VwYW50ICYmIHNxdWFyZS5vY2N1cGFudC5jb2xvciAhPT0gY29sb3IpO1xuICAgIGNvbnN0IGVuZW15TW92ZXMgPSBzcXVhcmVzV2l0aEVuZW15LmZsYXRNYXAoKHNxdWFyZSkgPT5cbiAgICAgIHNxdWFyZS5vY2N1cGFudCEubGVnYWxNb3ZlcyhzcXVhcmUucm93LCBzcXVhcmUuY29sLCBzdGF0ZVdpdGhEdW1teSwgW10pXG4gICAgKTtcblxuICAgIHJldHVybiBlbmVteU1vdmVzLnNvbWUoKG1vdmUpID0+IG1vdmUuY2FwdHVyZWQuc29tZShjYXB0dXJlZCA9PiBjYXB0dXJlZCA9PT0gZHVtbXkpKTtcbiAgfVxuXG4gIGNhcHR1cmVFZmZlY3RzKCkge1xuICAgIC8vIGluIGF0b21pYyBjaGVzcywgZXhwbG9kZSwgZXRjLlxuICB9XG59IiwiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IChjKSAyMDE5IFRoZSBQb2x5bWVyIFByb2plY3QgQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqIFRoaXMgY29kZSBtYXkgb25seSBiZSB1c2VkIHVuZGVyIHRoZSBCU0Qgc3R5bGUgbGljZW5zZSBmb3VuZCBhdFxuICogaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0xJQ0VOU0UudHh0XG4gKiBUaGUgY29tcGxldGUgc2V0IG9mIGF1dGhvcnMgbWF5IGJlIGZvdW5kIGF0XG4gKiBodHRwOi8vcG9seW1lci5naXRodWIuaW8vQVVUSE9SUy50eHRcbiAqIFRoZSBjb21wbGV0ZSBzZXQgb2YgY29udHJpYnV0b3JzIG1heSBiZSBmb3VuZCBhdFxuICogaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0NPTlRSSUJVVE9SUy50eHRcbiAqIENvZGUgZGlzdHJpYnV0ZWQgYnkgR29vZ2xlIGFzIHBhcnQgb2YgdGhlIHBvbHltZXIgcHJvamVjdCBpcyBhbHNvXG4gKiBzdWJqZWN0IHRvIGFuIGFkZGl0aW9uYWwgSVAgcmlnaHRzIGdyYW50IGZvdW5kIGF0XG4gKiBodHRwOi8vcG9seW1lci5naXRodWIuaW8vUEFURU5UUy50eHRcbiAqL1xuXG5pbXBvcnQge0xpdEVsZW1lbnQsIGh0bWwsIGN1c3RvbUVsZW1lbnQsIHByb3BlcnR5LCBjc3N9IGZyb20gJy4uLy4uL25vZGVfbW9kdWxlcy9saXQtZWxlbWVudCc7XG5pbXBvcnQge1BpZWNlfSBmcm9tICcuLi9jaGVzcy9waWVjZSc7XG5pbXBvcnQgU3F1YXJlIGZyb20gJy4uL2NoZXNzL3NxdWFyZSc7XG5pbXBvcnQgJy4vbXktc3F1YXJlJztcbmltcG9ydCB7IEdhbWV9IGZyb20gJy4uL2NoZXNzL2dhbWUnO1xuaW1wb3J0IHtzdHlsZU1hcH0gZnJvbSAnbGl0LWh0bWwvZGlyZWN0aXZlcy9zdHlsZS1tYXAnO1xuaW1wb3J0IHtTUVVBUkVfU0laRSwgQ29sb3J9IGZyb20gJy4uL2NoZXNzL2NvbnN0JztcblxuLyoqXG4gKiBBbiBleGFtcGxlIGVsZW1lbnQuXG4gKlxuICogQHNsb3QgLSBUaGlzIGVsZW1lbnQgaGFzIGEgc2xvdFxuICogQGNzc3BhcnQgYnV0dG9uIC0gVGhlIGJ1dHRvblxuICovXG5AY3VzdG9tRWxlbWVudCgnbXktZWxlbWVudCcpXG5leHBvcnQgY2xhc3MgTXlFbGVtZW50IGV4dGVuZHMgTGl0RWxlbWVudCB7XG4gIHN0YXRpYyBzdHlsZXMgPSBjc3NgXG4gICAgOmhvc3Qge1xuICAgICAgZGlzcGxheTogYmxvY2s7XG4gICAgICBib3JkZXI6IHNvbGlkIDFweCBncmF5O1xuICAgICAgcGFkZGluZzogMTZweDtcbiAgICAgIG1heC13aWR0aDogODAwcHg7XG4gICAgfVxuXG4gICAgI2JvYXJkIHtcbiAgICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybCgnL2Rpc3QvaW1nL2JnLnN2ZycpO1xuICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICAgIH1cblxuICAgIC5yb3cge1xuICAgICAgaGVpZ2h0OiAke1NRVUFSRV9TSVpFfXB4O1xuICAgIH1cbiAgYDtcblxuICAvLyBwdWJsaWNcbiAgQHByb3BlcnR5KHt0eXBlOiBTdHJpbmd9KSBjb2xvcj86IENvbG9yO1xuICBAcHJvcGVydHkoe3R5cGU6IE9iamVjdH0pIGdhbWU6IEdhbWUgPSBuZXcgR2FtZSgpO1xuXG4gIC8vIHByb3RlY3RlZFxuICBAcHJvcGVydHkoe3R5cGU6IE9iamVjdH0pIHNlbGVjdGVkUGllY2U6IFBpZWNlIHwgdW5kZWZpbmVkO1xuICBAcHJvcGVydHkoe3R5cGU6IE9iamVjdH0pIHNlbGVjdGVkU3F1YXJlOiBTcXVhcmUgfCB1bmRlZmluZWQ7XG5cbiAgLyoqXG4gICAqIFRoZSBudW1iZXIgb2YgdGltZXMgdGhlIGJ1dHRvbiBoYXMgYmVlbiBjbGlja2VkLlxuICAgKi9cbiAgQHByb3BlcnR5KHt0eXBlOiBOdW1iZXJ9KVxuICBjb3VudCA9IDA7XG5cbiAgY29ubmVjdGVkQ2FsbGJhY2soKSB7XG4gICAgc3VwZXIuY29ubmVjdGVkQ2FsbGJhY2soKTtcbiAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ3NxdWFyZS1jbGlja2VkJywgdGhpcy5vblNxdWFyZUNsaWNrZWQuYmluZCh0aGlzKSk7XG4gIH1cblxuICBkaXNjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICBzdXBlci5kaXNjb25uZWN0ZWRDYWxsYmFjaygpO1xuICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcignc3F1YXJlLWNsaWNrZWQnLCB0aGlzLm9uU3F1YXJlQ2xpY2tlZC5iaW5kKHRoaXMpKTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCBzdGF0ZSA9IHRoaXMuZ2FtZS5zdGF0ZTtcblxuICAgIHRoaXMuc3R5bGUuc2V0UHJvcGVydHkoJ2hlaWdodCcsIGAke1NRVUFSRV9TSVpFICogc3RhdGUuc3F1YXJlcy5sZW5ndGh9cHhgKTtcbiAgICB0aGlzLnN0eWxlLnNldFByb3BlcnR5KFxuICAgICAgJ3dpZHRoJyxcbiAgICAgIGAke1NRVUFSRV9TSVpFICogc3RhdGUuc3F1YXJlc1swXS5sZW5ndGh9cHhgXG4gICAgKTtcbiAgICBpZiAodGhpcy5jb2xvciA9PT0gQ29sb3IuQkxBQ0spIHtcbiAgICAgIHRoaXMuc3R5bGUuc2V0UHJvcGVydHkoJ3RyYW5zZm9ybScsICdyb3RhdGUoMTgwZGVnKScpO1xuICAgIH1cblxuICAgIHJldHVybiBodG1sYFxuICAgICAgPGRpdiBpZD1cImJvYXJkXCI+XG4gICAgICAgICR7c3RhdGUuc3F1YXJlcy5tYXAoXG4gICAgICAgICAgKHJvdykgPT4gaHRtbGA8ZGl2IGNsYXNzPVwicm93XCI+XG4gICAgICAgICAgICAke3Jvdy5tYXAoXG4gICAgICAgICAgICAgIChzcXVhcmUpID0+IGh0bWxgPG15LXNxdWFyZVxuICAgICAgICAgICAgICAgIC5zcXVhcmU9JHtzcXVhcmV9XG4gICAgICAgICAgICAgICAgLnBpZWNlPSR7c3F1YXJlLm9jY3VwYW50fVxuICAgICAgICAgICAgICAgIC5zZWxlY3RlZD0ke3NxdWFyZSA9PT0gdGhpcy5zZWxlY3RlZFNxdWFyZX1cbiAgICAgICAgICAgICAgICAucG9zc2libGU9JHt0aGlzLnBvc3NpYmxlTW92ZXMuaW5jbHVkZXMoc3F1YXJlKX1cbiAgICAgICAgICAgICAgICAuY29sb3I9JHt0aGlzLmNvbG9yfVxuICAgICAgICAgICAgICA+PC9teS1zcXVhcmU+YFxuICAgICAgICAgICAgKX1cbiAgICAgICAgICA8L2Rpdj5gXG4gICAgICAgICl9XG4gICAgICA8L2Rpdj5cbiAgICBgO1xuICB9XG5cbiAgcHJpdmF0ZSBvblNxdWFyZUNsaWNrZWQoZTogQ3VzdG9tRXZlbnQpIHtcbiAgICAvLyBUaGVyZSdzIGEgYnVnIGhlcmUgd2hlcmUgdXBkYXRpbmcgdGhlIGdhbWUgdXNpbmcgYXR0ZW1wdE1vdmUgZG9lc24ndCBjYXVzZSByZXJlbmRlci5cbiAgICBjb25zdCBzcXVhcmUgPSBlLmRldGFpbCBhcyBTcXVhcmU7XG4gICAgaWYgKHRoaXMuc2VsZWN0ZWRQaWVjZSkge1xuICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRQaWVjZSA9PT0gc3F1YXJlLm9jY3VwYW50KSB7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRQaWVjZSA9IG51bGw7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMuZ2FtZS5hdHRlbXB0TW92ZShcbiAgICAgICAgLy8gdGhpcy5zZWxlY3RlZFBpZWNlLmNvbG9yLFxuICAgICAgICB0aGlzLnNlbGVjdGVkUGllY2UsXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRTcXVhcmUucm93LFxuICAgICAgICB0aGlzLnNlbGVjdGVkU3F1YXJlLmNvbCxcbiAgICAgICAgc3F1YXJlXG4gICAgICApO1xuICAgICAgLy8gaWYgKHJlc3VsdCkge1xuICAgICAgdGhpcy5zZWxlY3RlZFNxdWFyZSA9IG51bGw7XG4gICAgICB0aGlzLnNlbGVjdGVkUGllY2UgPSBudWxsO1xuICAgICAgLy8gICByZXR1cm47XG4gICAgICAvLyB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2VsZWN0ZWRTcXVhcmUgPSBzcXVhcmU7XG4gICAgICB0aGlzLnNlbGVjdGVkUGllY2UgPSBzcXVhcmUub2NjdXBhbnQ7XG4gICAgfVxuICAgIHRoaXMucGVyZm9ybVVwZGF0ZSgpO1xuICB9XG5cbiAgZ2V0IHBvc3NpYmxlTW92ZXMoKTogU3F1YXJlW10ge1xuICAgIGlmICghdGhpcy5zZWxlY3RlZFBpZWNlKSByZXR1cm4gW107XG5cbiAgICByZXR1cm4gdGhpcy5zZWxlY3RlZFBpZWNlXG4gICAgICAubGVnYWxNb3ZlcyhcbiAgICAgICAgdGhpcy5zZWxlY3RlZFNxdWFyZS5yb3csXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRTcXVhcmUuY29sLFxuICAgICAgICB0aGlzLmdhbWUuc3RhdGUsXG4gICAgICAgIHRoaXMuZ2FtZS5tb3ZlSGlzdG9yeVxuICAgICAgKVxuICAgICAgLmZpbHRlcigobW92ZSkgPT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5nYW1lLmlzTW92ZUxlZ2FsKG1vdmUpO1xuICAgICAgfSlcbiAgICAgIC5tYXAoKG1vdmUpID0+IHRoaXMuZ2FtZS5zdGF0ZS5nZXRTcXVhcmUobW92ZS5lbmQucm93LCBtb3ZlLmVuZC5jb2wpKTtcbiAgfVxufVxuXG5kZWNsYXJlIGdsb2JhbCB7XG4gIGludGVyZmFjZSBIVE1MRWxlbWVudFRhZ05hbWVNYXAge1xuICAgICdteS1lbGVtZW50JzogTXlFbGVtZW50O1xuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9